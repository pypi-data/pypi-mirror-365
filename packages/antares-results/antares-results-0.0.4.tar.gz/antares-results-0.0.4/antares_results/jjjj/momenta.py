"""
Phase space point used in (most of) the ancillaries of arXiv:1904.04067 (generated by S@M, arXiv:0710.5559),
and expressed in terms of pairs of two-component spinors. Import with:

.. code-block:: python

    from amplitudes.jjjj.momenta import oPs

"""


import numpy
import mpmath

from syngular import Field

from lips import Particles


spinor_values_from_sam = [
    [[[5.64112881713923583211e-1 + 0j], [-1.16142076352257195694 + 0j]],
     [[5.64112881713923583211e-1 + 0j, -1.16142076352257195694 + 0j]]],
    [[[-4.64873538844630674696e-20 + 1.85335672282795580206j], [1.32099548452455967161 - 9.21202622323894240551e-2j]],
     [[-4.64873538844630674696e-20 + 1.85335672282795580206j, -1.32099548452455967161 - 9.21202622323894239941e-2j]]],
    [[[9.84073342336265994776 + 24.5012162241276681106j], [-8.26035705611370068419 - 37.076931065516607406j]],
     [[-2.75038888418595501176e-20 + 1.09652438845330411411j, 1.07867705577722402265e-1 + 5.75982580979608616803e-1j]]],
    [[[-4.74492790697931048834e-19 + 3.55417310336507049707j], [6.33058642492599197397e-2 - 4.78310974327741620683j]],
     [[-4.74492790697931048834e-19 + 3.55417310336507049707j, -6.33058642492599210204e-2 - 4.78310974327741620683j]]],
    [[[-2.81377738301297896336e-20 + 1.12179610014139426362j], [-7.79999145914050329739e-1 + 5.27471949899611383022e-3j]],
     [[-2.81377738301297896336e-20 + 1.12179610014139426362j, 7.79999145914050329739e-1 + 5.27471949899611379126e-3j]]],
    [[[-5.61725829372124862027 - 22.8391814807276962475j], [3.7790251619804524207 + 29.7585583367651368182j]],
     [[-4.81833706135731732177e-20 + 1.9209734775853276002j, 3.04012526364544427029e-1 - 7.66730115871076791243e-2j]]]
]


oPs = Particles(6, field=Field("mpc", 0, 16))
for i, oP in enumerate(oPs):
    oP._r_sp_d = numpy.vectorize(mpmath.mpmathify)(numpy.array(spinor_values_from_sam[i][0]))
    oP._r_sp_d_to_r_sp_u()
    oP.l_sp_d = numpy.vectorize(mpmath.mpmathify)(numpy.array(spinor_values_from_sam[i][1]))


assert oPs.phasespace_consistency_check() == (True, True, [], [])
