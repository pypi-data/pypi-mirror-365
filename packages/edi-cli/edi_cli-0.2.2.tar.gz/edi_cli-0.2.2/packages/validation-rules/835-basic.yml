# EDI 835 Basic Validation Rules
# Electronic Remittance Advice validation rules

version: "0.2.0"
transaction_set: "835"
description: "Basic validation rules for EDI 835 Electronic Remittance Advice"

rules:
  # Interchange Control Header (ISA) Validation
  - id: "ISA_01_REQUIRED"
    type: "field"
    description: "Authorization Information Qualifier is required"
    field_path: "interchanges.0.header.authorization_qualifier"
    validation_type: "required"
    severity: "error"
    category: "structural"

  - id: "ISA_SENDER_ID_FORMAT"
    type: "field"
    description: "Sender ID must be properly formatted"
    field_path: "interchanges.0.header.sender_id"
    validation_type: "length"
    min_length: 1
    max_length: 15
    severity: "error"
    category: "structural"

  - id: "ISA_RECEIVER_ID_FORMAT"
    type: "field"
    description: "Receiver ID must be properly formatted"
    field_path: "interchanges.0.header.receiver_id"
    validation_type: "length"
    min_length: 1
    max_length: 15
    severity: "error"
    category: "structural"

  - id: "ISA_DATE_FORMAT"
    type: "field"
    description: "Interchange date must be in YYYY-MM-DD format"
    field_path: "interchanges.0.header.date"
    validation_type: "regex"
    pattern: "^\\d{4}-\\d{2}-\\d{2}$"
    severity: "error"
    category: "format"

  - id: "ISA_TIME_FORMAT"
    type: "field"
    description: "Interchange time must be in HH:MM format"
    field_path: "interchanges.0.header.time"
    validation_type: "regex"
    pattern: "^\\d{2}:\\d{2}$"
    severity: "error"
    category: "format"

  - id: "ISA_CONTROL_NUMBER_REQUIRED"
    type: "field"
    description: "Interchange control number is required"
    field_path: "interchanges.0.header.control_number"
    validation_type: "required"
    severity: "error"
    category: "structural"

  # Financial Information (BPR) Validation
  - id: "BPR_TOTAL_PAID_REQUIRED"
    type: "field"
    description: "Total paid amount is required"
    field_path: "interchanges.0.functional_groups.0.transactions.0.financial_information.total_paid"
    validation_type: "required"
    severity: "error"
    category: "business"

  - id: "BPR_TOTAL_PAID_NUMERIC"
    type: "field"
    description: "Total paid amount must be numeric"
    field_path: "interchanges.0.functional_groups.0.transactions.0.financial_information.total_paid"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  - id: "BPR_PAYMENT_METHOD_REQUIRED"
    type: "field"
    description: "Payment method is required"
    field_path: "interchanges.0.functional_groups.0.transactions.0.financial_information.payment_method"
    validation_type: "required"
    severity: "error"
    category: "business"

  - id: "BPR_PAYMENT_DATE_FORMAT"
    type: "field"
    description: "Payment date must be in YYYY-MM-DD format"
    field_path: "interchanges.0.functional_groups.0.transactions.0.financial_information.payment_date"
    validation_type: "regex"
    pattern: "^\\d{4}-\\d{2}-\\d{2}$"
    severity: "error"
    category: "format"

  # Payer Information Validation
  - id: "PAYER_NAME_REQUIRED"
    type: "field"
    description: "Payer name is required when payer information is present"
    field_path: "interchanges.0.functional_groups.0.transactions.0.payer.name"
    validation_type: "required"
    severity: "warning"
    category: "business"

  - id: "PAYER_NAME_LENGTH"
    type: "field"
    description: "Payer name must not exceed 60 characters"
    field_path: "interchanges.0.functional_groups.0.transactions.0.payer.name"
    validation_type: "length"
    max_length: 60
    severity: "warning"
    category: "format"

  # Payee Information Validation
  - id: "PAYEE_NAME_REQUIRED"
    type: "field"
    description: "Payee name is required when payee information is present"
    field_path: "interchanges.0.functional_groups.0.transactions.0.payee.name"
    validation_type: "required"
    severity: "warning"
    category: "business"

  - id: "PAYEE_NPI_FORMAT"
    type: "field"
    description: "Payee NPI must be 10 digits"
    field_path: "interchanges.0.functional_groups.0.transactions.0.payee.npi"
    validation_type: "regex"
    pattern: "^\\d{10}$"
    severity: "error"
    category: "hipaa"

  # Claim Information Validation
  - id: "CLAIM_ID_REQUIRED"
    type: "field"
    description: "Claim ID is required for each claim"
    field_path: "claims.*.claim_id"
    validation_type: "required"
    severity: "error"
    category: "business"

  - id: "CLAIM_STATUS_CODE_VALID"
    type: "field"
    description: "Claim status code must be valid (1-22)"
    field_path: "claims.*.status_code"
    validation_type: "regex"
    pattern: "^([1-9]|1[0-9]|2[0-2])$"
    severity: "error"
    category: "business"

  - id: "CLAIM_TOTAL_CHARGE_NUMERIC"
    type: "field"
    description: "Claim total charge must be numeric"
    field_path: "claims.*.total_charge"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  - id: "CLAIM_TOTAL_PAID_NUMERIC"
    type: "field"
    description: "Claim total paid must be numeric"
    field_path: "claims.*.total_paid"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  - id: "CLAIM_PATIENT_RESPONSIBILITY_NUMERIC"
    type: "field"
    description: "Patient responsibility amount must be numeric"
    field_path: "claims.*.patient_responsibility"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  # Service Information Validation
  - id: "SERVICE_CODE_REQUIRED"
    type: "field"
    description: "Service code is required for each service"
    field_path: "services.*.service_code"
    validation_type: "required"
    severity: "error"
    category: "business"

  - id: "SERVICE_CHARGE_AMOUNT_NUMERIC"
    type: "field"
    description: "Service charge amount must be numeric"
    field_path: "services.*.charge_amount"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  - id: "SERVICE_PAID_AMOUNT_NUMERIC"
    type: "field"
    description: "Service paid amount must be numeric"
    field_path: "services.*.paid_amount"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  - id: "SERVICE_DATE_FORMAT"
    type: "field"
    description: "Service date must be in YYYY-MM-DD format when present"
    field_path: "services.*.service_date"
    validation_type: "regex"
    pattern: "^(\\d{4}-\\d{2}-\\d{2}|)$"
    severity: "warning"
    category: "format"

  # Adjustment Information Validation
  - id: "ADJUSTMENT_GROUP_CODE_VALID"
    type: "field"
    description: "Adjustment group code must be valid (CO, PR, PI, etc.)"
    field_path: "adjustments.*.group_code"
    validation_type: "regex"
    pattern: "^(CO|CR|OA|PI|PR)$"
    severity: "error"
    category: "business"

  - id: "ADJUSTMENT_REASON_CODE_REQUIRED"
    type: "field"
    description: "Adjustment reason code is required"
    field_path: "adjustments.*.reason_code"
    validation_type: "required"
    severity: "error"
    category: "business"

  - id: "ADJUSTMENT_AMOUNT_NUMERIC"
    type: "field"
    description: "Adjustment amount must be numeric"
    field_path: "adjustments.*.amount"
    validation_type: "numeric"
    severity: "error"
    category: "business"

  - id: "ADJUSTMENT_QUANTITY_NUMERIC"
    type: "field"
    description: "Adjustment quantity must be numeric"
    field_path: "adjustments.*.quantity"
    validation_type: "numeric"
    severity: "error"
    category: "business"