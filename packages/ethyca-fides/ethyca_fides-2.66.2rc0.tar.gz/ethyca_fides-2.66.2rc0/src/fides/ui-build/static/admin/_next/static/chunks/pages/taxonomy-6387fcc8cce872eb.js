(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4202],{71180:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/taxonomy",function(){return n(31537)}])},79806:function(e,t,n){"use strict";n.d(t,{Gn:function(){return a},zR:function(){return r}});var i=n(24246),l=n(13577),s=n(56358);let r=e=>{let{title:t}=e;return(0,i.jsx)(l.OXI,{py:0,display:"flex",alignItems:"flex-start",children:(0,i.jsx)(l.xvT,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},a=e=>{let{onDelete:t,onEditYaml:n,formId:r,isSaving:a}=e;return(0,i.jsxs)(l.zeN,{justifyContent:"space-between",children:[t?(0,i.jsx)(l.wpx,{"aria-label":"delete",icon:(0,i.jsx)(s.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,i.jsxs)("div",{className:"flex gap-2",children:[n&&(0,i.jsx)(l.wpx,{onClick:n,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,i.jsx)(l.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:r,loading:a,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:n,isOpen:s,onClose:r,children:a,footer:o}=e;return(0,i.jsxs)(l.dys,{placement:"right",isOpen:s,onClose:r,size:"md",children:[(0,i.jsx)(l.P1B,{}),(0,i.jsxs)(l.scA,{"data-testid":"edit-drawer-content",py:2,children:[(0,i.jsxs)(l.xuv,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,i.jsx)(l.xuv,{flex:1,minH:8,children:t}),(0,i.jsx)(l.xuv,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,i.jsx)(l.wpx,{"aria-label":"Close editor",onClick:r,"data-testid":"close-drawer-btn",icon:(0,i.jsx)(l.Two,{fontSize:"smaller"})})})]}),(0,i.jsxs)(l.Ng0,{pt:1,children:[n?(0,i.jsx)(l.xvT,{fontSize:"sm",mb:4,color:"gray.600",children:n}):null,a]}),o]})]})}},18225:function(e,t,n){"use strict";var i=n(24246),l=n(13577);t.Z=e=>{let{alignment:t="center",...n}=e;return(0,i.jsx)(l.kCb,{boxSize:"full",align:"center",justify:t,children:(0,i.jsx)(l.$jN,{color:"primary",...n})})}},56358:function(e,t,n){"use strict";n.d(t,{q:function(){return l}});var i=n(24246);let l=(0,n(13577).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,i.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},77213:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var i=n(24246),l=n(13577),s=n(88038),r=n.n(s),a=n(86677);n(27378);var o=n(25980),d=n(90867),u=n(77830),c=()=>{let e=(0,a.useRouter)();return(0,i.jsx)(l.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(l.xuv,{children:[(0,i.jsxs)(l.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(l.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(l.wpx,{onClick:()=>{e.push(u.fz)},children:"Configure"})]}),(0,i.jsxs)(l.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},m=e=>{let{children:t,title:n,padded:s=!0,mainProps:u}=e,m=(0,o.hz)(),x=(0,a.useRouter)(),p="/privacy-requests"===x.pathname||"/datastore-connection"===x.pathname,h=!(m.flags.privacyRequestsConfiguration&&p),{data:f}=(0,d.JE)(void 0,{skip:h}),{data:v}=(0,d.PW)(void 0,{skip:h}),y=m.flags.privacyRequestsConfiguration&&(!f||!v)&&p;return(0,i.jsxs)(l.kCb,{"data-testid":n,direction:"column",h:"100vh",children:[(0,i.jsxs)(r(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(l.kCb,{as:"main",direction:"column",py:s?6:0,px:s?10:0,h:s?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...u,children:[y?(0,i.jsx)(c,{}):null,t]})]})}},58754:function(e,t,n){"use strict";var i=n(24246),l=n(13577),s=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:r=!0,children:a,rightContent:o,style:d,...u}=e;return(0,i.jsxs)("div",{...u,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,i.jsxs)(l.jqI,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(l.lQT,{className:n||a?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!n&&(0,i.jsx)(s.m,{className:a?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),a]})}},19904:function(e,t,n){"use strict";n.d(t,{Tg:function(){return r}});var i=n(24246),l=n(16134),s=n(31793);let r=e=>(0,l.C)(s.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:n}=e;return r(t)?(0,i.jsx)(i.Fragment,{children:n}):null}},94799:function(e,t,n){"use strict";n.d(t,{k:function(){return s}});var i=n(76649);let l=e=>(0,i.Ln)({id:"string"},e),s=e=>(null!=e?e:[]).filter(l)},30320:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var i=n(27378),l=n(25980),s=n(14047),r=n(32885),a=n(94799);let o=e=>{let{resourceFidesKey:t,resourceType:n}=e,{errorAlert:o}=(0,s.V)(),{plus:d}=(0,l.hz)(),u=(0,i.useMemo)(()=>null!=t?t:"",[]),c=(0,r.YU)(!0,{skip:!d}),m=(0,r.VN)(n,{skip:!d}),{data:x,isLoading:p,error:h,isError:f}=(0,r.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[v]=(0,r._D)(),y=c.isLoading||m.isLoading||p,_=(0,i.useMemo)(()=>new Map((0,a.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),T=(0,i.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),j=(0,i.useMemo)(()=>new Map((0,a.k)(T).map(e=>[e.id,e])),[T]),g=(0,i.useMemo)(()=>f&&(null==h?void 0:h.status)===404?new Map:new Map((0,a.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,f,h]),C=(0,i.useMemo)(()=>{let e=[...j.keys()];return e.sort(),e},[j]),E=(0,i.useMemo)(()=>{let e={};return T&&g&&T.forEach(t=>{let n=g.get(t.id||"");n&&(t.allow_list_id&&"string[]"===t.field_type?e[n.custom_field_definition_id]=n.value:e[n.custom_field_definition_id]=n.value.toString())}),e},[T,g]),A=(0,i.useCallback)(async e=>{if(!d)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!i)return;let{customFieldValues:l}=e;if(!l||0===Object.keys(l).length)return;let s=[],r=[];C.forEach(e=>{let t=g.get(e),n=l[e];void 0===n||""===n||Array.isArray(n)&&0===n.length?(null==t?void 0:t.id)&&r.push(t.id):s.push({custom_field_definition_id:e,resource_id:i,id:null==t?void 0:t.id,value:n})});try{await v({resource_type:n,resource_id:i,upsert:s,delete:r})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,g,o,t,C,v,n]);return{customFieldValues:E,definitionIdToCustomField:g,idToAllowListWithOptions:_,idToCustomFieldDefinition:j,isEnabled:d,isLoading:y,sortedCustomFieldDefinitionIds:C,upsertCustomFields:A}}},95346:function(e,t,n){"use strict";n.d(t,{uc:function(){return v},Hn:function(){return o},Uv:function(){return r},C7:function(){return d},mZ:function(){return f.m}});var i,l,s,r,a=n(73825);(i=s||(s={}))[i.CREATE_CUSTOM_FIELDS=0]="CREATE_CUSTOM_FIELDS",i[i.CREATE_CUSTOM_LISTS=1]="CREATE_CUSTOM_LISTS",i[i.CHOOSE_FROM_LIBRARY=2]="CHOOSE_FROM_LIBRARY",a.AL.STRING,a.AL.STRING_,(l=r||(r={})).SINGLE_SELECT="singleSelect",l.MULTIPLE_SELECT="multipleSelect",l.OPEN_TEXT="openText";let o=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open Text",value:"openText"}],d=[{label:"taxonomy:".concat(a.P6.DATA_CATEGORY),value:a.P6.DATA_CATEGORY},{label:"taxonomy:".concat(a.P6.DATA_SUBJECT),value:a.P6.DATA_SUBJECT},{label:"taxonomy:".concat(a.P6.DATA_USE),value:a.P6.DATA_USE},{label:"".concat(a.P6.SYSTEM,":information"),value:a.P6.SYSTEM},{label:"system:data use",value:a.P6.PRIVACY_DECLARATION}];var u=n(24246),c=n(13577),m=n(34090),x=n(30234),p=n(97181),h=n(40324),f=n(30320);let v=e=>{let{resourceFidesKey:t,resourceType:n}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:l,isEnabled:s,isLoading:r,sortedCustomFieldDefinitionIds:o}=(0,f.m)({resourceFidesKey:t,resourceType:n});return s&&0!==o.length?(0,u.jsx)(x.Z,{heading:"Custom fields",children:(0,u.jsx)(c.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,u.jsx)(c.kCb,{flexDir:"column",gap:"24px",children:r?(0,u.jsx)(c.M5Y,{children:(0,u.jsx)(c.$jN,{})}):o.length>0&&(0,u.jsx)(c.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:o.map(e=>{let t=l.get(e);if(!t)return null;let n="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===a.AL.STRING)return(0,u.jsx)(m.gN,{name:n,children:e=>{let{field:n}=e;return(0,u.jsx)(h.j0,{...n,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let s=i.get(t.allow_list_id);if(!s)return null;let{options:r}=s;return(0,u.jsx)(p.d,{name:n,allowClear:!0,mode:t.field_type!==a.AL.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};n(94799)},97181:function(e,t,n){"use strict";n.d(t,{d:function(){return d}});var i=n(24246),l=n(13577),s=n(34090),r=n(27378),a=n(46238),o=n(40324);let d=e=>{let{name:t,label:n,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:x,...p}=e,[h,f,{setValue:v}]=(0,s.U$)(t),y=!!(f.touched&&f.error),[_,T]=(0,r.useState)("");h.value||"tags"!==p.mode&&"multiple"!==p.mode||(h.value=[]),"tags"===p.mode&&"string"==typeof h.value&&(h.value=[h.value]);let j="tags"===p.mode?(e,t)=>e?e.value!==_||h.value.includes(_)?p.optionRender?p.optionRender(e,t):e.label:'Create "'.concat(_,'"'):void 0:p.optionRender||void 0,g=e=>{T(e),p.onSearch&&p.onSearch(e)},C=(e,t)=>{v(e),p.onChange&&p.onChange(e,t)};return"inline"===m?(0,i.jsx)(l.NIc,{isInvalid:y,isRequired:c,children:(0,i.jsxs)(l.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,i.jsx)(o.__,{htmlFor:p.id||t,...d,children:n}):null,(0,i.jsxs)(l.jqI,{align:"center",children:[(0,i.jsxs)(l.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(l.WPr,{...h,id:p.id||t,"data-testid":"controlled-select-".concat(h.name),...p,optionRender:j,onSearch:"tags"===p.mode?g:void 0,onChange:C,value:h.value||void 0,status:y?"error":void 0}),x&&(0,i.jsx)(l.Q6r,{children:x}),(0,i.jsx)(o.Bc,{isInvalid:y,message:f.error,fieldName:h.name})]}),(0,i.jsx)(a.b,{label:u,className:y?"mt-2 self-start":void 0})]})]})}):(0,i.jsx)(l.NIc,{isInvalid:y,isRequired:c,children:(0,i.jsxs)(l.gCW,{alignItems:"start",children:[(0,i.jsxs)(l.jqI,{align:"center",children:[n?(0,i.jsx)(o.__,{htmlFor:p.id||t,fontSize:"xs",my:0,mr:1,...d,children:n}):null,(0,i.jsx)(a.b,{label:u})]}),(0,i.jsx)(l.WPr,{...h,id:p.id||t,"data-testid":"controlled-select-".concat(h.name),...p,optionRender:j,onSearch:"tags"===p.mode?g:void 0,onChange:C,value:h.value||void 0,status:y?"error":void 0}),x&&(0,i.jsx)(l.Q6r,{style:{marginTop:0},children:x}),(0,i.jsx)(o.Bc,{isInvalid:y,message:f.error,fieldName:h.name})]})})}},14047:function(e,t,n){"use strict";n.d(t,{H:function(){return s},V:function(){return i.V}});var i=n(84306),l=n(812);let s=()=>{let{errorAlert:e}=(0,i.V)();return{handleError:t=>{let n="An unexpected error occurred. Please try again.";(0,l.Ot)(t)?n=t.data.detail:(0,l.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}}},84306:function(e,t,n){"use strict";n.d(t,{V:function(){return s}});var i=n(24246),l=n(13577);let s=()=>{let e=(0,l.pmc)();return{errorAlert:(t,n,s)=>{let r={...s,position:(null==s?void 0:s.position)||"top",render:e=>{let{onClose:s}=e;return(0,i.jsxs)(l.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,i.jsx)(l.zMQ,{}),(0,i.jsxs)(l.xuv,{children:[n&&(0,i.jsx)(l.CdC,{children:n}),(0,i.jsx)(l.XaZ,{children:t})]}),(0,i.jsx)(l.PZ7,{onClick:s,position:"relative",right:0,size:"sm",top:-1})]})}};(null==s?void 0:s.id)&&e.isActive(s.id)?e.update(s.id,r):e(r)},successAlert:(t,n,s)=>{let r={...s,position:(null==s?void 0:s.position)||"top",render:e=>{let{onClose:s}=e;return(0,i.jsxs)(l.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,i.jsx)(l.zMQ,{}),(0,i.jsxs)(l.xuv,{children:[n&&(0,i.jsx)(l.CdC,{children:n}),(0,i.jsx)(l.XaZ,{children:t})]}),(0,i.jsx)(l.PZ7,{onClick:s,position:"relative",right:0,size:"sm",top:-1})]})}};(null==s?void 0:s.id)&&e.isActive(s.id)?e.update(s.id,r):e(r)}}}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var i=n(24246),l=n(13577),s=n(79894),r=n.n(s),a=n(27378);let{Text:o}=l.AntTypography,d=e=>{let{items:t,...n}=e,s=(0,a.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let s=n===t.length-1,a={...e},d=a.onClick&&!a.href;return("string"==typeof a.title&&(a.title=(0,i.jsx)(o,{style:{color:"inherit",maxWidth:s?void 0:400},ellipsis:!s,children:a.title})),d)?a.title=(0,i.jsx)(l.wpx,{type:"text",size:"small",icon:a.icon,onClick:a.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:a.title}):(a.icon&&(a.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:a.icon}),a.title]})),a.href&&a.title&&(a.title=(0,i.jsx)(r(),{href:a.href,className:"ant-breadcrumb-link",children:a.title}),delete a.href)),a}),[t]);return(0,i.jsx)(l.zrq,{items:s,...n})}},30234:function(e,t,n){"use strict";var i=n(24246),l=n(13577);t.Z=e=>{let{heading:t,HeadingButton:n,children:s}=e;return(0,i.jsx)(l.Kqy,{spacing:4,children:(0,i.jsxs)(l.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(l.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(l.X6q,{as:"h3",size:"xs",children:t}),n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.LZC,{}),(0,i.jsx)(n,{})]}):null]}),(0,i.jsx)(l.Kqy,{spacing:4,px:6,py:6,children:s})]})})}},59001:function(e,t,n){"use strict";n.d(t,{Ch:function(){return r},Hy:function(){return a},Lo:function(){return l}});var i,l,s=n(73825);let r="root";(i=l||(l={})).DATA_CATEGORIES="Data categories",i.DATA_USES="Data uses",i.DATA_SUBJECTS="Data subjects";let a=e=>{switch(e){case"Data categories":return{UPDATE:s.Sh.DATA_CATEGORY_UPDATE,CREATE:s.Sh.DATA_CATEGORY_CREATE,DELETE:s.Sh.DATA_CATEGORY_DELETE,READ:s.Sh.DATA_CATEGORY_READ};case"Data uses":return{UPDATE:s.Sh.DATA_USE_UPDATE,CREATE:s.Sh.DATA_USE_CREATE,DELETE:s.Sh.DATA_USE_DELETE,READ:s.Sh.DATA_USE_READ};case"Data subjects":return{UPDATE:s.Sh.DATA_SUBJECT_UPDATE,CREATE:s.Sh.DATA_SUBJECT_CREATE,DELETE:s.Sh.DATA_SUBJECT_DELETE,READ:s.Sh.DATA_SUBJECT_READ};default:throw Error("Unknown taxonomy type: ".concat(e))}}},90673:function(e,t,n){"use strict";n.d(t,{Cd:function(){return s},Xl:function(){return r}});var i=n(73825),l=n(59001);let s=(e,t)=>{let n;if(null==t&&e.every(e=>void 0===e.parent_key))n=e;else{let i=null!=t?t:null;n=e.filter(e=>e.parent_key===i)}return n.map(t=>{var n,i;let l=t.fides_key;return{value:t.fides_key,label:""===t.name||null==t.name?t.fides_key:t.name,description:t.description,children:s(e,l),is_default:null!==(n=t.is_default)&&void 0!==n&&n,active:null!==(i=t.active)&&void 0!==i&&i}})},r=e=>{switch(e){case l.Lo.DATA_CATEGORIES:return i.P6.DATA_CATEGORY;case l.Lo.DATA_SUBJECTS:return i.P6.DATA_SUBJECT;case l.Lo.DATA_USES:return i.P6.DATA_USE;default:return}}},31537:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ei}});var i,l,s=n(24246),r=n(13577),a=n(69238),o=n.n(a),d=n(63662),u=n(27378),c=n(812),m=n(77213),x=n(58754),p=n(19904),h=n(46628),f=n(95346),v=n(56358),y=n(31883),_=n(79806),T=n(59001),j=n(90673),g=n(30002),C=n(28079),E=n(39864),A=e=>{let{taxonomyType:t}=e,[n,i]=(0,E.Vj)(),[l,s]=(0,g.nC)(),[r,a]=(0,C.dk)(),[o]=(0,E.Ti)(),[d]=(0,C.Ql)(),[u]=(0,g.wG)(),[c]=(0,E.jU)(),[m]=(0,C.LG)(),[x]=(0,g.h8)(),[p]=(0,E.K9)(),[h]=(0,C.gu)(),[f]=(0,g.Kv)();return t===T.Lo.DATA_SUBJECTS?{getAllTrigger:l,taxonomyItems:s.data||[],updateTrigger:x,deleteTrigger:f,createTrigger:u}:t===T.Lo.DATA_USES?{getAllTrigger:r,taxonomyItems:a.data||[],updateTrigger:m,deleteTrigger:h,createTrigger:d}:{getAllTrigger:n,taxonomyItems:i.data||[],updateTrigger:c,deleteTrigger:p,createTrigger:o}},b=n(90104),S=n.n(b),I=n(18225),k=n(73825),N=e=>{let{customFields:t,formId:n,form:i}=e,{idToAllowListWithOptions:l,idToCustomFieldDefinition:a,isEnabled:o,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return o&&0!==u.length?(0,s.jsxs)(r.PPS,{form:i,name:n,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(r.AntTypography.Title,{level:3,children:"Custom fields"})}),d?(0,s.jsx)(I.Z,{}):(0,s.jsx)("div",{children:!S()(u)&&(0,s.jsx)("div",{children:u.map(e=>{let t=a.get(e);if(!t)return null;let{id:n,name:i,description:o,allow_list_id:d,field_type:u}=t;if(!d&&u===k.AL.STRING)return(0,s.jsx)(r.PPS.Item,{name:n,label:i,tooltip:o,children:(0,s.jsx)(r.uFc,{})},e);let c=l.get(t.allow_list_id);if(!c)return null;let{options:m}=c;return(0,s.jsx)(r.PPS.Item,{name:n,label:i,tooltip:o,children:(0,s.jsx)(r.WPr,{mode:"string"!==u?"multiple":void 0,allowClear:!0,options:m})},e)})})})]}):null},D=n(43551),R=n.n(D),P=()=>{let e=r.PPS.useFormInstance(),t=r.PPS.useWatch(["rights","values"],e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.PPS.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,s.jsx)(r.E_O,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,s.jsx)(r.PPS.Item,{name:["rights","values"],label:"Rights",children:(0,s.jsx)(r.WPr,{mode:"multiple",options:(0,c.MM)(k.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!S()(t)&&(0,s.jsx)(r.PPS.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,s.jsx)(r.WPr,{options:(0,c.MM)(k.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},w=e=>{let{initialValues:t,onSubmit:n,form:i,formId:l,taxonomyType:a,isDisabled:o}=e,d=a===T.Lo.DATA_SUBJECTS;return(0,s.jsxs)(r.PPS,{name:l,initialValues:t,onFinish:e=>{var i,l;let s={...t,...e};(!(null==s?void 0:null===(i=s.rights)||void 0===i?void 0:i.values)||S()(null==s?void 0:null===(l=s.rights)||void 0===l?void 0:l.values))&&R()(s,"rights"),n(s)},layout:"vertical",form:i,children:[(0,s.jsx)(r.PPS.Item,{label:"Name",name:"name",children:(0,s.jsx)(r.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:o})}),(0,s.jsx)(r.PPS.Item,{label:"Description",name:"description",children:(0,s.jsx)(r.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:o})}),d&&(0,s.jsx)(P,{})]})},O=e=>{let{taxonomyItem:t,taxonomyType:n,onClose:i}=e,l="edit-taxonomy-form",[a]=r.PPS.useForm(),[o]=r.PPS.useForm(),d=(0,r.pmc)(),{isOpen:u,onOpen:m,onClose:x}=(0,r.qY0)(),{updateTrigger:g}=A({taxonomyType:n}),C=(0,f.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:(0,j.Xl)(n)}),E=(0,p.Tg)([(0,T.Hy)(n).UPDATE]),b=(0,p.Tg)([(0,T.Hy)(n).DELETE]),S=async e=>{let n=await g(e);if((0,y.D4)(n)){d((0,h.Vo)((0,c.e$)(n.error)));return}if(C.isEnabled){let e=o.getFieldsValue();await C.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,h.t5)("Taxonomy successfully updated")),i()},I=async()=>{await g({...t,active:!1}),x(),i()},k=async()=>{await g({...t,active:!0}),x(),i()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(_.ZP,{isOpen:!!t,onClose:i,header:(0,s.jsx)(_.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,s.jsxs)(r.zeN,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&b&&(0,s.jsx)(r.esZ,{title:"Delete label",children:(0,s.jsx)(r.wpx,{"aria-label":"delete",icon:(0,s.jsx)(v.q,{fontSize:"small"}),onClick:m,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&E&&(0,s.jsx)(r.esZ,{title:"Enable label",children:(0,s.jsx)(r.wpx,{"aria-label":"enable",onClick:k,"data-testid":"enable-btn",icon:(0,s.jsx)(r.tEF,{fontSize:"small"})})}),(0,s.jsx)("div",{className:"flex gap-2",children:E&&(0,s.jsx)(r.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:l,children:"Save"})})]}),children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(r.AntTypography.Title,{level:3,children:"Details"})}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,s.jsx)(r.esZ,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,s.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,s.jsx)(w,{initialValues:t,onSubmit:S,form:a,formId:l,taxonomyType:n,isDisabled:!E}),C.isEnabled&&!C.isLoading&&(0,s.jsx)(N,{form:o,formId:"custom-fields-form",customFields:C})]}),(0,s.jsx)(r.cVQ,{isOpen:u,onClose:x,onConfirm:I,title:"Delete ".concat(n),message:(0,s.jsx)(r.Kqy,{children:(0,s.jsxs)(r.xvT,{children:["You are about to permanently delete the ",n," ",(0,s.jsx)(r.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};n(51901);var L=n(86298),V=n(3124),F=n.n(V);(i=l||(l={})).DEFAULT="DEFAULT",i.ACTIVE_HOVER="ACTIVE_HOVER",i.PARENT_OF_HOVER="PARENT_OF_HOVER",i.CHILD_OF_HOVER="CHILD_OF_HOVER",i.SIBLING_OF_HOVER="SIBLING_OF_HOVER",i.INACTIVE="INACTIVE";let U=(0,u.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),H=e=>{let{children:t}=e,[n,i]=(0,u.useState)(null),l=(0,u.useCallback)(e=>{e!==n&&i(e)},[n]),r=(0,u.useCallback)(()=>{i(null)},[]),a=(0,u.useCallback)(e=>n?e===n?"ACTIVE_HOVER":n.startsWith("".concat(e,"."))||e===T.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(n,"."))||n===T.Ch?"CHILD_OF_HOVER":n.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[n]),o=(0,u.useMemo)(()=>({activeNodeKey:n,setActiveNodeKey:i,onMouseEnter:l,onMouseLeave:r,getNodeHoverStatus:a}),[n,i,l,r,a]);return(0,s.jsx)(U.Provider,{value:o,children:t})};var M=n(62266),Z=n(79658);let z=(0,M.Z)();var B=e=>{let{nodes:t,edges:n,options:i}=e;return(0,u.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:n};let e=(0,Z.Z)().id(e=>e.id).parentId(e=>{var t;return null===(t=n.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),l="LR"===i.direction?[35,320]:[320,35];return{nodes:z.nodeSize(l).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===i.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:n}},[t,n,i])},q=e=>{let{positionAbsoluteX:t,positionAbsoluteY:n,nodeWidth:i}=e,{setCenter:l,getZoom:s}=(0,L._K)();return{centerScreenOnNode:(0,u.useCallback)(()=>l(t+i/2,n,{duration:500,zoom:s()}),[s,t,n,i,l])}},G=n(1945),W=n.n(G),Y=n(8335),K=e=>{let{type:t,inactive:n=!1}=e;return(0,s.jsx)(L.HH,{type:t,position:"source"===t?Y.Ly.Right:Y.Ly.Left,style:{width:8,height:8,backgroundColor:n?F().FIDESUI_NEUTRAL_400:F().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},J=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:i}=e,{onCancel:l,onSubmit:a,parentKey:o}=t,d=(0,u.useRef)(null),[c,m]=(0,u.useState)(""),{centerScreenOnNode:x}=q({positionAbsoluteX:n,positionAbsoluteY:i,nodeWidth:200});return(0,u.useEffect)(()=>{m("");let e=()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await x(),e()})()},[o,x,n,i]),(0,s.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,s.jsx)(r.uFc,{placeholder:"Type label name...",ref:d,onBlur:l,onSubmit:()=>a(c),value:c,onChange:e=>m(e.target.value),onKeyUp:e=>{"Escape"===e.key&&l()},onPressEnter:()=>a(c),className:W().input}),(0,s.jsx)(K,{type:"target"})]})},X=e=>{let{getNodeHoverStatus:t}=(0,u.useContext)(U),{target:n}=e,i=t(n),r=(0,u.useCallback)(()=>{switch(i){case l.ACTIVE_HOVER:case l.PARENT_OF_HOVER:return F().FIDESUI_MINOS;case l.INACTIVE:return F().NEUTRAL_400;default:return F().FIDESUI_SANDSTONE}},[i]),a=(0,u.useCallback)(()=>{switch(i){case l.ACTIVE_HOVER:case l.PARENT_OF_HOVER:return 2;default:return 1}},[i]);return(0,s.jsx)(L.Jd,{...e,style:{stroke:r(),strokeWidth:a(),transition:"stroke 0.3s ease 0s"}})},Q=n(34770),$=n.n(Q),ee=e=>{let{data:t,positionAbsoluteX:n,positionAbsoluteY:i}=e,{onMouseEnter:a,onMouseLeave:o,getNodeHoverStatus:d}=(0,u.useContext)(U),{taxonomyType:c,taxonomyItem:m,onAddButtonClick:x,onTaxonomyItemClick:p,label:h,hasChildren:f,isLastCreatedItem:v,resetLastCreatedItemKey:y,userCanAddLabels:_}=t,{centerScreenOnNode:j}=q({positionAbsoluteX:n,positionAbsoluteY:i,nodeWidth:200});(0,u.useEffect)(()=>{let e=async()=>{await j(),a(null==m?void 0:m.fides_key)};v&&(e(),y())},[v,a,null==m?void 0:m.fides_key,y,j]);let g=d(null==m?void 0:m.fides_key),C=(0,u.useCallback)(()=>{switch(g){case l.ACTIVE_HOVER:return $()["button--hover"];case l.PARENT_OF_HOVER:return $()["button--parent-hover"];case l.INACTIVE:return $()["button--inactive"];case l.DEFAULT:case l.CHILD_OF_HOVER:case l.SIBLING_OF_HOVER:default:return""}},[g]),E=(null==m?void 0:m.fides_key)===T.Ch,A=c===T.Lo.DATA_SUBJECTS;return(0,s.jsxs)("div",{className:$().container,onMouseEnter:()=>a(null==m?void 0:m.fides_key),onMouseLeave:()=>o(null==m?void 0:m.fides_key),"data-testid":"taxonomy-node-".concat(null==m?void 0:m.fides_key),children:[(0,s.jsx)(r.wpx,{className:"".concat($().button," ").concat(C()),onClick:()=>null==p?void 0:p(m),disabled:!p,type:"text",children:(0,s.jsxs)(r.AntTypography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==m?void 0:m.active)===!1?"(disabled) ":"",h]})}),!E&&(0,s.jsx)(K,{type:"target",inactive:g===l.INACTIVE}),f&&(0,s.jsx)(K,{type:"source",inactive:g===l.INACTIVE}),_&&(!A||E)&&(0,s.jsx)("div",{className:$()["add-button-container"],children:(0,s.jsx)(r.wpx,{type:"default",className:"".concat($()["add-button"]," ").concat(g===l.ACTIVE_HOVER?$()["add-button--visible"]:""),icon:(0,s.jsx)(r.PJP.mm_,{size:20}),onClick:()=>null==x?void 0:x(m),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(h)})})]})};let et=e=>{let{taxonomyType:t,taxonomyItems:n,draftNewItem:i,lastCreatedItemKey:l,resetLastCreatedItemKey:r,onTaxonomyItemClick:a,onAddButtonClick:o,onCancelDraftItem:d,onSubmitDraftItem:c,userCanAddLabels:m}=e,{fitView:x}=(0,L._K)();(0,u.useEffect)(()=>{setTimeout(()=>x(),150)},[x,t]);let p=[(0,u.useMemo)(()=>({id:T.Ch,position:{x:0,y:0},data:{label:t,taxonomyItem:{fides_key:T.Ch},taxonomyType:t,onTaxonomyItemClick:null,onAddButtonClick:o,hasChildren:0!==n.length,userCanAddLabels:m},type:"taxonomyTreeNode"}),[t,n.length,o,m])],h=[];if(n.forEach(e=>{let n=e.name||e.fides_key.split(".").pop()||"",i={id:e.fides_key,position:{x:0,y:0},data:{label:n,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:a,onAddButtonClick:o,hasChildren:!1,isLastCreatedItem:l===e.fides_key,resetLastCreatedItemKey:r,userCanAddLabels:m},type:"taxonomyTreeNode"};p.push(i);let s=e.parent_key?p.find(t=>t.id===e.parent_key):null,d=s?s.id:T.Ch,u=e.fides_key,c={id:"".concat(d,"-").concat(u),source:d,target:u,type:"taxonomyTreeEdge"};h.push(c),s&&(s.data.hasChildren=!0)}),i){let e=i.parent_key||T.Ch;p.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:d,onSubmit:c},hidden:!i}),h.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=p.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:f,edges:v}=B({nodes:p,edges:h,options:{direction:"LR"}}),y=(0,u.useMemo)(()=>({taxonomyTreeNode:ee,textInputNode:J}),[]),_=(0,u.useMemo)(()=>({taxonomyTreeEdge:X}),[]);return(0,s.jsx)("div",{className:"size-full",style:{backgroundColor:F().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,s.jsx)(H,{children:(0,s.jsxs)(L.x$,{nodes:f,edges:v,nodeTypes:y,edgeTypes:_,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,s.jsx)(L.Aq,{color:F().FIDESUI_NEUTRAL_100,variant:L.T7.Dots,size:3}),(0,s.jsx)(L.a9,{nodeStrokeWidth:3,pannable:!0}),(0,s.jsx)(L.ZX,{showInteractive:!1})]})})})};var en=e=>(0,s.jsx)(L.tV,{children:(0,s.jsx)(et,{...e})}),ei=()=>{let[e,t]=(0,u.useState)(T.Lo.DATA_CATEGORIES),{createTrigger:n,getAllTrigger:i,taxonomyItems:l=[]}=A({taxonomyType:e}),a=(0,d.useSearchParams)(),f=(null==a?void 0:a.get("showDisabledItems"))==="true";(0,u.useEffect)(()=>{i()},[i,e]);let[v,y]=(0,u.useState)(null),[_,j]=(0,u.useState)(null),[g,C]=(0,u.useState)(null);(0,u.useEffect)(()=>{j(null),C(null),y(null)},[e]);let E=(0,r.pmc)(),b=(0,u.useCallback)(async e=>{if(!_)return;let t=(null==_?void 0:_.parent_key)===T.Ch,i={..._,name:e,parent_key:t?null:_.parent_key},l=await n(i);if((0,c.D4)(l)){E((0,h.Vo)((0,c.e$)(l.error)));return}C(l.data.fides_key),E((0,h.t5)("New label successfully created")),j(null)},[n,_,E]),S=o()(l,"active"),I=(0,p.Tg)([(0,T.Hy)(e).CREATE]);return(0,s.jsxs)(m.Z,{title:"Taxonomy",children:[(0,s.jsxs)(r.jqI,{vertical:!0,className:"h-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(x.Z,{heading:"Taxonomy"}),(0,s.jsx)("div",{className:"hidden",children:(0,s.jsx)("div",{className:"mb-5 flex justify-between",children:(0,s.jsxs)(r.vyj.Compact,{children:[(0,s.jsx)(r.uFc,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,s.jsx)(r.wpx,{type:"default",children:"Clear"})]})})})]}),(0,s.jsxs)("div",{className:"relative grow",children:[(0,s.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,s.jsx)(r.AHg,{selectedKeys:[e],onSelect:e=>{let{key:n}=e;return t(n)},items:(0,c.MM)(T.Lo).map(e=>({label:e.label,key:e.value})),"data-testid":"taxonomy-type-selector"})}),!!l.length&&(0,s.jsx)(en,{userCanAddLabels:I,taxonomyItems:f?l:S,draftNewItem:_,lastCreatedItemKey:g,resetLastCreatedItemKey:()=>C(null),onTaxonomyItemClick:e=>{y(e)},onAddButtonClick:e=>{var t;j({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:e,onCancelDraftItem:()=>j(null),onSubmitDraftItem:b})]})]}),v&&(0,s.jsx)(O,{taxonomyItem:v,taxonomyType:e,onClose:()=>y(null)})]})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=n(19043)},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}},function(e){e.O(0,[1096,2858,2866,9278,3662,570,2888,9774,179],function(){return e(e.s=71180)}),_N_E=e.O()}]);