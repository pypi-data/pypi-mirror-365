(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2815],{79349:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},52033:function(e,t,n){var i=n(26194),r=n(26789)(i);e.exports=r},23545:function(e,t,n){var i=n(97141),r=n(72889);e.exports=function e(t,n,s,a,o){var l=-1,c=t.length;for(s||(s=r),o||(o=[]);++l<c;){var u=t[l];n>0&&s(u)?n>1?e(u,n-1,s,a,o):i(o,u):a||(o[o.length]=u)}return o}},49819:function(e,t,n){var i=n(18911)();e.exports=i},26194:function(e,t,n){var i=n(49819),r=n(50098);e.exports=function(e,t){return e&&i(e,t,r)}},67375:function(e,t,n){var i=n(52033),r=n(80068);e.exports=function(e,t){var n=-1,s=r(e)?Array(e.length):[];return i(e,function(e,i,r){s[++n]=t(e,i,r)}),s}},98497:function(e,t,n){var i=n(66070),r=n(79867),s=n(89278),a=n(67375),o=n(73303),l=n(39334),c=n(96348),u=n(31137),d=n(19785);e.exports=function(e,t,n){t=t.length?i(t,function(e){return d(e)?function(t){return r(t,1===e.length?e[0]:e)}:e}):[u];var p=-1;return t=i(t,l(s)),o(a(e,function(e,n,r){return{criteria:i(t,function(t){return t(e)}),index:++p,value:e}}),function(e,t){return c(e,t,n)})}},1197:function(e,t,n){var i=n(31137),r=n(11871),s=n(63132);e.exports=function(e,t){return s(r(e,t,i),e+"")}},54459:function(e,t,n){var i=n(551),r=n(42630),s=n(31137),a=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:i(t),writable:!0})}:s;e.exports=a},73303:function(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},17845:function(e,t,n){var i=n(55193);e.exports=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,s=e==e,a=i(e),o=void 0!==t,l=null===t,c=t==t,u=i(t);if(!l&&!u&&!a&&e>t||a&&o&&c&&!l&&!u||r&&o&&c||!n&&c||!s)return 1;if(!r&&!a&&!u&&e<t||u&&n&&s&&!r&&!a||l&&n&&s||!o&&s||!c)return -1}return 0}},96348:function(e,t,n){var i=n(17845);e.exports=function(e,t,n){for(var r=-1,s=e.criteria,a=t.criteria,o=s.length,l=n.length;++r<o;){var c=i(s[r],a[r]);if(c){if(r>=l)return c;return c*("desc"==n[r]?-1:1)}}return e.index-t.index}},26789:function(e,t,n){var i=n(80068);e.exports=function(e,t){return function(n,r){if(null==n)return n;if(!i(n))return e(n,r);for(var s=n.length,a=t?s:-1,o=Object(n);(t?a--:++a<s)&&!1!==r(o[a],a,o););return n}}},18911:function(e){e.exports=function(e){return function(t,n,i){for(var r=-1,s=Object(t),a=i(t),o=a.length;o--;){var l=a[e?o:++r];if(!1===n(s[l],l,s))break}return t}}},42630:function(e,t,n){var i=n(81822),r=function(){try{var e=i(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},72889:function(e,t,n){var i=n(96539),r=n(2900),s=n(19785),a=i?i.isConcatSpreadable:void 0;e.exports=function(e){return s(e)||r(e)||!!(a&&e&&e[a])}},57535:function(e,t,n){var i=n(85638),r=n(80068),s=n(42383),a=n(11611);e.exports=function(e,t,n){if(!a(n))return!1;var o=typeof t;return("number"==o?!!(r(n)&&s(t,n.length)):"string"==o&&t in n)&&i(n[t],e)}},11871:function(e,t,n){var i=n(79349),r=Math.max;e.exports=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var s=arguments,a=-1,o=r(s.length-t,0),l=Array(o);++a<o;)l[a]=s[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=s[a];return c[t]=n(l),i(e,this,c)}}},63132:function(e,t,n){var i=n(54459),r=n(49591)(i);e.exports=r},49591:function(e){var t=Date.now;e.exports=function(e){var n=0,i=0;return function(){var r=t(),s=16-(r-i);if(i=r,s>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},551:function(e){e.exports=function(e){return function(){return e}}},95099:function(e,t,n){var i=n(23545),r=n(98497),s=n(1197),a=n(57535),o=s(function(e,t){if(null==e)return[];var n=t.length;return n>1&&a(e,t[0],t[1])?t=[]:n>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),r(e,i(t,1),[])});e.exports=o},24081:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/messaging",function(){return n(18504)}])},35287:function(e,t,n){"use strict";var i=n(24246),r=n(13577),s=n(88038),a=n.n(s);n(27378),t.Z=e=>{let{children:t,title:n,mainProps:s}=e;return(0,i.jsxs)(r.kCb,{"data-testid":n,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,i.jsxs)(a(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsx)(r.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...s,children:t})]})}},87361:function(e,t,n){"use strict";var i=n(24246),r=n(13577);t.Z=e=>{let{title:t,text:n,onClose:s}=e;return(0,i.jsxs)(r.Ugi,{backgroundColor:"gray.50",border:"1px solid",borderRadius:"md",justifyContent:"space-between",py:4,pr:6,pl:3,"data-testid":"empty-state",gap:2,position:"relative",children:[s&&(0,i.jsx)(r.Two,{boxSize:5,position:"absolute",right:3,top:3,zIndex:1,cursor:"pointer",p:1,onClick:s}),(0,i.jsx)(r.iid,{alignSelf:"start",color:"minos",mt:.5,flexGrow:0}),(0,i.jsxs)(r.kCb,{direction:"column",gap:2,flexGrow:1,children:[(0,i.jsx)(r.X6q,{fontSize:"md",children:t}),(0,i.jsx)(r.xvT,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:n})]})]})}},58754:function(e,t,n){"use strict";var i=n(24246),r=n(13577),s=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:a=!0,children:o,rightContent:l,style:c,...u}=e;return(0,i.jsxs)("div",{...u,style:a?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...c}:{paddingBottom:"24px",...c},children:[(0,i.jsxs)(r.jqI,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(r.lQT,{className:n||o?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,l&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:l})]}),!!n&&(0,i.jsx)(s.m,{className:o?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),o]})}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return c}});var i=n(24246),r=n(13577),s=n(79894),a=n.n(s),o=n(27378);let{Text:l}=r.AntTypography,c=e=>{let{items:t,...n}=e,s=(0,o.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let s=n===t.length-1,o={...e},c=o.onClick&&!o.href;return("string"==typeof o.title&&(o.title=(0,i.jsx)(l,{style:{color:"inherit",maxWidth:s?void 0:400},ellipsis:!s,children:o.title})),c)?o.title=(0,i.jsx)(r.wpx,{type:"text",size:"small",icon:o.icon,onClick:o.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:o.title}):(o.icon&&(o.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:o.icon}),o.title]})),o.href&&o.title&&(o.title=(0,i.jsx)(a(),{href:o.href,className:"ant-breadcrumb-link",children:o.title}),delete o.href)),o}),[t]);return(0,i.jsx)(r.zrq,{items:s,...n})}},67810:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}}),(i=r||(r={})).PRIVACY_REQUEST_REVIEW_APPROVE="privacy_request_review_approve",i.PRIVACY_REQUEST_REVIEW_DENY="privacy_request_review_deny",i.PRIVACY_REQUEST_RECEIPT="privacy_request_receipt",i.PRIVACY_REQUEST_COMPLETE_ACCESS="privacy_request_complete_access",i.PRIVACY_REQUEST_COMPLETE_DELETION="privacy_request_complete_deletion",i.SUBJECT_IDENTITY_VERIFICATION="subject_identity_verification";var i,r,s={[r.PRIVACY_REQUEST_COMPLETE_ACCESS]:"Access request completed",[r.PRIVACY_REQUEST_COMPLETE_DELETION]:"Erasure request completed",[r.PRIVACY_REQUEST_RECEIPT]:"Privacy request received",[r.PRIVACY_REQUEST_REVIEW_APPROVE]:"Privacy request approved",[r.PRIVACY_REQUEST_REVIEW_DENY]:"Privacy request denied",[r.SUBJECT_IDENTITY_VERIFICATION]:"Subject identity verification"}},5058:function(e,t,n){"use strict";n.d(t,{Vw:function(){return s},ms:function(){return i},pS:function(){return r},vm:function(){return a}});let{useGetSummaryMessagingTemplatesQuery:i,usePutMessagingTemplateByIdMutation:r,useCreateMessagingTemplateByTypeMutation:s,usePatchMessagingTemplateByIdMutation:a}=n(78780).u.injectEndpoints({endpoints:e=>({getSummaryMessagingTemplates:e.query({query:e=>({method:"GET",url:"plus/messaging/templates/summary",params:e}),providesTags:()=>["Property-Specific Messaging Templates"]}),putMessagingTemplateById:e.mutation({query:e=>{let{templateId:t,template:n}=e;return{url:"plus/messaging/templates/".concat(t),method:"PUT",body:n}},invalidatesTags:()=>["Property-Specific Messaging Templates"]}),patchMessagingTemplateById:e.mutation({query:e=>{let{templateId:t,template:n}=e;return{url:"plus/messaging/templates/".concat(t),method:"PATCH",body:n}},invalidatesTags:()=>["Property-Specific Messaging Templates"]}),createMessagingTemplateByType:e.mutation({query:e=>{let{templateType:t,template:n}=e;return{url:"plus/messaging/templates/".concat(t),method:"POST",body:n}},invalidatesTags:()=>["Property-Specific Messaging Templates"]})})})},18504:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var i=n(24246),r=n(92222),s=n(59003),a=n(13577),o=n(95099),l=n.n(o),c=n(86677),u=n(27378),d=n(35287),p=n(71795),g=n(87361),m=n(46238),f=n(77830),x=n(58754),h=n(47935),v=n(42904),j=n(7426),y=n(67810),b=e=>{let{isOpen:t,onClose:n,onAccept:r}=e,[s,o]=(0,u.useState)(void 0),l=Object.keys(y.Z).map(e=>({value:e,label:y.Z[e]}));return(0,i.jsxs)(a.u_l,{isOpen:t,onClose:n,size:"2xl",isCentered:!0,children:[(0,i.jsx)(a.ZAr,{}),(0,i.jsxs)(a.hzk,{"data-testid":"add-messaging-template-modal",children:[(0,i.jsx)(a.xBx,{borderBottomWidth:1,fontWeight:"bold",children:"Select message template"}),(0,i.jsxs)(a.fef,{children:[(0,i.jsx)(a.xvT,{color:"gray.700",fontWeight:"medium",fontSize:"sm",marginBottom:3,marginTop:1,children:"Add a new email message by selecting a template below and clicking accept."}),(0,i.jsx)(a.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"medium",marginBottom:2,children:"Choose template:"}),(0,i.jsx)(a.xuv,{"data-testid":"template-type-selector",children:(0,i.jsx)(a.WPr,{options:l,onChange:e=>{o(e)},className:"w-full"})})]}),(0,i.jsx)(a.mzw,{justifyContent:"flex-start",children:(0,i.jsxs)("div",{className:"flex w-full gap-4",children:[(0,i.jsx)(a.wpx,{onClick:n,"data-testid":"cancel-btn",className:"grow",children:"Cancel"}),(0,i.jsx)(a.wpx,{onClick:()=>r(s),type:"primary","data-testid":"confirm-btn",disabled:!s,className:"grow",children:"Next"})]})})]})]})},_=n(5058),E=n(812),C=n(46628),T=n(31883),w=()=>{let e=(0,a.pmc)(),[t]=(0,_.vm)();return{toggleIsTemplateEnabled:(0,u.useCallback)(async n=>{let{isEnabled:i,templateId:r}=n,s=await t({templateId:r,template:{is_enabled:i}});if((0,T.D4)(s)){e((0,C.Vo)((0,E.e$)(s.error)));return}e((0,C.t5)("Messaging template ".concat(i?"enabled":"disabled")))},[t,e])}},R=n(64826);let P=(0,r.Cl)(),S={items:[],total:0,page:1,size:50,pages:1},I=()=>(0,i.jsx)(a.gCW,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",textAlign:"center",children:(0,i.jsxs)(a.gCW,{children:[(0,i.jsx)(a.xvT,{fontSize:"md",fontWeight:"600",children:"It looks like it’s your first time here!"}),(0,i.jsxs)(a.xvT,{fontSize:"sm",children:["Add new email templates with the ",'"Add message +"'," button.",(0,i.jsx)("br",{})]})]})}),k=()=>{let{isLoading:e,data:t}=(0,R.gz)({page:1,size:100}),n=null==t?void 0:t.items.filter(e=>!e.messaging_templates||0===e.messaging_templates.length),r=!!(!e&&(null==n?void 0:n.length)),s="missing-messages-notice-".concat(null==n?void 0:n.map(e=>e.id).join("-")),[o,l]=(0,p._)("notices.dismissedMessageNoticeId",""),c=s===o;return r&&!c?(0,i.jsx)(a.xuv,{mb:6,"data-testid":"notice-properties-without-messaging-templates",children:(0,i.jsx)(g.Z,{title:"Not all properties have messages configured.",text:(0,i.jsxs)(a.xvT,{as:"span",children:["You have properties that do not have messages configured. Users who submit privacy requests for these properties may not receive the necessary emails regarding their requests."," ",(0,i.jsx)(a.xuv,{as:"span",children:(0,i.jsx)(m.b,{label:null==n?void 0:n.map(e=>e.name).join(", ")})})]}),onClose:()=>{l(s)}})}):null},A=()=>{let{data:e}=(0,j.tB)({api_set:!1});return(null==e?void 0:e.notifications.enable_property_specific_messaging)?null:(0,i.jsx)(a.xuv,{mb:6,"data-testid":"notice-properties-without-messaging-templates",children:(0,i.jsx)(g.Z,{title:"Basic messaging enabled",text:(0,i.jsxs)(a.xvT,{as:"span",children:["In basic messaging mode, you can edit the content of your messages from this screen. Please note that in basic messaging, the “Enable” toggle does not apply. Fides also supports property specific messaging mode. Read our"," ",(0,i.jsx)(a.rUS,{href:"https://fid.es/property-specific-messaging",target:"_blank",rel:"nofollow",textDecoration:"underline",children:"docs"})," ","for more information about property specific mode or contact"," ",(0,i.jsx)(a.rUS,{href:"mailto:support@ethyca.com",textDecoration:"underline",children:"Ethyca support"})," ","to enable this mode on your Fides instance."]})})})};var M=()=>{let e=(0,c.useRouter)(),{toggleIsTemplateEnabled:t}=w(),{PAGE_SIZES:n,pageSize:o,setPageSize:p,onPreviousPageClick:g,isPreviousPageDisabled:m,onNextPageClick:j,isNextPageDisabled:E,startRange:C,endRange:T,pageIndex:R,setTotalPages:M}=(0,h.oi)(),{data:N,isLoading:z,isFetching:V}=(0,_.ms)({page:R,size:o}),{items:q,total:O,pages:U}=(0,u.useMemo)(()=>null!=N?N:S,[N]);(0,u.useEffect)(()=>{M(U)},[U,M]);let[W,B]=(0,u.useState)(!1),Y=(0,u.useMemo)(()=>[P.accessor(e=>e.type,{id:"message",cell:e=>(0,i.jsx)(h.G3,{value:y.Z[e.getValue()]}),header:e=>(0,i.jsx)(h.Rr,{value:"Message",...e}),size:150}),P.accessor(e=>(e.properties||[]).map(e=>e.name),{id:"properties",cell:e=>(0,i.jsx)(h.WP,{suffix:"properties",value:e.getValue(),...e}),header:e=>(0,i.jsx)(h.Rr,{value:"Properties",...e}),meta:{showHeaderMenu:!0},size:250}),P.accessor(e=>e.is_enabled,{id:"is_enabled",cell:e=>(0,i.jsx)(a.kCb,{align:"center",justifyContent:"flex-start",w:"full",h:"full",children:(0,i.jsx)(a.rAg,{checked:e.getValue(),onChange:n=>{t({isEnabled:n,templateId:e.row.original.id})}})}),header:e=>(0,i.jsx)(h.Rr,{value:"Enable",...e}),size:200,meta:{disableRowClick:!0}})],[t]),D=(0,u.useMemo)(()=>l()(q,"id"),[q]),Z=(0,s.b7)({getCoreRowModel:(0,r.sC)(),getFilteredRowModel:(0,r.vL)(),getSortedRowModel:(0,r.tj)(),columns:Y,data:D,columnResizeMode:"onChange"});return(0,i.jsxs)(d.Z,{title:"Messaging",children:[(0,i.jsx)(x.Z,{heading:"Messaging"}),(0,i.jsx)(A,{}),(0,i.jsx)(k,{}),(0,i.jsx)(h.Q$,{children:(0,i.jsx)(a.Ugi,{alignItems:"center",spacing:4,marginLeft:"auto",children:(0,i.jsx)(a.wpx,{type:"primary","data-testid":"add-message-btn",onClick:()=>B(!0),children:"Add message +"})})}),z?(0,i.jsx)(h.I4,{rowHeight:36,numRows:15}):(0,i.jsx)(h.ZK,{tableInstance:Z,onRowClick:t=>{e.push({pathname:f.ax,query:{id:t.id}})},emptyTableNotice:(0,i.jsx)(I,{})}),(0,i.jsx)(v.s8,{totalRows:O||0,pageSizes:n,setPageSize:p,onPreviousPageClick:g,isPreviousPageDisabled:m||V,onNextPageClick:j,isNextPageDisabled:E||V,startRange:C,endRange:T}),(0,i.jsx)(b,{isOpen:W,onClose:()=>B(!1),onAccept:t=>{e.push({pathname:f.sM,query:{templateType:t}})}})]})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=n(19043)}},function(e){e.O(0,[2858,2866,9278,2888,9774,179],function(){return e(e.s=24081)}),_N_E=e.O()}]);