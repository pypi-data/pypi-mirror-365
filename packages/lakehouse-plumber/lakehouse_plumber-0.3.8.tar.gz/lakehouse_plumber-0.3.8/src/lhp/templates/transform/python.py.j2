@dlt.view()
def {{ target_view }}():
    """{{ description }}"""
    {% if source_views %}
    # Load source view(s)
    {% for source in source_views %}
    {% if readMode == "stream" %}
    {{ source }}_df = spark.readStream.table("{{ source }}")
    {% else %}
    {{ source }}_df = spark.read.table("{{ source }}")
    {% endif %}
    {% endfor %}
    
    # Apply Python transformation
    parameters = {{ parameters | tojson }}
    {% if source_views|length == 1 %}
    return {{ function_name }}({{ source_views[0] }}_df, spark, parameters)
    {% else %}
    dataframes = [{{ source_views|join('_df, ') }}_df]
    return {{ function_name }}(dataframes, spark, parameters)
    {% endif %}
    {% else %}
    # No source views - function generates data
    parameters = {{ parameters | tojson }}
    return {{ function_name }}(spark, parameters)
    {% endif %} 