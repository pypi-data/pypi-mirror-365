"use strict";(globalThis["webpackChunkunmanic_frontend"]=globalThis["webpackChunkunmanic_frontend"]||[]).push([[0],{1948:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ke});var l=a(2444),n=a(4044);const s={class:"q-pa-none"},i={class:"row"},o={class:"col-sm-12 col-md-10 col-lg-8"},r={class:"q-mb-none"},c={class:"q-gutter-sm"},d={key:0,class:"text-weight-bold"},u=(0,l.QD)("br",null,null,-1),m={class:"text-weight-bold"},y={key:1},b={key:2},p=(0,l.QD)("br",null,null,-1),g={class:"text-weight-bold"},h={class:"text-weight-bold"},f={key:0},k={key:1},S={class:"text-weight-bold"},_={class:"row"},Q={class:"col-6 text-left"},A={class:"row"},z={class:"col-6 text-left"},W={class:"text-grey-8 q-gutter-xs"},L={class:"q-mb-none"},v={class:"q-gutter-sm"},$={key:2,class:"sub-setting"},T={class:"q-gutter-sm"},q={class:"q-gutter-sm"},w={class:"q-gutter-sm"},x={class:"q-mb-none"},D={class:"q-gutter-sm"},F={class:"q-mb-none"},O={class:"q-gutter-sm"},K={class:"q-mb-none"},V={class:"q-gutter-sm"},P={key:2,class:"sub-setting"},C={class:"q-gutter-sm"},I={class:"q-gutter-sm"};function E(e,t,a,E,M,N){const R=(0,l.E1)("q-skeleton"),Y=(0,l.E1)("q-avatar"),U=(0,l.E1)("q-tooltip"),B=(0,l.E1)("q-item-section"),j=(0,l.E1)("q-item-label"),H=(0,l.E1)("q-icon"),G=(0,l.E1)("q-separator"),J=(0,l.E1)("q-btn"),X=(0,l.E1)("q-item"),Z=(0,l.E1)("q-list"),ee=(0,l.E1)("q-space"),te=(0,l.E1)("q-bar"),ae=(0,l.E1)("q-toggle"),le=(0,l.E1)("q-input"),ne=(0,l.E1)("q-slider"),se=(0,l.E1)("q-form"),ie=(0,l.E1)("MobileSettingsQuickNav"),oe=(0,l.E1)("q-page");return(0,l.Wz)(),(0,l.Az)(oe,{padding:""},{default:(0,l.Ql)((()=>[(0,l.QD)("div",s,[(0,l.QD)("div",i,[(0,l.QD)("div",o,[(0,l.QD)("div",{class:(0,n.WN)(e.$q.platform.is.mobile?"q-ma-sm":"q-ma-sm q-pa-md")},[(0,l.K2)(se,{onSubmit:N.save,class:"q-gutter-md"},{default:(0,l.Ql)((()=>[(0,l.QD)("h5",r,(0,n.WA)(e.$t("components.settings.library.pathConfiguration")),1),(0,l.QD)("div",c,[null===M.libraryPaths?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"text"})):(0,l.g1)("",!0),(0,l.K2)(Z,{bordered:"",separator:"",class:"rounded-borders"},{default:(0,l.Ql)((()=>[((0,l.Wz)(!0),(0,l.An)(l.ae,null,(0,l.mi)(M.libraryPaths,((t,a)=>((0,l.Wz)(),(0,l.Az)(X,{key:a,"active-class":"library-path-list-item"},{default:(0,l.Ql)((()=>[(0,l.K2)(B,{avatar:""},{default:(0,l.Ql)((()=>[(0,l.K2)(Y,{"text-color":"grey-8",icon:"source"}),(0,l.K2)(U,null,{default:(0,l.Ql)((()=>[0===a?((0,l.Wz)(),(0,l.An)("span",d,[(0,l.mY)(" ("+(0,n.WA)(e.$t("components.settings.library.defaultLibrary"))+") ",1),u])):(0,l.g1)("",!0),(0,l.QD)("span",m,(0,n.WA)(e.$t("components.settings.library.path"))+":",1),t.enableRemoteOnly?((0,l.Wz)(),(0,l.An)("span",y," ("+(0,n.WA)(e.$t("components.settings.library.libraryRemoteOnlyStatus"))+") ",1)):((0,l.Wz)(),(0,l.An)("span",b,(0,n.WA)(t.path),1)),p,(0,l.QD)("span",g,(0,n.WA)(e.$t("components.settings.common.tags"))+":",1),(0,l.mY)(" "+(0,n.WA)(t.tags.join(", ")||e.$t("status.none")),1)])),_:2},1024)])),_:2},1024),(0,l.K2)(B,{class:"q-px-sm q-mx-sm"},{default:(0,l.Ql)((()=>[0===a?((0,l.Wz)(),(0,l.Az)(j,{key:0},{default:(0,l.Ql)((()=>[(0,l.mY)((0,n.WA)(t.name)+" * ",1),(0,l.K2)(U,null,{default:(0,l.Ql)((()=>[(0,l.mY)((0,n.WA)(e.$t("tooltips.defaultLibrary")),1)])),_:1})])),_:2},1024)):((0,l.Wz)(),(0,l.Az)(j,{key:1},{default:(0,l.Ql)((()=>[(0,l.mY)((0,n.WA)(t.name),1)])),_:2},1024)),(0,l.K2)(j,{caption:"",lines:"1"},{default:(0,l.Ql)((()=>[(0,l.QD)("span",h,(0,n.WA)(e.$t("components.settings.library.path"))+": ",1),t.enableRemoteOnly?((0,l.Wz)(),(0,l.An)("span",f," ("+(0,n.WA)(e.$t("components.settings.library.libraryRemoteOnlyStatus"))+") ",1)):((0,l.Wz)(),(0,l.An)("span",k,(0,n.WA)(t.path),1))])),_:2},1024),(0,l.K2)(j,{caption:"",lines:"1"},{default:(0,l.Ql)((()=>[(0,l.QD)("span",S,(0,n.WA)(e.$t("components.settings.common.tags"))+": ",1),(0,l.mY)(" "+(0,n.WA)(t.tags.join(", ")||""),1)])),_:2},1024)])),_:2},1024),e.$q.platform.is.mobile?(0,l.g1)("",!0):((0,l.Wz)(),(0,l.Az)(B,{key:0},{default:(0,l.Ql)((()=>[(0,l.K2)(j,{lines:"1"},{default:(0,l.Ql)((()=>[(0,l.QD)("div",_,[(0,l.QD)("div",Q,[(0,l.QD)("span",{class:(0,n.WN)(t.enableScanner&&!t.enableRemoteOnly?"text-primary":"text-grey-8")},[t.enableScanner&&!t.enableRemoteOnly?((0,l.Wz)(),(0,l.Az)(H,{key:0,color:"check",name:"check"})):((0,l.Wz)(),(0,l.Az)(H,{key:1,color:"close",name:"close"})),(0,l.mY)(" | "+(0,n.WA)(e.$t("components.settings.library.libraryScannerStatusLabel")),1)],2)])])])),_:2},1024),(0,l.K2)(j,{lines:"1"},{default:(0,l.Ql)((()=>[(0,l.QD)("div",A,[(0,l.QD)("div",z,[(0,l.QD)("span",{class:(0,n.WN)(t.enableInotify&&!t.enableRemoteOnly?"text-primary":"text-grey-8")},[t.enableInotify&&!t.enableRemoteOnly?((0,l.Wz)(),(0,l.Az)(H,{key:0,color:"check",name:"check"})):((0,l.Wz)(),(0,l.Az)(H,{key:1,color:"close",name:"close"})),(0,l.mY)(" | "+(0,n.WA)(e.$t("components.settings.library.libraryFileMonitorStatusLabel")),1)],2)])])])),_:2},1024)])),_:2},1024)),(0,l.K2)(G,{inset:"",vertical:"",class:"q-mx-sm"}),(0,l.K2)(B,{center:"",side:""},{default:(0,l.Ql)((()=>[(0,l.QD)("div",W,[(0,l.K2)(J,{flat:"",dense:"",round:"",size:"12px",color:"grey-8",icon:"tune",onClick:e=>N.configureLibraryPath(a)},{default:(0,l.Ql)((()=>[(0,l.K2)(U,{class:"bg-white text-primary"},{default:(0,l.Ql)((()=>[(0,l.mY)((0,n.WA)(e.$t("tooltips.configure")),1)])),_:1})])),_:2},1032,["onClick"]),(0,l.K2)(J,{flat:"",dense:"",round:"",size:"12px",color:"negative",icon:"delete",disable:t.locked,onClick:e=>N.deleteLibrary(a)},{default:(0,l.Ql)((()=>[(0,l.K2)(U,{class:"bg-white text-primary"},{default:(0,l.Ql)((()=>[(0,l.mY)((0,n.WA)(e.$t("tooltips.delete")),1)])),_:1})])),_:2},1032,["disable","onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,l.K2)(te,{class:"bg-transparent"},{default:(0,l.Ql)((()=>[(0,l.K2)(ee),(0,l.K2)(J,{round:"",flat:"",color:"primary",icon:"add",onClick:N.addNewLibraryWithDirectoryBrowser},{default:(0,l.Ql)((()=>[(0,l.K2)(U,{class:"bg-white text-primary"},{default:(0,l.Ql)((()=>[(0,l.mY)((0,n.WA)(e.$t("tooltips.add")),1)])),_:1})])),_:1},8,["onClick"])])),_:1})]),(0,l.K2)(G,{class:"q-my-lg"}),(0,l.QD)("h5",L,(0,n.WA)(e.$t("components.settings.library.libraryScanner")),1),(0,l.QD)("div",v,[null===M.enableLibraryScanner?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QToggle"})):((0,l.Wz)(),(0,l.Az)(ae,{key:1,modelValue:M.enableLibraryScanner,"onUpdate:modelValue":t[0]||(t[0]=e=>M.enableLibraryScanner=e),label:e.$t("components.settings.library.enableLibraryScanner")},null,8,["modelValue","label"])),M.enableLibraryScanner?((0,l.Wz)(),(0,l.An)("div",$,[(0,l.QD)("div",T,[null===M.libraryScanSchedule?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QInput"})):(0,l.g1)("",!0),M.enableLibraryScanner&&null!==M.libraryScanSchedule?((0,l.Wz)(),(0,l.Az)(le,{key:1,outlined:"",type:"number",modelValue:M.libraryScanSchedule,"onUpdate:modelValue":t[1]||(t[1]=e=>M.libraryScanSchedule=e),label:e.$t("components.settings.library.libraryScannerSchedule"),"lazy-rules":"",rules:[t=>null!==t&&""!==t||e.$t("components.settings.library.libraryScannerScheduleNotValid"),t=>t>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,l.g1)("",!0)])])):(0,l.g1)("",!0)]),(0,l.QD)("div",q,[null===M.runLibraryScanOnStart?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QToggle"})):(0,l.g1)("",!0),null!==M.runLibraryScanOnStart?((0,l.Wz)(),(0,l.Az)(ae,{key:1,modelValue:M.runLibraryScanOnStart,"onUpdate:modelValue":t[2]||(t[2]=e=>M.runLibraryScanOnStart=e),label:e.$t("components.settings.library.runLibraryScanOnStart")},null,8,["modelValue","label"])):(0,l.g1)("",!0)]),(0,l.QD)("div",w,[null===M.libraryScanFollowSymlinks?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QToggle"})):(0,l.g1)("",!0),null!==M.libraryScanFollowSymlinks?((0,l.Wz)(),(0,l.Az)(ae,{key:1,modelValue:M.libraryScanFollowSymlinks,"onUpdate:modelValue":t[3]||(t[3]=e=>M.libraryScanFollowSymlinks=e),label:e.$t("components.settings.library.followSymlinks")},null,8,["modelValue","label"])):(0,l.g1)("",!0)]),(0,l.K2)(G,{class:"q-my-lg"}),(0,l.QD)("h5",x,(0,n.WA)(e.$t("components.settings.library.fileTesting")),1),(0,l.QD)("div",D,[null===M.concurrentFileTesters?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QInput"})):(0,l.g1)("",!0),null!==M.concurrentFileTesters?((0,l.Wz)(),(0,l.Az)(le,{key:1,readonly:"",outlined:"",color:"primary",modelValue:M.concurrentFileTesters,"onUpdate:modelValue":t[4]||(t[4]=e=>M.concurrentFileTesters=e),label:e.$t("components.settings.library.concurrentFileTesters"),placeholder:M.concurrentFileTesters},null,8,["modelValue","label","placeholder"])):(0,l.g1)("",!0),null===M.concurrentFileTesters?((0,l.Wz)(),(0,l.Az)(R,{key:2,type:"QSlider"})):(0,l.g1)("",!0),null!==M.concurrentFileTesters?((0,l.Wz)(),(0,l.Az)(ne,{key:3,modelValue:M.concurrentFileTesters,"onUpdate:modelValue":t[5]||(t[5]=e=>M.concurrentFileTesters=e),min:1,max:10,step:1,color:"primary"},null,8,["modelValue"])):(0,l.g1)("",!0)]),(0,l.K2)(G,{class:"q-my-lg"}),(0,l.QD)("h5",F,(0,n.WA)(e.$t("components.settings.library.pendingTasks")),1),(0,l.QD)("div",O,[null===M.clearPendingTasksOnStart?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QToggle"})):((0,l.Wz)(),(0,l.Az)(ae,{key:1,modelValue:M.clearPendingTasksOnStart,"onUpdate:modelValue":t[6]||(t[6]=e=>M.clearPendingTasksOnStart=e),label:e.$t("components.settings.library.clearPendingTasksOnStart")},null,8,["modelValue","label"]))]),(0,l.K2)(G,{class:"q-my-lg"}),(0,l.QD)("h5",K,(0,n.WA)(e.$t("components.settings.library.completedTasks")),1),(0,l.QD)("div",V,[null===M.autoManageCompletedTasks?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QToggle"})):((0,l.Wz)(),(0,l.Az)(ae,{key:1,modelValue:M.autoManageCompletedTasks,"onUpdate:modelValue":t[7]||(t[7]=e=>M.autoManageCompletedTasks=e),label:e.$t("components.settings.library.autoManageCompletedTasks")},null,8,["modelValue","label"])),M.autoManageCompletedTasks?((0,l.Wz)(),(0,l.An)("div",P,[(0,l.QD)("div",C,[null===M.maxAgeOfCompletedTasks?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QInput"})):(0,l.g1)("",!0),M.autoManageCompletedTasks&&null!==M.maxAgeOfCompletedTasks?((0,l.Wz)(),(0,l.Az)(le,{key:1,outlined:"",type:"number",modelValue:M.maxAgeOfCompletedTasks,"onUpdate:modelValue":t[8]||(t[8]=e=>M.maxAgeOfCompletedTasks=e),label:e.$t("components.settings.library.maxAgeOfCompletedTasks"),"lazy-rules":"",rules:[t=>null!==t&&""!==t||e.$t("components.settings.pleaseEnterAValidNumber"),t=>t>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,l.g1)("",!0)]),(0,l.QD)("div",I,[null===M.alwaysKeepFailedTasks?((0,l.Wz)(),(0,l.Az)(R,{key:0,type:"QInput"})):((0,l.Wz)(),(0,l.Az)(ae,{key:1,modelValue:M.alwaysKeepFailedTasks,"onUpdate:modelValue":t[9]||(t[9]=e=>M.alwaysKeepFailedTasks=e),label:e.$t("components.settings.library.alwaysKeepFailedTasks")},null,8,["modelValue","label"]))])])):(0,l.g1)("",!0)]),(0,l.QD)("div",null,[(0,l.K2)(J,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])],2)])]),(0,l.K2)(ie,{prevEnabled:!1,prevLabel:"none",prevPath:"/ui/settings-plugins",nextEnabled:!0,nextLabel:e.$t("navigation.workers"),nextPath:"/ui/settings-workers"},null,8,["nextLabel"])])])),_:1})}var M=a(8564),N=a(5836),R=a(1416),Y=a(3160),U=a(2520),B=a(6728),j=a(7928),H=a(1156),G=a(216);const J={name:"SettingsLibrary",components:{MobileSettingsQuickNav:H.c},setup(){(0,R.c)();const{t:e}=(0,Y.gd)();let t=null,a=(0,M.k)(e);function n(){t=a.init()}function s(){a.close()}(0,l.u2)((()=>{n()})),(0,l.wx)((()=>{s()}))},data(){return{libraryPath:(0,N.IL)(null),libraryPaths:(0,N.IL)(null),newLibraryPath:(0,N.IL)(!1),enableLibraryScanner:(0,N.IL)(null),libraryScanSchedule:(0,N.IL)(null),libraryScanFollowSymlinks:(0,N.IL)(null),concurrentFileTesters:(0,N.IL)(null),runLibraryScanOnStart:(0,N.IL)(null),enableLibraryFileMonitor:(0,N.IL)(null),clearPendingTasksOnStart:(0,N.IL)(null),autoManageCompletedTasks:(0,N.IL)(null),maxAgeOfCompletedTasks:(0,N.IL)(null),alwaysKeepFailedTasks:(0,N.IL)(null)}},methods:{addNewLibraryWithDirectoryBrowser:function(){this.$q.dialog({component:U.c,componentProps:{dialogHeader:this.$t("headers.selectDirectory"),initialPath:this.libraryPath,listType:"directories"}}).onOk((e=>{if("undefined"!==typeof e.selectedPath&&null!==e.selectedPath){let t=(Math.random()+1).toString(36).substring(7),a="| "+(this.libraryPaths.length+1)+" | "+this.$t("components.settings.library.newLibrary")+" ("+t+")",l={library_config:{name:a,path:e.selectedPath}};(0,B.c)({method:"post",url:(0,j.S)("v2","settings/library/write"),data:l}).then((e=>{this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200}),this.fetchLibraryList()})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}})).onDismiss((()=>{}))},deleteLibrary:function(e){let t;for(let a=0;a<this.libraryPaths.length;a++)if(a===e){t=this.libraryPaths[a].id;break}1!==t?this.$q.dialog({title:this.$t("headers.confirm"),message:this.$t("components.settings.library.confirmRemove"),cancel:this.$t("navigation.cancel"),ok:this.$t("navigation.yes"),persistent:!0}).onOk((()=>{let e={id:t};(0,B.c)({method:"delete",url:(0,j.S)("v2","settings/library/remove"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200}),this.fetchLibraryList()})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))})):this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.cannotRemoveDefaultLibrary"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})},fetchSettings:function(){(0,B.c)({method:"get",url:(0,j.S)("v2","settings/read")}).then((e=>{this.libraryPath=e.data.settings.library_path,this.enableLibraryScanner=e.data.settings.enable_library_scanner,this.libraryScanSchedule=e.data.settings.schedule_full_scan_minutes,this.libraryScanFollowSymlinks=e.data.settings.follow_symlinks,this.concurrentFileTesters=e.data.settings.concurrent_file_testers,this.runLibraryScanOnStart=e.data.settings.run_full_scan_on_start,this.enableLibraryFileMonitor=e.data.settings.enable_inotify,this.clearPendingTasksOnStart=e.data.settings.clear_pending_tasks_on_restart,this.autoManageCompletedTasks=e.data.settings.auto_manage_completed_tasks,this.maxAgeOfCompletedTasks=e.data.settings.max_age_of_completed_tasks,this.alwaysKeepFailedTasks=e.data.settings.always_keep_failed_tasks})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e={settings:{library_path:this.libraryPath,enable_library_scanner:this.enableLibraryScanner,schedule_full_scan_minutes:this.libraryScanSchedule,follow_symlinks:this.libraryScanFollowSymlinks,concurrent_file_testers:this.concurrentFileTesters,run_full_scan_on_start:this.runLibraryScanOnStart,enable_inotify:this.enableLibraryFileMonitor,clear_pending_tasks_on_restart:this.clearPendingTasksOnStart,auto_manage_completed_tasks:this.autoManageCompletedTasks,max_age_of_completed_tasks:this.maxAgeOfCompletedTasks,always_keep_failed_tasks:this.alwaysKeepFailedTasks}};(0,B.c)({method:"post",url:(0,j.S)("v2","settings/write"),data:e}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},fetchLibraryList:function(){(0,B.c)({method:"get",url:(0,j.S)("v2","settings/libraries")}).then((e=>{let t=[];for(let a=0;a<e.data.libraries.length;a++){let l=e.data.libraries[a];t[t.length]={id:l.id,name:l.name,path:l.path,enableRemoteOnly:l.enable_remote_only,enableScanner:l.enable_scanner,enableInotify:l.enable_inotify,tags:l.tags,locked:l.locked}}this.libraryPaths=t})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchLibraryList"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},configureLibraryPath:function(e){let t=this.libraryPaths[e];this.$q.dialog({component:G.c,componentProps:{header:this.$t("headers.configureLibrary"),componentName:"LibraryConfigForm",componentProps:{libraryId:t.id}}}).onOk((e=>{})).onDismiss((()=>{this.fetchSettings(),this.fetchLibraryList()}))}},created(){this.fetchSettings(),this.fetchLibraryList()}};var X=a(8716),Z=a(7059),ee=a(1908),te=a(9692),ae=a(9588),le=a(4884),ne=a(1032),se=a(1252),ie=a(111),oe=a(2992),re=a(8120),ce=a(880),de=a(9140),ue=a(8600),me=a(3456),ye=a(4640),be=a(540),pe=a(1440),ge=a(5252),he=a.n(ge);const fe=(0,X.c)(J,[["render",E]]),ke=fe;he()(J,"components",{QPage:Z.c,QForm:ee.c,QSkeleton:te.cp,QList:ae.c,QItem:le.c,QItemSection:ne.c,QAvatar:se.c,QTooltip:ie.c,QItemLabel:oe.c,QIcon:re.c,QSeparator:ce.c,QBtn:de.c,QBar:ue.c,QSpace:me.c,QToggle:ye.c,QInput:be.c,QSlider:pe.c})}}]);