

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lammpskit.ecellmodel.analyze_clusters &mdash; LAMMPSKit Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=fc837d61"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="lammpskit.ecellmodel.track_filament_evolution" href="lammpskit.ecellmodel.track_filament_evolution.html" />
    <link rel="prev" title="lammpskit.ecellmodel.read_displacement_data" href="lammpskit.ecellmodel.read_displacement_data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            LAMMPSKit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api_reference.html#module-lammpskit">Package Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference.html#core-modules">Core Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api_reference.html#function-categories">Function Categories</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../api_reference.html#data-i-o-functions">Data I/O Functions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../api_reference.html#analysis-functions">Analysis Functions</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">lammpskit.ecellmodel.analyze_clusters</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammpskit.ecellmodel.track_filament_evolution.html">lammpskit.ecellmodel.track_filament_evolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammpskit.ecellmodel.plot_atomic_distribution.html">lammpskit.ecellmodel.plot_atomic_distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammpskit.ecellmodel.plot_atomic_charge_distribution.html">lammpskit.ecellmodel.plot_atomic_charge_distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammpskit.ecellmodel.plot_displacement_comparison.html">lammpskit.ecellmodel.plot_displacement_comparison</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference.html#plotting-functions">Plotting Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference.html#validation-functions">Validation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference.html#configuration-classes">Configuration Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_formats.html">Data Formats</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lammpskit.html">lammpskit package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lammpskit.config.html">lammpskit.config module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lammpskit.io.html">lammpskit.io package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lammpskit.plotting.html">lammpskit.plotting package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lammpskit.ecellmodel.html">lammpskit.ecellmodel package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LAMMPSKit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api_reference.html">API Reference</a></li>
      <li class="breadcrumb-item active">lammpskit.ecellmodel.analyze_clusters</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/simantalahkar/lammpskit/blob/main/docs/source/generated/lammpskit.ecellmodel.analyze_clusters.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lammpskit-ecellmodel-analyze-clusters">
<h1>lammpskit.ecellmodel.analyze_clusters<a class="headerlink" href="#lammpskit-ecellmodel-analyze-clusters" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="lammpskit.ecellmodel.analyze_clusters">
<span class="sig-prename descclassname"><span class="pre">lammpskit.ecellmodel.</span></span><span class="sig-name descname"><span class="pre">analyze_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_filament_lower_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_filament_upper_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">21</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/lammpskit/ecellmodel/filament_layer_analysis.html#analyze_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lammpskit.ecellmodel.analyze_clusters" title="Link to this definition"></a></dt>
<dd><p>Perform comprehensive OVITO-based cluster analysis for metallic filament characterization.</p>
<p>Conducts advanced structural analysis of HfTaO electrochemical memory devices using OVITO’s
cluster detection algorithms to identify, characterize, and quantify conductive filament
formation. Provides detailed connectivity analysis, size distribution characterization,
and radial distribution function (RDF) analysis essential for understanding resistive
switching mechanisms and device reliability in electrochemical memory applications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to LAMMPS trajectory file (.lammpstrj, .dump) containing atomic coordinates
and species information. File must be compatible with OVITO import functionality
and contain sufficient atomic data for cluster detection.
Example: “filament_formation.lammpstrj”, “switching_cycle.dump”</p></li>
<li><p><strong>z_filament_lower_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Lower z-coordinate boundary (Angstroms) defining the bottom electrode interface
for filament connectivity analysis. Represents the lower threshold for complete
electrode-to-electrode conductive bridge formation. Default: 5.0 Å.
Typical range: 3-8 Å depending on device geometry.</p></li>
<li><p><strong>z_filament_upper_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Upper z-coordinate boundary (Angstroms) defining the top electrode interface
for filament connectivity analysis. Represents the upper threshold for complete
conductive bridge formation. Default: 23.0 Å.
Typical range: 20-30 Å depending on oxide thickness.</p></li>
<li><p><strong>thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Characteristic filament thickness parameter (Angstroms) used for structural
analysis and RDF calculations. Influences cluster size classification and
connectivity determination. Default: 21.0 Å.
Optimization range: 15-30 Å based on device dimensions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>cluster_analysis_results</strong> – Comprehensive cluster analysis data containing connectivity metrics, size
distributions, and structural characterization:</p>
<p><strong>Temporal Information:</strong>
- <strong>timestep</strong> (int): Simulation timestep from trajectory file header</p>
<p><strong>Connectivity Analysis:</strong>
- <strong>connection</strong> (int): Binary connectivity state (1=connected, 0=disconnected)
- <strong>separation</strong> (float): Minimum inter-cluster distance (Å) when disconnected
- <strong>gap</strong> (float): Z-direction gap between cluster boundaries (Å)</p>
<p><strong>Lower Filament Characterization:</strong>
- <strong>fil_size_down</strong> (int): Number of atoms in bottom filament cluster
- <strong>fil_height</strong> (float): Maximum z-coordinate of bottom cluster (Å)
- <strong>rdf_down</strong> (np.ndarray): Radial distribution function data (shape: [N_bins, 2])</p>
<blockquote>
<div><ul class="simple">
<li><p>Column 0: Radial distance (Å)</p></li>
<li><p>Column 1: RDF intensity</p></li>
</ul>
</div></blockquote>
<p><strong>Upper Filament Characterization:</strong>
- <strong>fil_size_up</strong> (int): Number of atoms in top filament cluster
- <strong>fil_depth</strong> (float): Minimum z-coordinate of top cluster (Å)
- <strong>rdf_up</strong> (np.ndarray): Upper cluster RDF data (shape: [N_bins, 2])</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, np.ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, np.ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the specified filepath does not exist or is not accessible to OVITO.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If no metallic clusters are detected in the trajectory file or if file format
    is incompatible with OVITO cluster analysis pipelines.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If input parameters have invalid types or values outside acceptable ranges.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>OVITO Cluster Analysis Pipeline:</p>
<p><strong>Multi-Pipeline Architecture:</strong>
The function employs four specialized OVITO pipelines for comprehensive analysis:</p>
<ol class="arabic simple">
<li><p><strong>Primary Cluster Pipeline</strong>: Largest cluster identification and analysis</p></li>
<li><p><strong>Secondary Cluster Pipeline</strong>: Second-largest cluster characterization</p></li>
<li><p><strong>Lower Filament Pipeline</strong>: Bottom electrode region analysis</p></li>
<li><p><strong>Upper Filament Pipeline</strong>: Top electrode region analysis</p></li>
</ol>
<p><strong>Coordination Analysis Framework:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cutoff</span> <span class="n">Distance</span><span class="p">:</span> <span class="mf">2.7</span> <span class="n">Å</span> <span class="p">(</span><span class="n">first</span> <span class="n">neighbor</span> <span class="n">shell</span> <span class="k">for</span> <span class="n">metallic</span> <span class="n">bonds</span><span class="p">)</span>
<span class="n">Coordination</span> <span class="n">Threshold</span><span class="p">:</span> <span class="o">&lt;</span><span class="mi">6</span> <span class="p">(</span><span class="n">under</span><span class="o">-</span><span class="n">coordinated</span> <span class="n">atoms</span> <span class="k">for</span> <span class="n">filament</span> <span class="n">detection</span><span class="p">)</span>
<span class="n">Clustering</span> <span class="n">Cutoff</span><span class="p">:</span> <span class="mf">3.9</span> <span class="n">Å</span> <span class="p">(</span><span class="n">metallic</span> <span class="n">cluster</span> <span class="n">connectivity</span> <span class="n">distance</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Species Selection Criteria:</strong>
The analysis targets metallic and under-coordinated species:
- <strong>Type 2</strong>: Hafnium atoms (matrix metal component)
- <strong>Type 4, 8</strong>: Tantalum atoms (matrix metal component)
- <strong>Type 8</strong>: Additional Ta metal species (device-specific)
- <strong>Type 1, 3, 7</strong>: Oxygen atoms (matrix component)
- <strong>Types 5, 6, 9, 10</strong>: Electrode species</p>
<p><strong>Connectivity Determination Algorithm:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">z_min</span> <span class="o">&lt;</span> <span class="n">z_lower_limit</span> <span class="ow">and</span> <span class="n">z_max</span> <span class="o">&gt;</span> <span class="n">z_upper_limit</span><span class="p">:</span>
    <span class="n">connection_state</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Continuous bridge formed</span>
    <span class="n">separation</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">gap</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">connection_state</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Discontinuous filament</span>
    <span class="n">separation</span> <span class="o">=</span> <span class="n">min_distance_between_clusters</span> <span class="o">-</span> <span class="n">cutoff_distance</span>
    <span class="n">gap</span> <span class="o">=</span> <span class="n">z_direction_gap_between_clusters</span>
</pre></div>
</div>
<p><strong>Radial Distribution Function (RDF) Analysis:</strong>
Characterizes local atomic structure and bonding environment</p>
<p><strong>Performance Characteristics:</strong></p>
<ul class="simple">
<li><p><strong>Processing Time</strong>: 5-30s per trajectory frame depending on atom count</p></li>
<li><p><strong>Memory Usage</strong>: O(N_atoms × N_neighbors) for coordination analysis</p></li>
<li><p><strong>Accuracy</strong>: Sub-angstrom precision for cluster boundary detection</p></li>
<li><p><strong>Scalability</strong>: Efficient for trajectories up to ~10⁶ atoms per frame</p></li>
</ul>
<p><strong>Integration with LAMMPSKit Ecosystem:</strong></p>
<ul class="simple">
<li><p><strong>File Compatibility</strong>: Direct integration with LAMMPS trajectory formats</p></li>
<li><p><strong>Parameter Validation</strong>: Uses config module validation functions</p></li>
<li><p><strong>Pipeline Integration</strong>: Compatible with track_filament_evolution() workflows</p></li>
<li><p><strong>Data Export</strong>: Results integrate with time series plotting functions</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Basic filament connectivity analysis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">lammpskit.ecellmodel.filament_layer_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">analyze_clusters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze single trajectory frame for filament formation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajectory_file</span> <span class="o">=</span> <span class="s2">&quot;switching_process.lammpstrj&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_results</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">trajectory_file</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">z_filament_lower_limit</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">z_filament_upper_limit</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extract connectivity information</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timestep</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">size_down</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">rdf_down</span><span class="p">,</span> <span class="n">size_up</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">rdf_up</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span> <span class="n">gap</span> <span class="o">=</span> <span class="n">cluster_results</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Timestep: </span><span class="si">{</span><span class="n">timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filament Connected: </span><span class="si">{</span><span class="s1">&#39;Yes&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;No&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">connection</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Complete bridge formed with </span><span class="si">{</span><span class="n">size_down</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size_up</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gap: </span><span class="si">{</span><span class="n">gap</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å, Separation: </span><span class="si">{</span><span class="n">separation</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Device geometry optimization:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Parametric study of device geometry effects on connectivity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajectory_file</span> <span class="o">=</span> <span class="s2">&quot;device_optimization.lammpstrj&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test different electrode separations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometries</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thin_oxide&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;medium_oxide&quot;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thick_oxide&quot;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connectivity_results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">geometries</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">results</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">trajectory_file</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">z_filament_lower_limit</span><span class="o">=</span><span class="n">geom</span><span class="p">[</span><span class="s2">&quot;lower&quot;</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">z_filament_upper_limit</span><span class="o">=</span><span class="n">geom</span><span class="p">[</span><span class="s2">&quot;upper&quot;</span><span class="p">])</span>
<span class="gp">... </span>        <span class="n">connectivity_results</span><span class="p">[</span><span class="n">geom</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;connected&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>            <span class="s2">&quot;total_atoms&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">results</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>            <span class="s2">&quot;gap&quot;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mf">0.0</span>
<span class="gp">... </span>        <span class="p">}</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">geom</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: Connected=</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, Atoms=</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error analyzing </span><span class="si">{</span><span class="n">geom</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geometry optimization completed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Detailed structural characterization:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Comprehensive filament structure analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajectory_file</span> <span class="o">=</span> <span class="s2">&quot;filament_structure.lammpstrj&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_data</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">trajectory_file</span><span class="p">,</span> <span class="n">z_filament_lower_limit</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">z_filament_upper_limit</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">timestep</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">size_down</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">rdf_down</span><span class="p">,</span> <span class="n">size_up</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">rdf_up</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span> <span class="n">gap</span> <span class="o">=</span> <span class="n">cluster_data</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze RDF characteristics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf_distances</span> <span class="o">=</span> <span class="n">rdf_down</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Radial distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdf_intensities</span> <span class="o">=</span> <span class="n">rdf_down</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># RDF values</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find first coordination shell peak</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_peak_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">rdf_intensities</span><span class="p">[:</span><span class="mi">50</span><span class="p">])</span>  <span class="c1"># Search first 5 Å</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_peak_position</span> <span class="o">=</span> <span class="n">rdf_distances</span><span class="p">[</span><span class="n">first_peak_idx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_peak_intensity</span> <span class="o">=</span> <span class="n">rdf_intensities</span><span class="p">[</span><span class="n">first_peak_idx</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Structural Analysis Results:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Lower cluster: </span><span class="si">{</span><span class="n">size_down</span><span class="si">}</span><span class="s2"> atoms, height: </span><span class="si">{</span><span class="n">height</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Upper cluster: </span><span class="si">{</span><span class="n">size_up</span><span class="si">}</span><span class="s2"> atoms, depth: </span><span class="si">{</span><span class="n">depth</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  First RDF peak: </span><span class="si">{</span><span class="n">first_peak_position</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å (intensity: </span><span class="si">{</span><span class="n">first_peak_intensity</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">connection</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">total_filament_size</span> <span class="o">=</span> <span class="n">size_down</span> <span class="o">+</span> <span class="n">size_up</span>
<span class="gp">... </span>    <span class="n">filament_span</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">depth</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Complete filament: </span><span class="si">{</span><span class="n">total_filament_size</span><span class="si">}</span><span class="s2"> atoms spanning </span><span class="si">{</span><span class="n">filament_span</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Disconnected filament with </span><span class="si">{</span><span class="n">gap</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å gap&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Time series connectivity analysis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Process multiple trajectory frames for evolution tracking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajectory_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;time_series_*.lammpstrj&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connectivity_evolution</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filament_size_evolution</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gap_evolution</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">traj_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trajectory_files</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">results</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">traj_file</span><span class="p">,</span> <span class="n">z_filament_lower_limit</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">z_filament_upper_limit</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">timestep</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">size_down</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">rdf_down</span><span class="p">,</span> <span class="n">size_up</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">rdf_up</span><span class="p">,</span> <span class="n">separation</span><span class="p">,</span> <span class="n">gap</span> <span class="o">=</span> <span class="n">results</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="n">connectivity_evolution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">filament_size_evolution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">size_down</span> <span class="o">+</span> <span class="n">size_up</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">gap_evolution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gap</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">connection</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Progress reporting</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processed frame </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectory_files</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">connectivity_evolution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">filament_size_evolution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">gap_evolution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze connectivity statistics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connectivity_fraction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">connectivity_evolution</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_connected_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">size</span> <span class="k">for</span> <span class="n">size</span><span class="p">,</span> <span class="n">conn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">filament_size_evolution</span><span class="p">,</span> <span class="n">connectivity_evolution</span><span class="p">)</span> <span class="k">if</span> <span class="n">conn</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_gap_when_disconnected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">gap</span> <span class="k">for</span> <span class="n">gap</span><span class="p">,</span> <span class="n">conn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gap_evolution</span><span class="p">,</span> <span class="n">connectivity_evolution</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">conn</span> <span class="ow">and</span> <span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time Series Analysis Results:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Connectivity fraction: </span><span class="si">{</span><span class="n">connectivity_fraction</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Average connected filament size: </span><span class="si">{</span><span class="n">avg_connected_size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Average gap when disconnected: </span><span class="si">{</span><span class="n">avg_gap_when_disconnected</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Advanced RDF analysis and comparison:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare RDF characteristics between different states</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connected_file</span> <span class="o">=</span> <span class="s2">&quot;connected_state.lammpstrj&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disconnected_file</span> <span class="o">=</span> <span class="s2">&quot;disconnected_state.lammpstrj&quot;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze connected state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn_results</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">connected_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn_rdf_down</span> <span class="o">=</span> <span class="n">conn_results</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Analyze disconnected state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disconn_results</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">disconnected_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disconn_rdf_down</span> <span class="o">=</span> <span class="n">disconn_results</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare structural order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn_first_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">conn_rdf_down</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disconn_first_peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">disconn_rdf_down</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RDF Comparison:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Connected state first peak intensity: </span><span class="si">{</span><span class="n">conn_first_peak</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Disconnected state first peak intensity: </span><span class="si">{</span><span class="n">disconn_first_peak</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Structural order change: </span><span class="si">{</span><span class="p">(</span><span class="n">conn_first_peak</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">disconn_first_peak</span><span class="p">)</span><span class="o">/</span><span class="n">disconn_first_peak</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Error handling and validation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Robust cluster analysis with comprehensive error handling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trajectory_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;test1.lammpstrj&quot;</span><span class="p">,</span> <span class="s2">&quot;test2.lammpstrj&quot;</span><span class="p">,</span> <span class="s2">&quot;test3.lammpstrj&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">successful_analyses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">failed_analyses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">traj_file</span> <span class="ow">in</span> <span class="n">trajectory_files</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="c1"># Validate file exists before processing</span>
<span class="gp">... </span>        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">traj_file</span><span class="p">):</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">failed_analyses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">traj_file</span><span class="p">,</span> <span class="s2">&quot;FileNotFoundError&quot;</span><span class="p">))</span>
<span class="gp">... </span>            <span class="k">continue</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="c1"># Perform cluster analysis</span>
<span class="gp">... </span>        <span class="n">results</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">traj_file</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">z_filament_lower_limit</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">z_filament_upper_limit</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="c1"># Validate results</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">successful_analyses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">traj_file</span><span class="p">,</span> <span class="n">results</span><span class="p">))</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully analyzed: </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">failed_analyses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">traj_file</span><span class="p">,</span> <span class="s2">&quot;Invalid results format&quot;</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster detection failed for </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">failed_analyses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">traj_file</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ValueError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected error for </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">failed_analyses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">traj_file</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Exception: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analysis Summary:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Successful: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">successful_analyses</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Failed: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">failed_analyses</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Integration with filament evolution tracking:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use with track_filament_evolution for comprehensive time series analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">lammpskit.ecellmodel.filament_layer_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">track_filament_evolution</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Single-frame cluster analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">single_frame_file</span> <span class="o">=</span> <span class="s2">&quot;snapshot.lammpstrj&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cluster_analysis</span> <span class="o">=</span> <span class="n">analyze_clusters</span><span class="p">(</span><span class="n">single_frame_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Single Frame Analysis:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Connectivity: </span><span class="si">{</span><span class="n">cluster_analysis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total atoms: </span><span class="si">{</span><span class="n">cluster_analysis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cluster_analysis</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multi-frame evolution tracking</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_series_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;evolution.lammpstrj&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evolution_plots</span> <span class="o">=</span> <span class="n">track_filament_evolution</span><span class="p">(</span><span class="n">time_series_files</span><span class="p">,</span> <span class="s2">&quot;evolution_study&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                         <span class="n">time_step</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span> <span class="n">dump_interval_steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evolution tracking completed with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">evolution_plots</span><span class="p">)</span><span class="si">}</span><span class="s2"> plots&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lammpskit.ecellmodel.read_displacement_data.html" class="btn btn-neutral float-left" title="lammpskit.ecellmodel.read_displacement_data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lammpskit.ecellmodel.track_filament_evolution.html" class="btn btn-neutral float-right" title="lammpskit.ecellmodel.track_filament_evolution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Simanta Lahkar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>