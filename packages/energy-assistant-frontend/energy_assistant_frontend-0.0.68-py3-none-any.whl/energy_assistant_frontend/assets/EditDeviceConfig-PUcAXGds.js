import{l as q,p as G,r as u,m as s,B as H,P as J,E as U,G as g,w as _,K as S,t as n,M as m,J as t,$ as o,q as f,I as C,H as E,ay as L,F as M,R as T}from"./index-Df3ZCvww.js";import{b as N,a as O,V as W}from"./VCard-kZtxH9el.js";import{a as z,c as A}from"./transition-DPDEURjo.js";import{c as Q,d as X}from"./VInput-CbPQ8zqR.js";import{f as Y}from"./forwardRefs-CBpwjxj4.js";import{V as p}from"./VTextField-D8ZhOQYb.js";import{V as K}from"./VDivider-JLUjQdAU.js";import{a as $}from"./VBtn-BWZRan35.js";import{V as Z}from"./VTable-B94udUXa.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VImg-BO89cVPr.js";import"./index-Dk_SXLH_.js";import"./VProgressCircular-DCcO40sI.js";import"./resizeObserver-DdmAia-I.js";const le=G({...A(),...X()},"VForm"),ae=q()({name:"VForm",props:le(),emits:{"update:modelValue":c=>!0,submit:c=>!0},setup(c,D){let{slots:a,emit:h}=D;const v=Q(c),y=u();function w(r){r.preventDefault(),v.reset()}function k(r){const d=r,i=v.validate();d.then=i.then.bind(i),d.catch=i.catch.bind(i),d.finally=i.finally.bind(i),h("submit",d),d.defaultPrevented||i.then(x=>{var b;let{valid:F}=x;F&&((b=y.value)==null||b.submit())}),d.preventDefault()}return z(()=>{var r;return s("form",{ref:y,class:["v-form",c.class],style:c.style,novalidate:!0,onReset:w,onSubmit:k},[(r=a.default)==null?void 0:r.call(a,v)])}),Y(v,y)}}),te={key:0},ne={class:"config-subtitle"},oe={key:1},ue={class:"config-subtitle"},se={class:"border px-6 py-4"},ie={class:"border px-6 py-4"},re=H({__name:"EditDeviceConfig",props:{deviceId:{}},setup(c){const D=L(),a=u({}),h=u({}),v=u(""),y=u(""),w=u(""),k=u(""),r=u(0),d=u(0),i=u(0),x=u(0),F=u(0),b=u(0),I=c;J(()=>I.deviceId,async V=>{if(V){console.log("Edit Device: "+V);const e=await T.getDeviceConfig(V);a.value=e,v.value=e.name,y.value=e.power,w.value=e.energy,k.value=e.output,r.value=parseFloat(e.nominal_power)*1,d.value=parseFloat(e.nominal_duration)/60,i.value=parseFloat(e.switch_on_delay)/60,x.value=parseFloat(e.switch_off_delay)/60,F.value=parseFloat(e.min_on_duration)/60,b.value=parseFloat(e.max_on_per_day)/60;const l=new Set(["name","power","energy","output","nominal_power","nominal_duration","switch_on_delay","switch_off_delay","min_on_duration","max_on_per_day"]),R=Object.keys(e).filter(B=>!l.has(B)),P={};R.forEach(B=>{P[B]=e[B]}),h.value=P}},{immediate:!0});const j=async function(){const V={name:v.value,energy:w.value,power:y.value,output:k.value,nominal_power:+r.value,nominal_duration:d.value*60,switch_on_delay:i.value*60,switch_off_delay:x.value*60,min_on_duration:F.value*60,max_on_per_day:b.value*60};console.log("Saving device config: ",V),await T.saveDeviceConfig(I.deviceId,V),D.push({name:"devicessettings"})};return(V,e)=>(n(),U(S,null,[s(N,{class:"elevation-2 ma-4 pa-4 rounded-md"},{default:_(()=>[s(O,null,{default:_(()=>[s(ae,null,{default:_(()=>[s(p,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=l=>v.value=l),label:t(o)("settings.name"),type:"input"},null,8,["modelValue","label"]),"power"in a.value||"energy"in a.value||"output"in a.value?(n(),U("div",te,[s(K),g("p",ne,C(t(o)("settings.home_assistant_entity_ids")),1),"power"in a.value?(n(),f(p,{key:0,modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=l=>y.value=l),label:t(o)("settings.power"),type:"text"},null,8,["modelValue","label"])):m("",!0),"energy"in a.value?(n(),f(p,{key:1,modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=l=>w.value=l),label:t(o)("settings.energy"),type:"text"},null,8,["modelValue","label"])):m("",!0),"output"in a.value?(n(),f(p,{key:2,modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=l=>k.value=l),label:t(o)("settings.output"),type:"text"},null,8,["modelValue","label"])):m("",!0)])):m("",!0),"nominal_power"in a.value||"nominal_duration"in a.value||"switch_on_delay"in a.value||"switch_off_delay"in a.value||"min_on_duration"in a.value||"max_on_per_day"in a.value?(n(),U("div",oe,[s(K),g("p",ue,C(t(o)("settings.configuration")),1),"nominal_power"in a.value?(n(),f(p,{key:0,modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value=l),label:t(o)("settings.nominal_power")+" [W]",type:"number"},null,8,["modelValue","label"])):m("",!0),"nominal_duration"in a.value?(n(),f(p,{key:1,modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=l=>d.value=l),label:t(o)("settings.nominal_duration")+" [min]",type:"number"},null,8,["modelValue","label"])):m("",!0),"switch_on_delay"in a.value?(n(),f(p,{key:2,modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=l=>i.value=l),label:t(o)("settings.switch_on_delay")+" [min]",type:"number"},null,8,["modelValue","label"])):m("",!0),"switch_off_delay"in a.value?(n(),f(p,{key:3,modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=l=>x.value=l),label:t(o)("settings.switch_off_delay")+" [min]",type:"number"},null,8,["modelValue","label"])):m("",!0),"min_on_duration"in a.value?(n(),f(p,{key:4,modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=l=>F.value=l),label:t(o)("settings.min_on_duration")+" [min]",type:"number"},null,8,["modelValue","label"])):m("",!0),"max_on_per_day"in a.value?(n(),f(p,{key:5,modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=l=>b.value=l),label:t(o)("settings.max_on_per_day")+" [min]",type:"number"},null,8,["modelValue","label"])):m("",!0)])):m("",!0),s($,{block:"",color:"primary",onClick:j},{default:_(()=>[E(C(t(o)("settings.save")),1)]),_:1})]),_:1}),e[11]||(e[11]=g("br",null,null,-1)),s($,{block:"",onClick:e[10]||(e[10]=l=>t(D).back())},{default:_(()=>[E(C(t(o)("close")),1)]),_:1})]),_:1})]),_:1}),e[13]||(e[13]=g("br",null,null,-1)),s(N,{class:"pa-4 ma-4 elevation-2 rounded-md"},{default:_(()=>[s(W,null,{default:_(()=>e[12]||(e[12]=[E("Values which can only be edit in the energy_assistant.yaml file")])),_:1}),s(O,null,{default:_(()=>[s(Z,{class:"ma-4 rounded-md border"},{default:_(()=>[g("tbody",null,[(n(!0),U(S,null,M(h.value,(l,R)=>(n(),U("tr",{key:R,class:"border text-left"},[g("td",se,C(R),1),g("td",ie,C(l),1)]))),128))])]),_:1})]),_:1})]),_:1})],64))}}),Fe=ee(re,[["__scopeId","data-v-5e4df489"]]);export{Fe as default};
