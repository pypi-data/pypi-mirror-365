import{B as W,C as ye,r as _e,P as Z,o as be,E as w,M as H,t as _,m as h,J as p,Q as ge,R as J,q as K,w as $,G as c,S as xe,I as m,K as ae,F as oe,H as I,$ as M,v as we,c as U,U as ee}from"./index-Cp3-A7ao.js";import{_ as ke,P as Me}from"./PowerFlowCard-jNGeIg9r.js";import{V as Ce}from"./VSelect-CF9-iJpd.js";import{f as P,a as Pe}from"./utils-D98hIld_.js";import{V as ie,a as Y,b as Q}from"./VCard-D5wKeDng.js";import{m as V,i as E,a as $e,e as Se,c as ne,r as v,v as Ie,t as Te,d as Ae,b as Be,A as se,P as Ee,B as De,C as Re,p as Ve,f as We,g as je,D as Ne}from"./index-CoXvh_-d.js";import{n as N}from"./transition-BAtvBeuS.js";import{V as ze,a as Oe}from"./VToolbar-jYZfQvPG.js";import{V as Fe}from"./VProgressCircular-DvjORuMu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VTextField-D20FHtqI.js";import"./index-DkrqsE6v.js";import"./VInput-BVhPJyoq.js";import"./forwardRefs-o1fhiqtU.js";import"./VImg-tOz2PgiP.js";import"./VOverlay-BvbqXTj9.js";import"./scopeId-BFshC2jm.js";import"./VSlideGroup-BrMBqUtb.js";import"./resizeObserver-BoHHG32A.js";import"./VSelectionControl-Cd3GaTT-.js";const Le={key:0,class:"bg-subgroup mt-2 w-full items-center rounded-md px-2 pt-1"},He=W({__name:"PowerModeSelection",props:{deviceId:{},supportedPowerModes:{},powerMode:{}},setup(e){const{t:a}=ye();function t(i){return{title:a("power_mode."+i),mode:i}}let r=_e("device_controlled");const o=e;return Z(r,()=>{r.value!=""&&J.setPowerMode(o.deviceId,r.value)}),Z(()=>o.powerMode,(i,n)=>{console.log("watch power mode: "+r.value),r.value=o.powerMode}),be(()=>{r.value=o.powerMode}),(i,n)=>i.supportedPowerModes&&i.supportedPowerModes.length>1&&i.powerMode?(_(),w("div",Le,[h(Ce,{modelValue:p(r),"onUpdate:modelValue":n[0]||(n[0]=s=>ge(r)?r.value=s:r=s),class:"my-4",items:i.supportedPowerModes.map(s=>t(s)),"item-title":"title","item-value":"mode","single-line":""},null,8,["modelValue","items"])])):H("",!0)}}),Ue={class:""},Ge={class:"grid w-full grid-cols-1"},Xe={key:0,class:"pa-2 bg-subgroup mt-2 items-center rounded-md"},qe={class:"float-right"},Je={key:1,class:"pa-2 bg-error mt-2 rounded-md text-center"},Ke={class:"pa-2 bg-subgroup mt-2 items-center rounded-md"},Ye={key:0,class:"text-left"},Qe={class:"float-right"},Ze=W({__name:"DeviceCard",props:{device:{},available:{type:Boolean},power:{},today:{},attributes:{}},setup(e){function a(t,r){switch(t){case"session_time":return Pe(r);case"session_energy":case"session_solar_energy":return P(parseFloat(r),"kWh")}return r}return(t,r)=>(_(),K(Q,{class:"pa-4 elevation-2 ma-4 w-80 rounded-md sm:w-96"},{default:$(()=>[h(ie,null,{default:$(()=>[c("span",{class:xe(["mdi pr-2",t.device.icon])},null,2),c("span",Ue,m(t.device.name),1)]),_:1}),h(Y,null,{default:$(()=>[c("div",Ge,[t.available&&t.attributes&&Object.entries(t.attributes).length>0?(_(),w("div",Xe,[(_(!0),w(ae,null,oe(Object.entries(t.attributes),(o,i)=>(_(),w("div",{key:i,class:"text-left"},[I(m(p(M)("device_attribute."+o[0]))+" ",1),c("span",qe,m(a(o[0],o[1])),1)]))),128))])):H("",!0),t.available?H("",!0):(_(),w("div",Je,m(p(M)("unavailable")),1)),c("div",Ke,[t.available?(_(),w("div",Ye,[I(m(p(M)("consumption"))+" ",1),c("span",Qe,m(p(P)(t.power,"W")),1)])):H("",!0),h(ke,{"self-sufficiency":t.today.self_sufficiency,"consumed-energy":t.today.consumed_energy,"consumed-solar-energy":t.today.consumed_solar_energy},null,8,["self-sufficiency","consumed-energy","consumed-solar-energy"])])]),h(He,{"device-id":t.device.id,"supported-power-modes":t.device.supported_power_modes,"power-mode":t.device.power_mode},null,8,["device-id","supported-power-modes","power-mode"])]),_:1})]),_:1}))}});/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var te=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),D={toTextLines:function(e){var a=[],t;for(e=[].concat(e);e.length;)t=e.pop(),typeof t=="string"?a.unshift.apply(a,t.split(`
`)):Array.isArray(t)?e.push.apply(e,t):E(e)||a.unshift(""+t);return a},textSize:function(e,a,t){var r=[].concat(a),o=r.length,i=e.font,n=0,s;for(e.font=t.string,s=0;s<o;++s)n=Math.max(e.measureText(r[s]).width,n);return e.font=i,{height:o*t.lineHeight,width:n}},bound:function(e,a,t){return Math.max(e,Math.min(a,t))},arrayDiff:function(e,a){var t=e.slice(),r=[],o,i,n,s;for(o=0,n=a.length;o<n;++o)s=a[o],i=t.indexOf(s),i===-1?r.push([s,1]):t.splice(i,1);for(o=0,n=t.length;o<n;++o)r.push([t[o],-1]);return r},rasterize:function(e){return Math.round(e*te)/te}};function X(e,a){var t=a.x,r=a.y;if(t===null)return{x:0,y:-1};if(r===null)return{x:1,y:0};var o=e.x-t,i=e.y-r,n=Math.sqrt(o*o+i*i);return{x:n?o/n:0,y:n?i/n:-1}}function et(e,a,t,r,o){switch(o){case"center":t=r=0;break;case"bottom":t=0,r=1;break;case"right":t=1,r=0;break;case"left":t=-1,r=0;break;case"top":t=0,r=-1;break;case"start":t=-t,r=-r;break;case"end":break;default:o*=Math.PI/180,t=Math.cos(o),r=Math.sin(o);break}return{x:e,y:a,vx:t,vy:r}}var tt=0,le=1,de=2,ue=4,fe=8;function z(e,a,t){var r=tt;return e<t.left?r|=le:e>t.right&&(r|=de),a<t.top?r|=fe:a>t.bottom&&(r|=ue),r}function rt(e,a){for(var t=e.x0,r=e.y0,o=e.x1,i=e.y1,n=z(t,r,a),s=z(o,i,a),d,l,u;!(!(n|s)||n&s);)d=n||s,d&fe?(l=t+(o-t)*(a.top-r)/(i-r),u=a.top):d&ue?(l=t+(o-t)*(a.bottom-r)/(i-r),u=a.bottom):d&de?(u=r+(i-r)*(a.right-t)/(o-t),l=a.right):d&le&&(u=r+(i-r)*(a.left-t)/(o-t),l=a.left),d===n?(t=l,r=u,n=z(t,r,a)):(o=l,i=u,s=z(o,i,a));return{x0:t,x1:o,y0:r,y1:i}}function O(e,a){var t=a.anchor,r=e,o,i;return a.clamp&&(r=rt(r,a.area)),t==="start"?(o=r.x0,i=r.y0):t==="end"?(o=r.x1,i=r.y1):(o=(r.x0+r.x1)/2,i=(r.y0+r.y1)/2),et(o,i,e.vx,e.vy,a.align)}var F={arc:function(e,a){var t=(e.startAngle+e.endAngle)/2,r=Math.cos(t),o=Math.sin(t),i=e.innerRadius,n=e.outerRadius;return O({x0:e.x+r*i,y0:e.y+o*i,x1:e.x+r*n,y1:e.y+o*n,vx:r,vy:o},a)},point:function(e,a){var t=X(e,a.origin),r=t.x*e.options.radius,o=t.y*e.options.radius;return O({x0:e.x-r,y0:e.y-o,x1:e.x+r,y1:e.y+o,vx:t.x,vy:t.y},a)},bar:function(e,a){var t=X(e,a.origin),r=e.x,o=e.y,i=0,n=0;return e.horizontal?(r=Math.min(e.x,e.base),i=Math.abs(e.base-e.x)):(o=Math.min(e.y,e.base),n=Math.abs(e.base-e.y)),O({x0:r,y0:o+n,x1:r+i,y1:o,vx:t.x,vy:t.y},a)},fallback:function(e,a){var t=X(e,a.origin);return O({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:t.x,vy:t.y},a)}},C=D.rasterize;function at(e){var a=e.borderWidth||0,t=e.padding,r=e.size.height,o=e.size.width,i=-o/2,n=-r/2;return{frame:{x:i-t.left-a,y:n-t.top-a,w:o+t.width+a*2,h:r+t.height+a*2},text:{x:i,y:n,w:o,h:r}}}function ot(e,a){var t=a.chart.getDatasetMeta(a.datasetIndex).vScale;if(!t)return null;if(t.xCenter!==void 0&&t.yCenter!==void 0)return{x:t.xCenter,y:t.yCenter};var r=t.getBasePixel();return e.horizontal?{x:r,y:null}:{x:null,y:r}}function it(e){return e instanceof se?F.arc:e instanceof Ee?F.point:e instanceof De?F.bar:F.fallback}function nt(e,a,t,r,o,i){var n=Math.PI/2;if(i){var s=Math.min(i,o/2,r/2),d=a+s,l=t+s,u=a+r-s,f=t+o-s;e.moveTo(a,l),d<u&&l<f?(e.arc(d,l,s,-Math.PI,-n),e.arc(u,l,s,-n,0),e.arc(u,f,s,0,n),e.arc(d,f,s,n,Math.PI)):d<u?(e.moveTo(d,t),e.arc(u,l,s,-n,n),e.arc(d,l,s,n,Math.PI+n)):l<f?(e.arc(d,l,s,-Math.PI,0),e.arc(d,f,s,0,Math.PI)):e.arc(d,l,s,-Math.PI,Math.PI),e.closePath(),e.moveTo(a,t)}else e.rect(a,t,r,o)}function st(e,a,t){var r=t.backgroundColor,o=t.borderColor,i=t.borderWidth;!r&&(!o||!i)||(e.beginPath(),nt(e,C(a.x)+i/2,C(a.y)+i/2,C(a.w)-i,C(a.h)-i,t.borderRadius),e.closePath(),r&&(e.fillStyle=r,e.fill()),o&&i&&(e.strokeStyle=o,e.lineWidth=i,e.lineJoin="miter",e.stroke()))}function lt(e,a,t){var r=t.lineHeight,o=e.w,i=e.x,n=e.y+r/2;return a==="center"?i+=o/2:(a==="end"||a==="right")&&(i+=o),{h:r,w:o,x:i,y:n}}function dt(e,a,t){var r=e.shadowBlur,o=t.stroked,i=C(t.x),n=C(t.y),s=C(t.w);o&&e.strokeText(a,i,n,s),t.filled&&(r&&o&&(e.shadowBlur=0),e.fillText(a,i,n,s),r&&o&&(e.shadowBlur=r))}function ut(e,a,t,r){var o=r.textAlign,i=r.color,n=!!i,s=r.font,d=a.length,l=r.textStrokeColor,u=r.textStrokeWidth,f=l&&u,b;if(!(!d||!n&&!f))for(t=lt(t,o,s),e.font=s.string,e.textAlign=o,e.textBaseline="middle",e.shadowBlur=r.textShadowBlur,e.shadowColor=r.textShadowColor,n&&(e.fillStyle=i),f&&(e.lineJoin="round",e.lineWidth=u,e.strokeStyle=l),b=0,d=a.length;b<d;++b)dt(e,a[b],{stroked:f,filled:n,w:t.w,x:t.x,y:t.y+t.h*b})}var ce=function(e,a,t,r){var o=this;o._config=e,o._index=r,o._model=null,o._rects=null,o._ctx=a,o._el=t};V(ce.prototype,{_modelize:function(e,a,t,r){var o=this,i=o._index,n=Te(v([t.font,{}],r,i)),s=v([t.color,Ae.color],r,i);return{align:v([t.align,"center"],r,i),anchor:v([t.anchor,"center"],r,i),area:r.chart.chartArea,backgroundColor:v([t.backgroundColor,null],r,i),borderColor:v([t.borderColor,null],r,i),borderRadius:v([t.borderRadius,0],r,i),borderWidth:v([t.borderWidth,0],r,i),clamp:v([t.clamp,!1],r,i),clip:v([t.clip,!1],r,i),color:s,display:e,font:n,lines:a,offset:v([t.offset,4],r,i),opacity:v([t.opacity,1],r,i),origin:ot(o._el,r),padding:Be(v([t.padding,4],r,i)),positioner:it(o._el),rotation:v([t.rotation,0],r,i)*(Math.PI/180),size:D.textSize(o._ctx,a,n),textAlign:v([t.textAlign,"start"],r,i),textShadowBlur:v([t.textShadowBlur,0],r,i),textShadowColor:v([t.textShadowColor,s],r,i),textStrokeColor:v([t.textStrokeColor,s],r,i),textStrokeWidth:v([t.textStrokeWidth,0],r,i)}},update:function(e){var a=this,t=null,r=null,o=a._index,i=a._config,n,s,d,l=v([i.display,!0],e,o);l&&(n=e.dataset.data[o],s=Ie(ne(i.formatter,[n,e]),n),d=E(s)?[]:D.toTextLines(s),d.length&&(t=a._modelize(l,d,i,e),r=at(t))),a._model=t,a._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,a){var t=this,r=e.ctx,o=t._model,i=t._rects,n;this.visible()&&(r.save(),o.clip&&(n=o.area,r.beginPath(),r.rect(n.left,n.top,n.right-n.left,n.bottom-n.top),r.clip()),r.globalAlpha=D.bound(0,o.opacity,1),r.translate(C(a.x),C(a.y)),r.rotate(o.rotation),st(r,i.frame,o),ut(r,o.lines,i.text,o),r.restore())}});var ft=Number.MIN_SAFE_INTEGER||-9007199254740991,ct=Number.MAX_SAFE_INTEGER||9007199254740991;function B(e,a,t){var r=Math.cos(t),o=Math.sin(t),i=a.x,n=a.y;return{x:i+r*(e.x-i)-o*(e.y-n),y:n+o*(e.x-i)+r*(e.y-n)}}function re(e,a){var t=ct,r=ft,o=a.origin,i,n,s,d,l;for(i=0;i<e.length;++i)n=e[i],s=n.x-o.x,d=n.y-o.y,l=a.vx*s+a.vy*d,t=Math.min(t,l),r=Math.max(r,l);return{min:t,max:r}}function L(e,a){var t=a.x-e.x,r=a.y-e.y,o=Math.sqrt(t*t+r*r);return{vx:(a.x-e.x)/o,vy:(a.y-e.y)/o,origin:e,ln:o}}var ve=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};V(ve.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,a,t){this._rotation=t,this._rect={x:a.x+e.x,y:a.y+e.y,w:a.w,h:a.h}},contains:function(e){var a=this,t=1,r=a._rect;return e=B(e,a.center(),-a._rotation),!(e.x<r.x-t||e.y<r.y-t||e.x>r.x+r.w+t*2||e.y>r.y+r.h+t*2)},intersects:function(e){var a=this._points(),t=e._points(),r=[L(a[0],a[1]),L(a[0],a[3])],o,i,n;for(this._rotation!==e._rotation&&r.push(L(t[0],t[1]),L(t[0],t[3])),o=0;o<r.length;++o)if(i=re(a,r[o]),n=re(t,r[o]),i.max<n.min||n.max<i.min)return!1;return!0},_points:function(){var e=this,a=e._rect,t=e._rotation,r=e.center();return[B({x:a.x,y:a.y},r,t),B({x:a.x+a.w,y:a.y},r,t),B({x:a.x+a.w,y:a.y+a.h},r,t),B({x:a.x,y:a.y+a.h},r,t)]}});function he(e,a,t){var r=a.positioner(e,a),o=r.vx,i=r.vy;if(!o&&!i)return{x:r.x,y:r.y};var n=t.w,s=t.h,d=a.rotation,l=Math.abs(n/2*Math.cos(d))+Math.abs(s/2*Math.sin(d)),u=Math.abs(n/2*Math.sin(d))+Math.abs(s/2*Math.cos(d)),f=1/Math.max(Math.abs(o),Math.abs(i));return l*=o*f,u*=i*f,l+=a.offset*o,u+=a.offset*i,{x:r.x+l,y:r.y+u}}function vt(e,a){var t,r,o,i;for(t=e.length-1;t>=0;--t)for(o=e[t].$layout,r=t-1;r>=0&&o._visible;--r)i=e[r].$layout,i._visible&&o._box.intersects(i._box)&&a(o,i);return e}function ht(e){var a,t,r,o,i,n,s;for(a=0,t=e.length;a<t;++a)r=e[a],o=r.$layout,o._visible&&(s=new Proxy(r._el,{get:(d,l)=>d.getProps([l],!0)[l]}),i=r.geometry(),n=he(s,r.model(),i),o._box.update(n,i,r.rotation()));return vt(e,function(d,l){var u=d._hidable,f=l._hidable;u&&f||f?l._visible=!1:u&&(d._visible=!1)})}var R={prepare:function(e){var a=[],t,r,o,i,n;for(t=0,o=e.length;t<o;++t)for(r=0,i=e[t].length;r<i;++r)n=e[t][r],a.push(n),n.$layout={_box:new ve,_hidable:!1,_visible:!0,_set:t,_idx:n._index};return a.sort(function(s,d){var l=s.$layout,u=d.$layout;return l._idx===u._idx?u._set-l._set:u._idx-l._idx}),this.update(a),a},update:function(e){var a=!1,t,r,o,i,n;for(t=0,r=e.length;t<r;++t)o=e[t],i=o.model(),n=o.$layout,n._hidable=i&&i.display==="auto",n._visible=o.visible(),a|=n._hidable;a&&ht(e)},lookup:function(e,a){var t,r;for(t=e.length-1;t>=0;--t)if(r=e[t].$layout,r&&r._visible&&r._box.contains(a))return e[t];return null},draw:function(e,a){var t,r,o,i,n,s;for(t=0,r=a.length;t<r;++t)o=a[t],i=o.$layout,i._visible&&(n=o.geometry(),s=he(o._el,o.model(),n),i._box.update(s,n,o.rotation()),o.draw(e,s))}},pt=function(e){if(E(e))return null;var a=e,t,r,o;if($e(e))if(!E(e.label))a=e.label;else if(!E(e.r))a=e.r;else for(a="",t=Object.keys(e),o=0,r=t.length;o<r;++o)a+=(o!==0?", ":"")+t[o]+": "+e[t[o]];return""+a},mt={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:pt,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},y="$datalabels",pe="$default";function yt(e,a){var t=e.datalabels,r={},o=[],i,n;return t===!1?null:(t===!0&&(t={}),a=V({},[a,t]),i=a.labels||{},n=Object.keys(i),delete a.labels,n.length?n.forEach(function(s){i[s]&&o.push(V({},[a,i[s],{_key:s}]))}):o.push(a),r=o.reduce(function(s,d){return Se(d.listeners||{},function(l,u){s[u]=s[u]||{},s[u][d._key||pe]=l}),delete d.listeners,s},{}),{labels:o,listeners:r})}function q(e,a,t,r){if(a){var o=t.$context,i=t.$groups,n;a[i._set]&&(n=a[i._set][i._key],n&&ne(n,[o,r])===!0&&(e[y]._dirty=!0,t.update(o)))}}function _t(e,a,t,r,o){var i,n;!t&&!r||(t?r?t!==r&&(n=i=!0):n=!0:i=!0,n&&q(e,a.leave,t,o),i&&q(e,a.enter,r,o))}function bt(e,a){var t=e[y],r=t._listeners,o,i;if(!(!r.enter&&!r.leave)){if(a.type==="mousemove")i=R.lookup(t._labels,a);else if(a.type!=="mouseout")return;o=t._hovered,t._hovered=i,_t(e,r,o,i,a)}}function gt(e,a){var t=e[y],r=t._listeners.click,o=r&&R.lookup(t._labels,a);o&&q(e,r,o,a)}var xt={id:"datalabels",defaults:mt,beforeInit:function(e){e[y]={_actives:[]}},beforeUpdate:function(e){var a=e[y];a._listened=!1,a._listeners={},a._datasets=[],a._labels=[]},afterDatasetUpdate:function(e,a,t){var r=a.index,o=e[y],i=o._datasets[r]=[],n=e.isDatasetVisible(r),s=e.data.datasets[r],d=yt(s,t),l=a.meta.data||[],u=e.ctx,f,b,T,A,x,S,g,k;for(u.save(),f=0,T=l.length;f<T;++f)if(g=l[f],g[y]=[],n&&g&&e.getDataVisibility(f)&&!g.skip)for(b=0,A=d.labels.length;b<A;++b)x=d.labels[b],S=x._key,k=new ce(x,u,g,f),k.$groups={_set:r,_key:S||pe},k.$context={active:!1,chart:e,dataIndex:f,dataset:s,datasetIndex:r},k.update(k.$context),g[y].push(k),i.push(k);u.restore(),V(o._listeners,d.listeners,{merger:function(j,G,me){G[j]=G[j]||{},G[j][a.index]=me[j],o._listened=!0}})},afterUpdate:function(e){e[y]._labels=R.prepare(e[y]._datasets)},afterDatasetsDraw:function(e){R.draw(e,e[y]._labels)},beforeEvent:function(e,a){if(e[y]._listened){var t=a.event;switch(t.type){case"mousemove":case"mouseout":bt(e,t);break;case"click":gt(e,t);break}}},afterEvent:function(e){var a=e[y],t=a._actives,r=a._actives=e.getActiveElements(),o=D.arrayDiff(t,r),i,n,s,d,l,u,f;for(i=0,n=o.length;i<n;++i)if(l=o[i],l[1])for(f=l[0].element[y]||[],s=0,d=f.length;s<d;++s)u=f[s],u.$context.active=l[1]===1,u.update(u.$context);(a._dirty||o.length)&&(R.update(a._labels),e.render()),delete a._dirty}};const wt="bold",kt=W({__name:"DevicePowerDistributionCard",props:{devices:{},power:{},selfSufficiency:{}},setup(e){const a=we(),t={id:"doughnutlabel",beforeDraw:(n,s,d)=>{const{ctx:l}=n;l.save(),l.globalCompositeOperation="destination-over";var u=n.chartArea.width,f=n.chartArea.height;l.font="1.2em sans-serif",l.fillStyle=d.color;const b=2;l.textBaseline="top";let T=0;for(let x=0;x<d.text.length;x++){const S=d.text[x],g=l.measureText(S);T+=(g.actualBoundingBoxAscent+g.actualBoundingBoxDescent)*b}let A=n.chartArea.top+(f-T)/2;for(let x=0;x<d.text.length;x++){const S=d.text[x],g=l.measureText(S),k=n.chartArea.left+Math.round((u-g.width)/2);l.fillText(S,k,A),A+=(g.actualBoundingBoxAscent+g.actualBoundingBoxDescent)*b}l.restore()},defaults:{text:[],color:"black"}},r=U(()=>{const n=i.devices.filter(s=>s.power>0);return{labels:n.map(s=>J.getDeviceInfo(s.device_id).name),datasets:[{data:n.map(s=>s.power)}]}}),o=U(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:a.current.value.colors["on-surface"]}},tooltip:{callbacks:{label:n=>`${P(n.parsed,"W")}`}},doughnutlabel:{color:a.current.value.colors["on-surface"],text:[P(i.power,"W"),i.selfSufficiency.toFixed(0)+"%"]},datalabels:{backgroundColor:function(n){return n.dataset.backgroundColor},borderColor:"white",borderRadius:25,borderWidth:2,color:"white",display:function(n){var s=n.dataset;const d=s.data.reduce((u,f)=>u+f,0);var l=s.data[n.dataIndex];return l>d/10},font:{weight:wt},padding:6,formatter:Math.round}}}));Re.register(se,Ve,We,je,t,xt);const i=e;return(n,s)=>(_(),K(Q,{class:"elevation-2 ma-4 pa-4 w-80 rounded-md sm:w-96"},{default:$(()=>[h(Y,null,{default:$(()=>[h(p(Ne),{data:r.value,options:o.value},null,8,["data","options"])]),_:1})]),_:1}))}}),Mt={class:"bg-subgroup pa-2 mt-2 items-center rounded-md"},Ct={class:"text-left"},Pt={class:"float-right"},$t={class:"pa-2 bg-subgroup mt-2 items-center rounded-md"},St={class:"text-left"},It={class:"float-right"},Tt={class:"pa-2 bg-subgroup mt-2 items-center rounded-md"},At={class:"text-left"},Bt={class:"float-right"},Et={class:"pa-2 bg-subgroup mt-2 items-center rounded-md"},Dt={class:"text-left"},Rt={class:"float-right"},Vt=W({__name:"ConsumptionCard",props:{selfSufficiency:{},selfConsumption:{},selfSufficiencyToday:{},selfConsumptionToday:{}},setup(e){return(a,t)=>(_(),K(Q,{class:"elevation-2 ma-4 pa-4 w-80 rounded-md sm:w-96"},{default:$(()=>[h(ie,null,{default:$(()=>[I(m(p(M)("consumption")),1)]),_:1}),h(Y,null,{default:$(()=>[c("div",Mt,[c("div",Ct,[I(m(p(M)("self_sufficiency"))+" ",1),c("span",Pt,m(p(P)(a.selfSufficiency,"%")),1)]),h(N,{color:"sun",height:"15",rounded:"","model-value":a.selfSufficiency},null,8,["model-value"])]),c("div",$t,[c("div",St,[I(m(p(M)("self_consumption"))+" ",1),c("span",It,m(p(P)(a.selfConsumption,"%")),1)]),h(N,{color:"grid",height:"15",rounded:"","model-value":a.selfConsumption},null,8,["model-value"])]),c("div",null,m(p(M)("period.today"))+":",1),c("div",Tt,[c("div",At,[I(m(p(M)("self_sufficiency"))+" ",1),c("span",Bt,m(p(P)(a.selfSufficiencyToday,"%")),1)]),h(N,{color:"sun",height:"15",rounded:"","model-value":a.selfSufficiencyToday},null,8,["model-value"])]),c("div",Et,[c("div",Dt,[I(m(p(M)("self_consumption"))+" ",1),c("span",Rt,m(p(P)(a.selfConsumptionToday,"%")),1)]),h(N,{color:"grid",height:"15",rounded:"","model-value":a.selfConsumptionToday},null,8,["model-value"])])]),_:1})]),_:1}))}}),Wt={class:"flex min-h-screen w-full justify-center"},jt={key:0,class:"flex w-full justify-items-center p-4"},Nt={key:1},zt={class:"bg-background grid grid-cols-1 p-4 lg:grid-cols-2"},sr=W({__name:"Home",setup(e){const a=U(()=>ee.home),t=U(()=>ee.state.connected);return(r,o)=>(_(),w("div",null,[h(ze,{color:"transparent",title:a.value.name},null,8,["title"]),h(Oe),c("div",Wt,[t.value?(_(),w("div",Nt,[c("div",zt,[h(Me,{"home-consumption-power":a.value.power.home_consumption,"solar-power":a.value.power.solar_production,unit:"W"},null,8,["home-consumption-power","solar-power"]),h(kt,{devices:a.value.devices,power:a.value.power.home_consumption,"self-sufficiency":a.value.power.self_sufficiency},null,8,["devices","power","self-sufficiency"]),h(Vt,{"self-sufficiency":a.value.power.self_sufficiency,"self-consumption":a.value.power.self_consumption,"self-sufficiency-today":a.value.today.self_sufficiency,"self-consumption-today":a.value.today.self_consumption},null,8,["self-sufficiency","self-consumption","self-sufficiency-today","self-consumption-today"]),(_(!0),w(ae,null,oe(a.value.devices,(i,n)=>(_(),w("div",{key:n},[h(Ze,{device:p(J).getDeviceInfo(i.device_id),available:i.available,power:i.power,today:i.today,attributes:i.attributes},null,8,["device","available","power","today","attributes"])]))),128))])])):(_(),w("div",jt,[h(Fe,{indeterminate:"",color:"primary"})]))])]))}});export{sr as default};
