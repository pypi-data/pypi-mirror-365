Metadata-Version: 2.4
Name: thoth-vdbmanager
Version: 0.2.11
Summary: A vector database management module for ThothAI Project
Author-email: Marco Pancotti <mp@tylconsulting.it>
Project-URL: Homepage, https://github.com/mptyl/thoth_vdb2
Project-URL: Bug Tracker, https://github.com/mptyl/thoth_vdb2/issues
Project-URL: Documentation, https://github.com/mptyl/thoth_vdb2#readme
Project-URL: Source Code, https://github.com/mptyl/thoth_vdb2
Keywords: vector-database,ai,machine-learning,embeddings,similarity-search
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.12
Description-Content-Type: text/markdown
License-File: LICENSE.md
Requires-Dist: annotated-types==0.7.0
Requires-Dist: anyio==4.9.0
Requires-Dist: attrs==25.3.0
Requires-Dist: backoff==2.2.1
Requires-Dist: certifi==2025.1.31
Requires-Dist: charset-normalizer==3.4.1
Requires-Dist: construct==2.5.3
Requires-Dist: distro==1.9.0
Requires-Dist: grpcio==1.71.0
Requires-Dist: grpcio-tools==1.71.0
Requires-Dist: h11==0.14.0
Requires-Dist: h2==4.2.0
Requires-Dist: haystack==0.42
Requires-Dist: haystack-ai==2.12.2
Requires-Dist: haystack-experimental==0.9.0
Requires-Dist: sentence-transformers
Requires-Dist: hpack==4.1.0
Requires-Dist: httpcore==1.0.8
Requires-Dist: httpx==0.28.1
Requires-Dist: hyperframe==6.1.0
Requires-Dist: idna==3.10
Requires-Dist: Jinja2==3.1.6
Requires-Dist: jiter==0.9.0
Requires-Dist: jsonschema==4.23.0
Requires-Dist: jsonschema-specifications==2024.10.1
Requires-Dist: lazy_imports==0.4.0
Requires-Dist: MarkupSafe==3.0.2
Requires-Dist: monotonic==1.6
Requires-Dist: more-itertools==10.6.0
Requires-Dist: networkx==3.4.2
Requires-Dist: numpy==2.2.4
Requires-Dist: openai==1.75.0
Requires-Dist: pefile==2024.8.26
Requires-Dist: portalocker==2.10.1
Requires-Dist: posthog==3.25.0
Requires-Dist: protobuf==5.29.4
Requires-Dist: pydantic==2.11.3
Requires-Dist: pydantic_core==2.33.1
Requires-Dist: python-dateutil==2.9.0.post0
Requires-Dist: python-ptrace==0.9.9
Requires-Dist: PyYAML==6.0.2
Requires-Dist: qdrant-client<1.16.0,>=1.15.0
Requires-Dist: qdrant-haystack<9.2.0,>=9.1.1
Requires-Dist: referencing==0.36.2
Requires-Dist: requests==2.32.3
Requires-Dist: rpds-py==0.24.0
Requires-Dist: six==1.17.0
Requires-Dist: sniffio==1.3.1
Requires-Dist: tenacity==9.1.2
Requires-Dist: tqdm==4.67.1
Requires-Dist: typing-inspection==0.4.0
Requires-Dist: typing_extensions==4.13.2
Requires-Dist: urllib3==2.4.0
Provides-Extra: test
Requires-Dist: pytest>=7.0.0; extra == "test"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "test"
Requires-Dist: docker>=6.0.0; extra == "test"
Provides-Extra: all
Requires-Dist: chromadb>=0.4.0; extra == "all"
Requires-Dist: weaviate-client>=3.20.0; extra == "all"
Requires-Dist: pinecone-client>=2.2.0; extra == "all"
Provides-Extra: chroma
Requires-Dist: chromadb>=0.4.0; extra == "chroma"
Provides-Extra: weaviate
Requires-Dist: weaviate-client>=3.20.0; extra == "weaviate"
Provides-Extra: pinecone
Requires-Dist: pinecone-client>=2.2.0; extra == "pinecone"
Dynamic: license-file

# Thoth Vector Database Manager v2.0

A high-performance, Haystack-based vector database manager with support for multiple backends and local embedding capabilities.

## 🚀 Features

- **Multi-backend support**: Qdrant, Weaviate, Chroma, PostgreSQL pgvector, Milvus, Pinecone
- **Haystack integration**: Uses Haystack as an abstraction layer over vector stores
- **Local embeddings**: Uses open-source Sentence Transformers for local embedding generation
- **Memory optimization**: Lazy loading and efficient batch processing
- **API compatibility**: Maintains backward compatibility with existing ThothVectorStore API
- **Type safety**: Full type hints and Pydantic validation
- **Flexible deployment**: Multiple modes (memory, filesystem, server) for different use cases
- **Production-ready**: Comprehensive testing and robust error handling

## 📦 Installation

```bash
# Basic installation
pip install thoth-vdb2

# With specific backend support
pip install thoth-vdb2[qdrant]
pip install thoth-vdb2[weaviate]
pip install thoth-vdb2[chroma]
pip install thoth-vdb2[pgvector]
pip install thoth-vdb2[milvus]
pip install thoth-vdb2[pinecone]

# All backends
pip install thoth-vdb2[all]
```

## 🏗️ Architecture

The library is built on a clean architecture with:

- **Core**: Base interfaces and document types
- **Adapters**: Backend-specific implementations using Haystack
- **Factory**: Unified creation interface
- **Compatibility**: Legacy API support

## 🚀 Quick Start

### New API (Recommended)

```python
from vdbmanager import VectorStoreFactory, ColumnNameDocument, SqlDocument, HintDocument

# Create a vector store
store = VectorStoreFactory.create(
    backend="qdrant",
    collection="my_collection",
    host="localhost",
    port=6333
)

# Add documents
column_doc = ColumnNameDocument(
    table_name="users",
    column_name="email",
    original_column_name="user_email",
    column_description="User email address",
    value_description="Valid email format"
)

doc_id = store.add_column_description(column_doc)

# Search documents
results = store.search_similar(
    query="user email",
    doc_type="column_name",
    top_k=5
)
```

### Legacy API (Backward Compatible)

```python
from vdbmanager import ThothVectorStore

# Works exactly like before
store = ThothVectorStore(
    backend="qdrant",
    collection="my_collection",
    host="localhost",
    port=6333
)

# All existing methods work
doc_id = store.add_column_description(column_doc)
results = store.search_similar("user email", "column_name")
```

## 🔧 Configuration

### Qdrant
```python
store = VectorStoreFactory.create(
    backend="qdrant",
    collection="my_collection",
    host="localhost",
    port=6333,
    api_key="your-api-key",  # Optional
    embedding_dim=384,  # Optional
    hnsw_config={"m": 16, "ef_construct": 100}
)
```

### Weaviate (Production-Ready with Docker)

**Docker Setup (Recommended):**
```python
store = VectorStoreFactory.create(
    backend="weaviate",
    collection="MyCollection",
    url="http://localhost:8080",
    use_docker=True,
    docker_compose_file="docker-compose-weaviate.yml"
)
```

**Manual Configuration:**
```python
store = VectorStoreFactory.create(
    backend="weaviate",
    collection="MyCollection",
    url="http://localhost:8080",
    timeout=30,
    skip_init_checks=False,  # Set to True if gRPC issues
    api_key="your-api-key"  # Optional
)
```

> 📖 **See [Weaviate Configuration Guide](docs/WEAVIATE_CONFIGURATION.md) for detailed setup instructions**

### Chroma (Multiple Modes)

**Memory Mode (Recommended for Testing):**
```python
store = VectorStoreFactory.create(
    backend="chroma",
    collection="my_collection",
    mode="memory"  # Fast, isolated, no persistence
)
```

**Filesystem Mode:**
```python
store = VectorStoreFactory.create(
    backend="chroma",
    collection="my_collection",
    mode="filesystem",
    persist_path="./chroma_db"
)
```

**Server Mode (Production):**
```python
store = VectorStoreFactory.create(
    backend="chroma",
    collection="my_collection",
    mode="server",
    host="localhost",
    port=8000
)
```

> 📖 **See [Chroma Configuration Guide](docs/CHROMA_CONFIGURATION.md) for detailed setup instructions**

### PostgreSQL pgvector
```python
store = VectorStoreFactory.create(
    backend="pgvector",
    collection="my_table",
    connection_string="postgresql://user:pass@localhost:5432/dbname"
)
```

### Milvus (Multiple Modes)

**Lite Mode (Recommended for Testing):**
```python
store = VectorStoreFactory.create(
    backend="milvus",
    collection="my_collection",
    mode="lite",
    connection_uri="./milvus.db"  # File-based storage
)
```

**Server Mode (Production):**
```python
store = VectorStoreFactory.create(
    backend="milvus",
    collection="my_collection",
    mode="server",
    host="localhost",
    port=19530
)
```

> 📖 **See [Milvus Configuration Guide](docs/MILVUS_CONFIGURATION.md) for detailed setup instructions**

### Pinecone
```python
store = VectorStoreFactory.create(
    backend="pinecone",
    collection="my-index",
    api_key="your-api-key",
    environment="us-west1-gcp-free"
)
```

## 📊 Performance Optimizations

### Memory Usage
- **Lazy initialization**: Embedders and connections are initialized on first use
- **Singleton pattern**: Same configuration reuses existing instances
- **Batch processing**: Efficient bulk operations

### Performance Tuning
```python
# Optimize for specific use cases
store = VectorStoreFactory.create(
    backend="qdrant",
    collection="optimized",
    embedding_model="sentence-transformers/all-MiniLM-L6-v2",  # 384-dim, fast
    hnsw_config={"m": 32, "ef_construct": 200}  # Better search quality
)
```

## 🧪 Testing

```bash
# Run all tests
pytest

# Run specific backend tests
pytest tests/test_qdrant.py -v

# Run with coverage
pytest --cov=vdbmanager tests/
```

## 📈 Migration Guide

### From v1.x to v2.x

#### Simple Migration
```python
# Old code (v1.x)
from vdbmanager import QdrantHaystackStore

store = QdrantHaystackStore(
    collection="my_docs",
    host="localhost",
    port=6333
)

# New code (v2.x) - fully compatible
from vdbmanager import QdrantHaystackStore  # Still works!

# Or use new API
from vdbmanager import VectorStoreFactory

store = VectorStoreFactory.create(
    backend="qdrant",
    collection="my_docs",
    host="localhost",
    port=6333
)
```

#### Advanced Migration
```python
# Old code
from vdbmanager import ThothVectorStore

# New code - same interface, better internals
from vdbmanager import ThothVectorStore  # Still works with warnings

# Recommended new approach
from vdbmanager import QdrantAdapter

store = QdrantAdapter(
    collection="my_docs",
    host="localhost",
    port=6333
)
```

## 🔍 API Reference

### Core Classes

#### VectorStoreFactory
```python
# Create store
store = VectorStoreFactory.create(backend, collection, **kwargs)

# From config
config = {"backend": "qdrant", "params": {...}}
store = VectorStoreFactory.from_config(config)

# List backends
backends = VectorStoreFactory.list_backends()
```

#### Document Types
- `ColumnNameDocument`: Column metadata
- `SqlDocument`: SQL examples
- `HintDocument`: General hints

### Methods
- `add_column_description(doc)`: Add column metadata
- `add_sql(doc)`: Add SQL example
- `add_hint(doc)`: Add hint
- `search_similar(query, doc_type, top_k=5, score_threshold=0.7)`: Semantic search
- `get_document(doc_id)`: Retrieve by ID
- `bulk_add_documents(docs)`: Batch insert
- `get_collection_info()`: Get stats

## 🐛 Troubleshooting

### Common Issues

#### Connection Errors
```python
# Check service availability
import requests
requests.get("http://localhost:6333")  # Qdrant
```

#### Memory Issues
```python
# Use smaller embedding model
store = VectorStoreFactory.create(
    backend="qdrant",
    collection="my_collection",
    embedding_model="sentence-transformers/all-MiniLM-L6-v2"  # 384-dim
)
```

#### Performance Issues
```python
# Tune HNSW parameters
store = VectorStoreFactory.create(
    backend="qdrant",
    collection="my_collection",
    hnsw_config={"m": 16, "ef_construct": 100}
)
```

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality
4. Ensure all tests pass
5. Submit a pull request

## 📄 License

MIT License - see LICENSE file for details.

## Directory structure
vdbmanager/
├── core/                    # Base interfaces and document types
│   ├── base.py             # Core document classes and interfaces
│   └── __init__.py
├── adapters/               # Backend-specific implementations
│   ├── haystack_adapter.py # Base Haystack adapter
│   ├── qdrant_adapter.py   # Qdrant implementation
│   ├── weaviate_adapter.py # Weaviate implementation
│   ├── chroma_adapter.py   # Chroma implementation
│   ├── pgvector_adapter.py # PostgreSQL pgvector
│   ├── milvus_adapter.py   # Milvus implementation
│   └── pinecone_adapter.py # Pinecone implementation
├── factory.py              # Unified creation interface
├── compat/                 # Legacy compatibility layer
│   ├── __init__.py
│   └── thoth_vector_store.py
└── __init__.py            # Public API exports


## NewAPI (reccomended)
from vdbmanager import VectorStoreFactory, ColumnNameDocument

### Create any backend
store = VectorStoreFactory.create(
    backend="qdrant",
    collection="my_docs",
    host="localhost",
    port=6333
)

### Use optimized methods
doc_id = store.add_column_description(column_doc)
results = store.search_similar("user email", "column_name")


## Old API (Fully compatible)
from vdbmanager import ThothVectorStore  # Works with warnings

### Existing code continues to work
store = ThothVectorStore(
    backend="qdrant",
    collection="my_docs",
    host="localhost",
    port=6333
)
