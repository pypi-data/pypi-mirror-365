import{r as i,j as e}from"./@radix-C_LirfyT.js";import{a as p,u as D,S as v,E as S}from"./SecretTooltip-BcWMKb9f.js";import{b as f,h as b}from"./@tanstack-C0SeHZng.js";import{aJ as C,b8 as N,aK as w,I as j,b9 as E,aM as k,B as h,aI as T,ba as K,J as A,K as V,L as B,M as O,d as L,aA as I,aB as z,W as F,Z as M,bb as Q,r as R,j as q,V as P}from"./index-BacoJBEQ.js";import{S as H}from"./eye-CLNgIh_K.js";import{S as _}from"./key-icon-HOx2gazv.js";import{S as J}from"./trash-HKxXWbSG.js";import{A as $}from"./AlertDialogDropdownItem-druRNuO2.js";import{a as U}from"./@react-router-BSsrkPOd.js";import"./plus-cI8zD2xh.js";import"./zod-DgEcN9jD.js";import"./index.esm-COnaHLSh.js";import"./CodeSnippet-D8iBqOVv.js";import"./info-CyMih3vQ.js";import"./@reactflow-D9hglKLF.js";function W({secretId:t,keyName:s}){const{data:a,isLoading:r,isError:u}=f({...p.secretDetail(t)}),l=b(),{mutate:c}=D({onError(d){T(d)&&K({status:"error",emphasis:"subtle",description:d.message,rounded:!0})},onSuccess(){l.invalidateQueries({queryKey:["secrets"]}),l.invalidateQueries({queryKey:["secretDetail",t]})}}),[n,m]=i.useState(""),x=()=>{var d;if(a){const g={...(d=a.body)==null?void 0:d.values};delete g[s];const y={name:a.name,values:g};c({id:t,body:y})}};function o(d){m(d.target.value)}return r?e.jsx("div",{children:"Loading..."}):u?e.jsx("div",{children:"Error loading secret details"}):e.jsxs(C,{children:[e.jsx(N,{children:e.jsx(w,{children:"Delete Key"})}),e.jsxs("div",{className:"gap-5 p-5",children:[e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"Are you sure you want to delete this key?"}),e.jsx("p",{className:"text-text-md text-theme-text-secondary",children:"This action cannot be undone."}),e.jsx("h3",{className:"font-inter text-sm mb-1 mt-4 text-left font-medium leading-5",children:"Please type DELETE to confirm"}),e.jsx(j,{name:"key",onChange:o,className:"w-full",required:!0,value:n})]}),e.jsxs(E,{className:"gap-[10px]",children:[e.jsx(k,{asChild:!0,children:e.jsx(h,{size:"sm",intent:"secondary",children:"Cancel"})}),e.jsx(h,{intent:"danger",type:"button",onClick:x,disabled:n!=="DELETE",children:"Delete"})]})]})}function Z({secretId:t,keyName:s}){const[a,r]=i.useState(!1),[u,l]=i.useState(!1),c=i.useRef(null),n=i.useRef(null);function m(){n.current=c.current}function x(o){if(o===!1){r(!1),setTimeout(()=>{l(o)},200);return}l(o)}return e.jsxs(A,{onOpenChange:r,open:a,children:[e.jsx(V,{ref:c,children:e.jsx(B,{className:"h-4 w-4 fill-theme-text-tertiary"})}),e.jsx(O,{hidden:u,onCloseAutoFocus:o=>{n.current&&(n.current.focus(),n.current=null,o.preventDefault())},align:"end",sideOffset:7,children:e.jsx($,{onSelect:m,onOpenChange:x,triggerChildren:"Delete ",icon:e.jsx(J,{}),children:e.jsx(W,{secretId:t,keyName:s})})})]})}const G=({value:t})=>{const[s,a]=i.useState(!1),r=typeof t=="string"?t:"",u="â€¢".repeat(r.length);return e.jsxs("div",{className:"flex  items-center gap-2 space-x-2",children:[e.jsx(H,{onClick:()=>a(!s),className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:s?r:u})]})};function X(t,s){return[{id:"key",header:"Key",accessorKey:"key",cell:({row:a})=>{const r=`from zenml.client import Client
secret = Client().get_secret("${s}")
	  
# 'secret.secret_values' will contain a dictionary with all key-value pairs within your secret.
secret.secret_values["${a.original.key}"]
	  `;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-5 w-5 flex-shrink-0 fill-primary-400"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:a.original.key}),e.jsx(v,{code:r})]})})})]})}},{id:"value",header:"Value",accessorKey:"value",cell:({row:a})=>e.jsx(G,{value:a.getValue("value")})},{id:"actions",header:"",cell:({row:a})=>e.jsx(Z,{secretId:t,keyName:a.original.key})}]}function Y({secretId:t}){var c;const[s,a]=i.useState(""),r=f({...p.secretDetail(t)});if(r.isPending)return e.jsx(L,{className:"h-[200px] w-full"});if(r.isError)return e.jsx("div",{children:r.error.message});const l=Object.entries(((c=r.data.body)==null?void 0:c.values)||{}).map(([n,m])=>({key:n,value:m})).filter(n=>n.key.toLowerCase().includes(s.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-2",children:[e.jsx(j,{type:"text",placeholder:"Search Keys...",value:s,onChange:n=>a(n.target.value),inputSize:"md"}),e.jsxs(I,{children:[e.jsx(z,{asChild:!0,children:e.jsx(h,{size:"sm",intent:"primary",children:"Edit Keys"})}),e.jsx(S,{secretId:t,isSecretNameEditable:!1,dialogTitle:"Edit keys"})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(F,{columns:X(t,r.data.name),data:l})})]})}function ee(t){const{setBreadcrumbs:s}=M();i.useEffect(()=>{t&&s([...Q,{label:t.name,href:R.settings.secrets.detail(t.id)}])},[t,s])}function fe(){const{secretId:t}=U(),{data:s}=f({...p.secretDetail(t||"")});return ee(s),e.jsx(e.Fragment,{children:e.jsxs(q,{className:"space-y-5 p-5",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-text-xl font-semibold",children:s==null?void 0:s.name}),e.jsxs("div",{className:"group/copybutton flex items-center space-x-1",children:[e.jsx("div",{className:"text-theme-text-secondary",children:t==null?void 0:t.slice(0,8)}),e.jsx(P,{copyText:t})]})]}),e.jsx(Y,{secretId:t||""})]})})}export{fe as default};
