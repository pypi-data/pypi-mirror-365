import{r as j,j as s}from"./@radix-C_LirfyT.js";import{R as g,u as b,a as y,b as N}from"./ButtonGroup-SF2DlzHV.js";import{Z as v,_ as P,r as c,$ as S,z as i,N as p,O as R,Q as k,R as C,U as T,V as u,T as x,a0 as _,B as w,W as E,d as h}from"./index-BacoJBEQ.js";import{S as B}from"./pipeline-BJ8liDnl.js";import{f as D,L as l,a as f}from"./@react-router-BSsrkPOd.js";import{S as A}from"./refresh-3EF2R7ja.js";import{u as F}from"./all-pipeline-runs-query-gorNNEaT.js";import{S as I}from"./SearchField-D_0-uAPj.js";import{P as z}from"./Pagination-CcDD5yHh.js";import{S as U}from"./terminal-BObrvDlO.js";import{D as H}from"./DisplayDate-v3KW7oez.js";import{g as L,E as $}from"./ExecutionStatus-C4tlFnlh.js";import"./trash-HKxXWbSG.js";import"./AlertDialogDropdownItem-druRNuO2.js";import"./DeleteAlertDialog-BbyFVnVI.js";import"./zod-DgEcN9jD.js";import"./index.esm-COnaHLSh.js";import"./bulk-delete-B5RTlnD_.js";import"./@tanstack-C0SeHZng.js";import"./delete-run-ibBtciMR.js";import"./@reactflow-D9hglKLF.js";import"./index-BRhKF2z-.js";import"./chevron-right-double-CbRQKN4Q.js";import"./check-circle-mnEgPhPF.js";import"./help-B0CvBhCm.js";function G(e){const{setBreadcrumbs:t}=v();j.useEffect(()=>{e&&t([P,{label:e,href:c.projects.pipelines.namespace(e)}])},[t,e])}function O({namespace:e}){return s.jsx(S,{children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(B,{className:"h-5 w-5 fill-neutral-400"}),s.jsx("h1",{className:"text-display-xs font-semibold",children:decodeURIComponent(e)})]})})}const d=1,q=i.object({page:i.coerce.number().min(d).optional().default(d).catch(d),name:i.string().optional(),operator:i.enum(["and","or"]).optional()});function Q(){const[e]=D(),{page:t,name:a,operator:r}=q.parse({page:e.get("page")||void 0,name:e.get("name")||void 0});return{page:t,name:a,logical_operator:r}}function V(){return[{id:"select",meta:{width:"1%"},header:({table:e})=>s.jsx(p,{id:"check-all",checked:e.getIsAllRowsSelected(),onCheckedChange:t=>e.toggleAllRowsSelected(t==="indeterminate"?!0:t)}),cell:({row:e})=>s.jsx(p,{id:`check-${e.id}`,checked:e.getIsSelected(),onCheckedChange:e.getToggleSelectedHandler()})},{id:"run",header:"Run",accessorFn:e=>{var t;return{name:e.name,id:e.id,status:(t=e.body)==null?void 0:t.status}},cell:({getValue:e})=>{const{name:t,status:a,id:r}=e();return s.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[s.jsx(U,{className:`h-5 w-5 shrink-0 ${L(a)}`}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(l,{to:c.projects.runs.detail(r),className:"flex items-center gap-1",children:s.jsx("h2",{className:"text-text-md font-semibold",children:t})}),s.jsx(R,{children:s.jsxs(k,{children:[s.jsx(C,{className:"hover:text-theme-text-brand hover:underline",children:s.jsx($,{status:a})}),s.jsx(T,{className:"z-20 capitalize",children:a})]})}),s.jsx(u,{copyText:t})]}),s.jsxs(l,{to:c.projects.runs.detail(r),className:"flex items-center gap-1",children:[s.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:r.split("-")[0]}),s.jsx(u,{copyText:r})]})]})]})}},{id:"stack",header:"Stack",accessorFn:e=>{var t,a,r,o;return{name:(a=(t=e.body)==null?void 0:t.stack)==null?void 0:a.name,id:(o=(r=e.body)==null?void 0:r.stack)==null?void 0:o.id}},cell:({getValue:e})=>{const{name:t,id:a}=e();return!t||!a?null:s.jsx(l,{to:c.stacks.overview,children:s.jsx(x,{rounded:!1,className:"inline-block",color:"turquoise",emphasis:"subtle",children:t})})}},{id:"repository",header:"Repository",accessorFn:e=>{var t,a,r,o,n,m;return{name:(r=(a=(t=e.body)==null?void 0:t.code_reference)==null?void 0:a.body)==null?void 0:r.code_repository.name,id:(m=(n=(o=e.body)==null?void 0:o.code_reference)==null?void 0:n.body)==null?void 0:m.code_repository.id}},cell:({getValue:e})=>{const{name:t,id:a}=e();return!t||!a?null:s.jsx("div",{children:s.jsx(x,{rounded:!1,className:"inline-block",color:"grey",emphasis:"subtle",children:t})})}},{id:"created",header:"Created at",accessorFn:e=>{var t;return(t=e.body)==null?void 0:t.created},cell:({getValue:e})=>s.jsx("p",{className:"text-text-sm text-theme-text-secondary",children:s.jsx(H,{dateString:e()})})},{id:"author",header:"Author",accessorFn:e=>{var t;return{author:(t=e.resources)==null?void 0:t.user}},cell:({getValue:e})=>{const{author:t}=e();return s.jsx(_,{username:t.name})}},{id:"admin_actions",header:"",meta:{width:"5%"},cell:({row:e})=>s.jsx(g,{id:e.original.id})}]}function W(){const{namespace:e}=f(),t=Q(),a=V(),{selectedRowCount:r}=b(),{data:o,refetch:n}=F({params:{pipeline_name:decodeURIComponent(e),...t,sort_by:"desc:updated"}},{throwOnError:!0});return s.jsxs("div",{className:"flex flex-col gap-5 p-5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[r?s.jsx(y,{}):s.jsx(I,{searchParams:t}),s.jsxs(w,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>n(),children:[s.jsx(A,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})]}),s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:o?s.jsx(E,{columns:a,data:o.items}):s.jsx(h,{className:"h-[500px] w-full"})}),o?o.total_pages>1&&s.jsx(z,{searchParams:t,paginate:o}):s.jsx(h,{className:"h-[36px] w-[300px]"})]})]})}function be(){const{namespace:e}=f();return G(e),s.jsx("div",{children:s.jsxs(N,{children:[s.jsx(O,{namespace:e}),s.jsx(W,{})]})})}export{be as default};
