import{b as U,n as M,h as A,g as x,c as k,o as u,w as e,a as o,f,B as D,e as O,m as h,G as W,F,l as p,t as g,s as q,j as H}from"./index-DcpcTAVM.js";import{_ as J}from"./CreationForm-B5s3Ed0_.js";import{u as G,_ as K,a as Q}from"./ProviderGeneralForm-DDjVdCIF.js";import{_ as X}from"./MenuItems-BfW3gGal.js";import{V as L}from"./VMenu-BlfsP2M-.js";import{V as N,d as E}from"./VAvatar-DDNBZypX.js";import{V as T}from"./VChip-wT0AYTSN.js";import{V as z,a as Y}from"./VToolbar-BWE5bp46.js";import{V as Z}from"./forwardRefs-BuGWfe-l.js";import{V as I}from"./VSpacer-DKx9oOa5.js";import{V as ee}from"./VTextField-CCbnCKqE.js";import{V as oe}from"./VDataTable-Bj3p31ck.js";import{b as te}from"./VCard-D7-TBV5x.js";import{V as ae}from"./VDialog-B6Kt4DVL.js";import"./ConfirmDialog-BYCtiwnk.js";import"./VRow-CmoPqXgf.js";/* empty css              */import"./tag-11Ya6jy9.js";import"./VWindowItem-BcdC2Vz4.js";import"./ssrBoot-CzlXdbAl.js";import"./VContainer-DdNjhtFZ.js";import"./VSheet-B11haNlJ.js";import"./VProgressCircular-Bpqlsr6q.js";import"./domains-B44PXtMU.js";import"./VAutocomplete-DIexMD8n.js";import"./VSelect-CYmWVDiw.js";import"./VCheckboxBtn-CNF1oXGp.js";import"./VSelectionControl-SQ4y3plm.js";import"./filter-CJgpAWEM.js";import"./VForm-BZhv2JRQ.js";import"./VSwitch-Dg1t3Put.js";import"./VTable-BiKyTVHH.js";const re={__name:"ProviderCreationForm",emits:["close"],setup(j,{emit:s}){const d=s,{$gettext:i}=U(),c=M(),v=G(),B=A(()=>{const n=[];let l=!0;for(const V of a.value.domains){const R=V.new_domain?`${V.name} => ${V.new_domain.name}`:`${V.name} ${i("(the domain will be created locally)")}`;n.push({key:l?i("Associated domain"):"",value:R}),l=!1}return n}),b=A(()=>[{title:i("General"),items:[{key:i("Name"),value:a.value.name},{key:i("Address"),value:a.value.address},{key:i("Port"),value:a.value.port},{key:i("Secured"),value:a.value.secured,type:"yesno"}]},{title:i("Associated domains"),items:B.value}]),P=[{name:"general",title:i("General")},{name:"associated",title:i("Associated domains")}],a=x({domains:[]}),$=x(),C=x(),S={general:$,associated:C};w();function w(){a.value={name:"",address:"",port:993,secured:!0,domains:[]}}function m(){w(),d("close")}function r(n){return S.value[n.name]}function t(n){return console.log(a.value),S[n.name].value.vFormRef}function _(){}function y(){const n={...a.value};n.domains=[];for(const l of a.value.domains)l.new_domain?n.domains.push({name:l.name,new_domain:l.new_domain.pk}):n.domains.push(l);v.createProvider(n).then(()=>{c.displayNotification({msg:i("Provider created")}),m()})}return(n,l)=>(u(),k(f(J),{ref:"form",title:f(i)("New provider"),steps:P,"form-getter":r,"get-v-form-ref":t,"validate-object":_,"summary-sections":b.value,onClose:m,onCreate:y},{"form.general":e(()=>[o(Q,{ref_key:"general",ref:$,modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=V=>a.value=V),class:"ml-4"},null,8,["modelValue"])]),"form.associated":e(()=>[o(K,{ref_key:"associated",ref:C,modelValue:a.value.domains,"onUpdate:modelValue":l[1]||(l[1]=V=>a.value.domains=V)},null,8,["modelValue"])]),_:2},1032,["title","summary-sections"]))}},se=["colspan"],ie={__name:"ProvidersList",setup(j){const{$gettext:s}=U(),d=G(),i=q(),c=A(()=>d.providers),v=A(()=>d.providersLoaded),B=[{title:s("Name"),key:"name"},{title:s("Address"),key:"address"},{title:s("Port"),key:"port"},{title:s("Secured"),key:"secured"},{title:s("Associated domains"),key:"domains"},{title:s("Actions"),key:"actions",sortable:!1,align:"right"}],b=x([]),P=x(""),a=x([]);function $(m){d.deleteProvider(m.id)}function C(m){i.push({name:"ProviderEdit",params:{id:m.id}})}function S(){const m=[];return m.push({label:s("Delete"),icon:"mdi-delete-outline",onClick:$,color:"red"}),m.push({label:s("Edit"),icon:"mdi-circle-edit-outline",onClick:C}),m}function w(){d.getProviders()}return v.value||w(),(m,r)=>(u(),k(te,{class:"mt-6"},{default:e(()=>[o(oe,{modelValue:b.value,"onUpdate:modelValue":r[1]||(r[1]=t=>b.value=t),expanded:a.value,"onUpdate:expanded":r[2]||(r[2]=t=>a.value=t),headers:B,items:Object.values(c.value),search:P.value,loading:!v.value,"item-value":"name","single-expand":"","show-select":"","onClick:row":r[3]||(r[3]=(t,_)=>_.expand(!_.isExpanded))},{top:e(()=>[o(z,{color:"white",flat:""},{default:e(()=>[o(L,{location:"bottom"},{activator:e(({props:t})=>[o(N,D(t,{variant:"flat","append-icon":"mdi-chevron-down",size:"small"}),{default:e(()=>[p(g(f(s)("Actions")),1)]),_:2},1040)]),default:e(()=>[o(Z,{density:"compact"})]),_:1}),o(N,{variant:"text",icon:"mdi-reload",onClick:w}),o(I),o(ee,{modelValue:P.value,"onUpdate:modelValue":r[0]||(r[0]=t=>P.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:f(s)("Search"),"single-line":"",variant:"outlined","hide-details":""},null,8,["modelValue","placeholder"])]),_:1})]),"item.secured":e(({item:t})=>[t.secured===!0?(u(),k(E,{key:0,color:"green"},{default:e(()=>r[4]||(r[4]=[p(" mdi-lock ")])),_:1,__:[4]})):(u(),k(E,{key:1,color:"red"},{default:e(()=>r[5]||(r[5]=[p(" mdi-lock-off ")])),_:1,__:[5]}))]),"item.domains":e(({item:t})=>[t.domains.length>0?(u(),k(T,{key:0},{default:e(()=>[p(g(t.domains.length)+" associated domain(s) ",1)]),_:2},1024)):(u(),k(T,{key:1},{default:e(()=>r[6]||(r[6]=[p(" No associated domain ")])),_:1,__:[6]}))]),"expanded-item":e(({headers:t,item:_})=>[O("td",{colspan:t.length},[(u(!0),h(F,null,W(_.domains,(y,n)=>(u(),k(T,{key:n},{default:e(()=>[y.new_domain?(u(),h(F,{key:0},[p(g(y.name)+" --> "+g(y.new_domain.name),1)],64)):(u(),h(F,{key:1},[p(g(y.name)+" --> "+g(y.name),1)],64))]),_:2},1024))),128))],8,se)]),"item.actions":e(({item:t})=>[o(L,{"offset-y":""},{activator:e(({props:_})=>[o(N,D({icon:"mdi-dots-horizontal",variant:"text"},_),null,16)]),default:e(()=>[o(f(X),{items:S(),obj:t},null,8,["items","obj"])]),_:2},1024)]),_:2},1032,["modelValue","expanded","items","search","loading"])]),_:1}))}},ne={__name:"ProvidersView",setup(j){const{$gettext:s}=U(),d=x(!1);return(i,c)=>(u(),h("div",null,[o(z,{flat:""},{default:e(()=>[o(Y,null,{default:e(()=>[p(g(f(s)("Providers")),1)]),_:1}),o(I),o(N,{color:"primary",variant:"flat","prepend-icon":"mdi-plus",onClick:c[0]||(c[0]=v=>d.value=!0)},{default:e(()=>[p(g(f(s)("New")),1)]),_:1})]),_:1}),o(f(ie)),o(ae,{modelValue:d.value,"onUpdate:modelValue":c[2]||(c[2]=v=>d.value=v),fullscreen:"",scrollable:"",transition:"dialog-bottom-transition"},{default:e(()=>[o(f(re),{onClose:c[1]||(c[1]=v=>d.value=!1)})]),_:1},8,["modelValue"])]))}},ze=H(ne,[["__scopeId","data-v-1a3ee9c1"]]);export{ze as default};
