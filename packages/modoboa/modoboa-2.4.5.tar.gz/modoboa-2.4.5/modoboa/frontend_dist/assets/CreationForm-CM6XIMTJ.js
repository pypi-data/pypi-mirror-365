import{_ as me}from"./ConfirmDialog-C_e6hlR9.js";import{b as se,l as W,o as y,E as R,F as T,e as p,t as v,f as g,c as C,w as u,G as U,p as re,a as n,k as h,s as F,v as $,x as pe,h as S,C as ve,H as fe,I as P,R as ye,S as Ve,A as K,T as Se,U as oe,V as ke,W as Q,X as be,Y as _e,Z as ge,g as M,$ as he,a0 as xe,a1 as we}from"./index-BA5nENc7.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as j,V as ie}from"./VRow-CnohEaAX.js";import{V as A,h as ee,i as Ce,R as te,j as Pe,k as $e,d as Be,f as Ae,l as We,n as Te,o as je,p as Re}from"./VAvatar-BLlAVJo2.js";import{u as L}from"./tag-BQLfwzbO.js";import{V as ae,m as Fe,a as le,b as Le}from"./VWindowItem-D0hjETv2.js";import{V as Ee}from"./VContainer-CWsXUJRX.js";import{V as ne,m as De}from"./VSheet-CajYOL8i.js";import{c as Ne}from"./forwardRefs-DulMu961.js";const ze="/assets/Modoboa_RVB-BLEU-SANS-pKrnjsR_.png",Ge={class:"subtitle mt-4 d-flex"},Oe={class:"text-h6"},Me=["onClick"],Ue={class:"text-grey"},He={__name:"CreationSummary",props:{sections:{type:Array,default:()=>[]}},emits:["modify-step"],setup(e,{emit:f}){const{$gettext:t}=se(),a=f;function r(s){return s.length?s.join(", "):t("Empty")}return(s,c)=>(y(!0),W(T,null,R(e.sections,(d,m)=>(y(),W(T,{key:m},[p("div",Ge,[p("span",Oe,v(d.title),1),p("a",{href:"#",class:"edit-link ml-auto",onClick:l=>a("modify-step",m+1)},v(g(t)("Modify")),9,Me)]),(y(!0),W(T,null,R(d.items,(l,x)=>(y(),C(ie,{key:x,dense:""},{default:u(()=>[l.value!==void 0?U(s.$slots,`item.${l.name}`,{key:0,item:l,displayList:r},()=>[n(j,null,{default:u(()=>[p("span",Ue,v(l.key),1)]),_:2},1024),l.type==="yesno"?(y(),C(j,{key:0,class:"text-right"},{default:u(()=>[h(v(s.$yesno(l.value)),1)]),_:2},1024)):l.type==="list"?(y(),C(j,{key:1,class:"text-right"},{default:u(()=>[h(v(r(l.value)),1)]),_:2},1024)):(y(),C(j,{key:2,class:"text-right"},{default:u(()=>[h(v(l.value),1)]),_:2},1024))],!0):re("",!0)]),_:2},1024))),128))],64))),128))}},Ye=Ie(He,[["__scopeId","data-v-6e743e1a"]]),X=Symbol.for("vuetify:v-stepper"),ue=$({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),Ke=F()({name:"VStepperActions",props:ue(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(e,f){let{emit:t,slots:a}=f;const{t:r}=pe();function s(){t("click:prev")}function c(){t("click:next")}return L(()=>{const d={onClick:s},m={onClick:c};return p("div",{class:"v-stepper-actions"},[n(ee,{defaults:{VBtn:{disabled:["prev",!0].includes(e.disabled),text:r(e.prevText),variant:"text"}}},{default:()=>{var l;return[((l=a.prev)==null?void 0:l.call(a,{props:d}))??n(A,d,null)]}}),n(ee,{defaults:{VBtn:{color:e.color,disabled:["next",!0].includes(e.disabled),text:r(e.nextText),variant:"tonal"}}},{default:()=>{var l;return[((l=a.next)==null?void 0:l.call(a,{props:m}))??n(A,m,null)]}})])}),{}}}),ce=Ce("v-stepper-header"),Xe=$({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:P,default:"$complete"},editable:Boolean,editIcon:{type:P,default:"$edit"},error:Boolean,errorIcon:{type:P,default:"$error"},icon:P,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),Ze=$({...Xe(),...We()},"VStepperItem"),H=F()({name:"VStepperItem",directives:{vRipple:te},props:Ze(),emits:{"group:selected":e=>!0},setup(e,f){let{slots:t}=f;const a=Pe(e,X,!0),r=S(()=>(a==null?void 0:a.value.value)??e.value),s=S(()=>e.rules.every(I=>I()===!0)),c=S(()=>!e.disabled&&e.editable),d=S(()=>!e.disabled&&e.editable),m=S(()=>e.error||!s.value),l=S(()=>e.complete||e.rules.length>0&&s.value),x=S(()=>m.value?e.errorIcon:l.value?e.completeIcon:a.isSelected.value&&e.editable?e.editIcon:e.icon),w=S(()=>({canEdit:d.value,hasError:m.value,hasCompleted:l.value,title:e.title,subtitle:e.subtitle,step:r.value,value:e.value}));return L(()=>{var i,b,E;const I=(!a||a.isSelected.value||l.value||d.value)&&!m.value&&!e.disabled,V=!!(e.title!=null||t.title),k=!!(e.subtitle!=null||t.subtitle);function o(){a==null||a.toggle()}return ve(p("button",{class:fe(["v-stepper-item",{"v-stepper-item--complete":l.value,"v-stepper-item--disabled":e.disabled,"v-stepper-item--error":m.value},a==null?void 0:a.selectedClass.value]),disabled:!e.editable,type:"button",onClick:o},[c.value&&$e(!0,"v-stepper-item"),n(Ae,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:I?e.color:void 0,size:24},{default:()=>{var _;return[((_=t.icon)==null?void 0:_.call(t,w.value))??(x.value?n(Be,{icon:x.value},null):r.value)]}}),p("div",{class:"v-stepper-item__content"},[V&&p("div",{key:"title",class:"v-stepper-item__title"},[((i=t.title)==null?void 0:i.call(t,w.value))??e.title]),k&&p("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((b=t.subtitle)==null?void 0:b.call(t,w.value))??e.subtitle]),(E=t.default)==null?void 0:E.call(t,w.value)])]),[[te,e.ripple&&e.editable,null]])}),{}}}),qe=$({...Se(Fe(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),de=F()({name:"VStepperWindow",props:qe(),emits:{"update:modelValue":e=>!0},setup(e,f){let{slots:t}=f;const a=ye(X,null),r=Ve(e,"modelValue"),s=S({get(){var c;return r.value!=null||!a?r.value:(c=a.items.value.find(d=>a.selected.value.includes(d.id)))==null?void 0:c.value},set(c){r.value=c}});return L(()=>{const c=ae.filterProps(e);return n(ae,K({_as:"VStepperWindow"},c,{modelValue:s.value,"onUpdate:modelValue":d=>s.value=d,class:["v-stepper-window",e.class],style:e.style,mandatory:!1,touch:!1}),t)}),{}}}),Je=$({...Le()},"VStepperWindowItem"),Y=F()({name:"VStepperWindowItem",props:Je(),setup(e,f){let{slots:t}=f;return L(()=>{const a=le.filterProps(e);return n(le,K({_as:"VStepperWindowItem"},a,{class:["v-stepper-window-item",e.class],style:e.style}),t)}),{}}}),Qe=$({altLabels:Boolean,bgColor:String,completeIcon:P,editIcon:P,editable:Boolean,errorIcon:P,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...ge()},"Stepper"),et=$({...Qe(),...je({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...De(),..._e(ue(),["prevText","nextText"])},"VStepper"),tt=F()({name:"VStepper",props:et(),emits:{"update:modelValue":e=>!0},setup(e,f){let{slots:t}=f;const{items:a,next:r,prev:s,selected:c}=Te(e,X),{displayClasses:d,mobile:m}=oe(e),{completeIcon:l,editIcon:x,errorIcon:w,color:I,editable:V,prevText:k,nextText:o}=ke(e),i=S(()=>e.items.map((_,z)=>{const D=Q(_,e.itemTitle,_),G=Q(_,e.itemValue,z+1);return{title:D,value:G,raw:_}})),b=S(()=>a.value.findIndex(_=>c.value.includes(_.id))),E=S(()=>e.disabled?e.disabled:b.value===0?"prev":b.value===a.value.length-1?"next":!1);return be({VStepperItem:{editable:V,errorIcon:w,completeIcon:l,editIcon:x,prevText:k,nextText:o},VStepperActions:{color:I,disabled:E,prevText:k,nextText:o}}),L(()=>{const _=ne.filterProps(e),z=!!(t.header||e.items.length),D=e.items.length>0,G=!e.hideActions&&!!(D||t.actions);return n(ne,K(_,{color:e.bgColor,class:["v-stepper",{"v-stepper--alt-labels":e.altLabels,"v-stepper--flat":e.flat,"v-stepper--non-linear":e.nonLinear,"v-stepper--mobile":m.value},d.value,e.class],style:e.style}),{default:()=>{var Z,q;return[z&&n(ce,{key:"stepper-header"},{default:()=>[i.value.map((B,N)=>{let{raw:O,...J}=B;return p(T,null,[!!N&&n(Ne,null,null),n(H,J,{default:t[`header-item.${J.value}`]??t.header,icon:t.icon,title:t.title,subtitle:t.subtitle})])})]}),D&&n(de,{key:"stepper-window"},{default:()=>[i.value.map(B=>n(Y,{value:B.value},{default:()=>{var N,O;return((N=t[`item.${B.value}`])==null?void 0:N.call(t,B))??((O=t.item)==null?void 0:O.call(t,B))}}))]}),(Z=t.default)==null?void 0:Z.call(t,{prev:s,next:r}),G&&(((q=t.actions)==null?void 0:q.call(t,{next:r,prev:s}))??n(Ke,{key:"stepper-actions","onClick:prev":s,"onClick:next":r},t))]}})}),{prev:s,next:r}}}),at={class:"d-flex justify-center inner fill-height"},lt={class:"mb-5 text-h5"},nt={class:"text-grey-darken-1"},st={class:"d-flex justify-end mt-4"},rt={class:"text-center text-h3"},ot={class:"d-flex justify-center mt-8"},St={__name:"CreationForm",props:{title:{type:String,default:""},steps:{type:Array,default:()=>[]},summarySections:{type:Array,default:()=>[]},getVFormRef:{type:Function,default:null},formGetter:{type:Function,default:null},validateObject:{type:Function,default:null}},emits:["close","create","validationError"],setup(e,{expose:f,emit:t}){const{smAndDown:a}=oe(),r=e,s=M(1),c=M(!1),d=M(),m=t,{$gettext:l}=se();async function x(){await d.value.open(l("Warning"),l("If you close this form now, your modifications won't be saved. Do you confirm?"),{color:"warning",agreeLabel:l("Yes"),cancelLabel:l("No")})&&m("close")}async function w(V,k){const o=r.getVFormRef(r.steps[V-1]);if(o!==void 0){const{valid:i}=await o.validate();if(!i)return;if(r.validateObject)try{await r.validateObject(V)}catch(b){m("validationError",V,b.response.data);return}}s.value=k}function I(){c.value=!0,m("create")}return f({working:c}),(V,k)=>(y(),W("div",at,[n(tt,{modelValue:s.value,"onUpdate:modelValue":k[1]||(k[1]=o=>s.value=o),mobile:!g(a)},{default:u(()=>[n(g(me),{ref_key:"confirm",ref:d},null,512),n(ce,{class:"align-center px-10"},{default:u(()=>[n(Re,{src:ze,"max-width":"190",class:"hidden-sm-and-down"}),(y(!0),W(T,null,R(e.steps,(o,i)=>(y(),C(H,{key:o.name,color:"primary",value:i+1,complete:s.value>i+1},{default:u(()=>[h(v(o.title),1)]),_:2},1032,["value","complete"]))),128)),n(H,{value:e.steps.length+1},{default:u(()=>[h(v(g(l)("Summary")),1)]),_:1},8,["value"]),n(A,{icon:"mdi-close",color:"primary",size:g(a)?"small":"x-large",variant:"text",onClick:x},null,8,["size"])]),_:1}),n(de,{class:"mt-4 d-flex justify-center"},{default:u(()=>[(y(!0),W(T,null,R(e.steps,(o,i)=>(y(),C(Y,{key:o.name,value:i+1,class:"flex-grow-1 ma-10"},{default:u(()=>[n(Ee,{fluid:""},{default:u(()=>[n(ie,{align:"center",justify:"center"},{default:u(()=>[n(j,{cols:"8",align:"start"},{default:u(()=>[p("div",lt,[p("span",nt,v(e.title),1),h(" / "+v(o.title),1)]),U(V.$slots,`form.${o.name}`,{step:o,currentStep:i+1})]),_:2},1024)]),_:2},1024)]),_:2},1024),p("div",st,[i+1>1?(y(),C(A,{key:0,class:"mr-10",variant:"text",onClick:b=>s.value=i},{default:u(()=>[h(v(g(l)("Back")),1)]),_:2},1032,["onClick"])):re("",!0),n(A,{color:"primary",size:"large",onClick:b=>w(i+1,i+2)},{default:u(()=>[h(v(g(l)("Next")),1)]),_:2},1032,["onClick"])])]),_:2},1032,["value"]))),128)),n(Y,{value:e.steps.length+1,class:"flex-grow-0"},{default:u(()=>[p("div",rt,v(g(l)("Summary")),1),n(Ye,{sections:e.summarySections,onModifyStep:k[0]||(k[0]=o=>s.value=o)},he({_:2},[R(V.$slots,(o,i)=>({name:i,fn:u(b=>[U(V.$slots,i,xe(we(b)))])}))]),1032,["sections"]),p("div",ot,[n(A,{color:"primary",size:"large",loading:c.value,onClick:I},{default:u(()=>[h(v(g(l)("Confirm and create")),1)]),_:1},8,["loading"])])]),_:3},8,["value"])]),_:3})]),_:3},8,["modelValue","mobile"])]))}};export{St as _};
