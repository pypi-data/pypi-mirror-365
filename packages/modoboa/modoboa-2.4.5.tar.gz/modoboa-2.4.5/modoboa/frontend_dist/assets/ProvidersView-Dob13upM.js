import{b as U,m as M,h as N,g as x,c as k,o as u,w as e,a as o,f,A as E,e as q,l as h,E as O,F as B,k as p,t as g,q as W}from"./index-BA5nENc7.js";import{_ as H}from"./CreationForm-CM6XIMTJ.js";import{u as z,_ as J,a as K}from"./ProviderGeneralForm-B3DP3kaS.js";import{_ as Q}from"./MenuItems-Cuf8-V0W.js";import{V as L}from"./VMenu-ds-uYle9.js";import{V as A,d as j}from"./VAvatar-BLlAVJo2.js";import{V as T}from"./VChip-DtLoN5pb.js";import{V as G,a as X}from"./VToolbar-J3yNZ_TP.js";import{V as Y}from"./forwardRefs-DulMu961.js";import{V as I}from"./VSpacer-DL_DqXyB.js";import{V as Z}from"./VTextField-4NZ7IznA.js";import{V as ee}from"./VDataTable-C75c5ugx.js";import{b as oe}from"./VCard-CgG7Sw1Z.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ae}from"./VDialog-BZ4gm6K7.js";import"./ConfirmDialog-C_e6hlR9.js";import"./VRow-CnohEaAX.js";/* empty css              */import"./tag-BQLfwzbO.js";import"./VWindowItem-D0hjETv2.js";import"./ssrBoot-CTcujE2n.js";import"./VContainer-CWsXUJRX.js";import"./VSheet-CajYOL8i.js";import"./VProgressCircular--49P1TOW.js";import"./domains-BKPjvqA_.js";import"./VAutocomplete-QADGK4Mr.js";import"./VSelect-BiP6crf0.js";import"./VCheckboxBtn-Bxy-LfII.js";import"./VSelectionControl-CCdZN5dG.js";import"./filter-C-VZW-D6.js";import"./VForm-B967suxO.js";import"./VSwitch-PAZTCa-8.js";import"./VTable-Dtu3KidF.js";const re={__name:"ProviderCreationForm",emits:["close"],setup(D,{emit:s}){const d=s,{$gettext:i}=U(),c=M(),v=z(),F=N(()=>{const n=[];let l=!0;for(const V of a.value.domains){const R=V.new_domain?`${V.name} => ${V.new_domain.name}`:`${V.name} ${i("(the domain will be created locally)")}`;n.push({key:l?i("Associated domain"):"",value:R}),l=!1}return n}),b=N(()=>[{title:i("General"),items:[{key:i("Name"),value:a.value.name},{key:i("Address"),value:a.value.address},{key:i("Port"),value:a.value.port},{key:i("Secured"),value:a.value.secured,type:"yesno"}]},{title:i("Associated domains"),items:F.value}]),P=[{name:"general",title:i("General")},{name:"associated",title:i("Associated domains")}],a=x({domains:[]}),$=x(),C=x(),S={general:$,associated:C};w();function w(){a.value={name:"",address:"",port:993,secured:!0,domains:[]}}function m(){w(),d("close")}function r(n){return S.value[n.name]}function t(n){return console.log(a.value),S[n.name].value.vFormRef}function _(){}function y(){const n={...a.value};n.domains=[];for(const l of a.value.domains)l.new_domain?n.domains.push({name:l.name,new_domain:l.new_domain.pk}):n.domains.push(l);v.createProvider(n).then(()=>{c.displayNotification({msg:i("Provider created")}),m()})}return(n,l)=>(u(),k(f(H),{ref:"form",title:f(i)("New provider"),steps:P,"form-getter":r,"get-v-form-ref":t,"validate-object":_,"summary-sections":b.value,onClose:m,onCreate:y},{"form.general":e(()=>[o(K,{ref_key:"general",ref:$,modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=V=>a.value=V),class:"ml-4"},null,8,["modelValue"])]),"form.associated":e(()=>[o(J,{ref_key:"associated",ref:C,modelValue:a.value.domains,"onUpdate:modelValue":l[1]||(l[1]=V=>a.value.domains=V)},null,8,["modelValue"])]),_:2},1032,["title","summary-sections"]))}},se=["colspan"],ie={__name:"ProvidersList",setup(D){const{$gettext:s}=U(),d=z(),i=W(),c=N(()=>d.providers),v=N(()=>d.providersLoaded),F=[{title:s("Name"),key:"name"},{title:s("Address"),key:"address"},{title:s("Port"),key:"port"},{title:s("Secured"),key:"secured"},{title:s("Associated domains"),key:"domains"},{title:s("Actions"),key:"actions",sortable:!1,align:"right"}],b=x([]),P=x(""),a=x([]);function $(m){d.deleteProvider(m.id)}function C(m){i.push({name:"ProviderEdit",params:{id:m.id}})}function S(){const m=[];return m.push({label:s("Delete"),icon:"mdi-delete-outline",onClick:$,color:"red"}),m.push({label:s("Edit"),icon:"mdi-circle-edit-outline",onClick:C}),m}function w(){d.getProviders()}return v.value||w(),(m,r)=>(u(),k(oe,{class:"mt-6"},{default:e(()=>[o(ee,{modelValue:b.value,"onUpdate:modelValue":r[1]||(r[1]=t=>b.value=t),expanded:a.value,"onUpdate:expanded":r[2]||(r[2]=t=>a.value=t),headers:F,items:Object.values(c.value),search:P.value,loading:!v.value,"item-value":"name","single-expand":"","show-select":"","onClick:row":r[3]||(r[3]=(t,_)=>_.expand(!_.isExpanded))},{top:e(()=>[o(G,{color:"white",flat:""},{default:e(()=>[o(L,{location:"bottom"},{activator:e(({props:t})=>[o(A,E(t,{variant:"flat","append-icon":"mdi-chevron-down",size:"small"}),{default:e(()=>[p(g(f(s)("Actions")),1)]),_:2},1040)]),default:e(()=>[o(Y,{density:"compact"})]),_:1}),o(A,{variant:"text",icon:"mdi-reload",onClick:w}),o(I),o(Z,{modelValue:P.value,"onUpdate:modelValue":r[0]||(r[0]=t=>P.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:f(s)("Search"),"single-line":"",variant:"outlined","hide-details":""},null,8,["modelValue","placeholder"])]),_:1})]),"item.secured":e(({item:t})=>[t.secured===!0?(u(),k(j,{key:0,color:"green"},{default:e(()=>r[4]||(r[4]=[p(" mdi-lock ")])),_:1,__:[4]})):(u(),k(j,{key:1,color:"red"},{default:e(()=>r[5]||(r[5]=[p(" mdi-lock-off ")])),_:1,__:[5]}))]),"item.domains":e(({item:t})=>[t.domains.length>0?(u(),k(T,{key:0},{default:e(()=>[p(g(t.domains.length)+" associated domain(s) ",1)]),_:2},1024)):(u(),k(T,{key:1},{default:e(()=>r[6]||(r[6]=[p(" No associated domain ")])),_:1,__:[6]}))]),"expanded-item":e(({headers:t,item:_})=>[q("td",{colspan:t.length},[(u(!0),h(B,null,O(_.domains,(y,n)=>(u(),k(T,{key:n},{default:e(()=>[y.new_domain?(u(),h(B,{key:0},[p(g(y.name)+" --> "+g(y.new_domain.name),1)],64)):(u(),h(B,{key:1},[p(g(y.name)+" --> "+g(y.name),1)],64))]),_:2},1024))),128))],8,se)]),"item.actions":e(({item:t})=>[o(L,{"offset-y":""},{activator:e(({props:_})=>[o(A,E({icon:"mdi-dots-horizontal",variant:"text"},_),null,16)]),default:e(()=>[o(f(Q),{items:S(),obj:t},null,8,["items","obj"])]),_:2},1024)]),_:2},1032,["modelValue","expanded","items","search","loading"])]),_:1}))}},ne={__name:"ProvidersView",setup(D){const{$gettext:s}=U(),d=x(!1);return(i,c)=>(u(),h("div",null,[o(G,{flat:""},{default:e(()=>[o(X,null,{default:e(()=>[p(g(f(s)("Providers")),1)]),_:1}),o(I),o(A,{color:"primary",variant:"flat","prepend-icon":"mdi-plus",onClick:c[0]||(c[0]=v=>d.value=!0)},{default:e(()=>[p(g(f(s)("New")),1)]),_:1})]),_:1}),o(f(ie)),o(ae,{modelValue:d.value,"onUpdate:modelValue":c[2]||(c[2]=v=>d.value=v),fullscreen:"",scrollable:"",transition:"dialog-bottom-transition"},{default:e(()=>[o(f(re),{onClose:c[1]||(c[1]=v=>d.value=!1)})]),_:1},8,["modelValue"])]))}},Ie=te(ne,[["__scopeId","data-v-1a3ee9c1"]]);export{Ie as default};
