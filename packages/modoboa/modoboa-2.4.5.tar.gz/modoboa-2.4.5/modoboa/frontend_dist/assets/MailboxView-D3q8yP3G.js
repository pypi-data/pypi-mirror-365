import{s as te,v as le,ap as se,x as oe,h as O,a9 as ne,e as d,A as ie,B as re,H as X,b as ue,m as de,g as b,L as ce,d as me,a2 as ve,K as P,l as _,a as s,c as v,w as h,p as M,ba as pe,f,t as m,F as U,E as ge,q as fe,o as r}from"./index-BA5nENc7.js";import{a as x}from"./webmail-Cgnpe0EQ.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as be}from"./VToolbar-J3yNZ_TP.js";import{V as j}from"./VCheckbox-DPPPkFg8.js";import{V as he}from"./VTextField-4NZ7IznA.js";import{r as xe,s as ye,V as y,d as A}from"./VAvatar-BLlAVJo2.js";import{V as _e}from"./VMenu-ds-uYle9.js";import{V as Ve,a as $}from"./forwardRefs-DulMu961.js";import{V as q}from"./VSpacer-DL_DqXyB.js";import{b as R,V as Ce}from"./VCard-CgG7Sw1Z.js";import{u as we}from"./VProgressCircular--49P1TOW.js";import{b as Se,u as Be,c as Me}from"./tag-BQLfwzbO.js";import{V as $e}from"./VAlert-DMLG8wNi.js";import"./VCheckboxBtn-Bxy-LfII.js";import"./VSelectionControl-CCdZN5dG.js";import"./ssrBoot-CTcujE2n.js";/* empty css              */const Le={actions:"button@2",article:"heading, paragraph",avatar:"avatar",button:"button",card:"image, heading","card-avatar":"image, list-item-avatar",chip:"chip","date-picker":"list-item, heading, divider, date-picker-options, date-picker-days, actions","date-picker-options":"text, avatar@2","date-picker-days":"avatar@28",divider:"divider",heading:"heading",image:"image","list-item":"text","list-item-avatar":"avatar, text","list-item-two-line":"sentences","list-item-avatar-two-line":"avatar, sentences","list-item-three-line":"paragraph","list-item-avatar-three-line":"avatar, paragraph",ossein:"ossein",paragraph:"text@3",sentences:"text@2",subtitle:"text",table:"table-heading, table-thead, table-tbody, table-tfoot","table-heading":"chip, text","table-thead":"heading@6","table-tbody":"table-row-divider@6","table-row-divider":"table-row, divider","table-row":"text@6","table-tfoot":"text@2, avatar@2",text:"text"};function Ae(a){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return d("div",{class:X(["v-skeleton-loader__bone",`v-skeleton-loader__${a}`])},[o])}function D(a){const[o,e]=a.split("@");return Array.from({length:e}).map(()=>E(o))}function E(a){let o=[];if(!a)return o;const e=Le[a];if(a!==e){if(a.includes(","))return K(a);if(a.includes("@"))return D(a);e.includes(",")?o=K(e):e.includes("@")?o=D(e):e&&o.push(E(e))}return[Ae(a,o)]}function K(a){return a.replace(/\s/g,"").split(",").map(E)}const Ee=le({boilerplate:Boolean,color:String,loading:Boolean,loadingText:{type:String,default:"$vuetify.loading"},type:{type:[String,Array],default:"ossein"},...Me(),...ye(),...re()},"VSkeletonLoader"),Ie=te()({name:"VSkeletonLoader",props:Ee(),setup(a,o){let{slots:e}=o;const{backgroundColorClasses:V,backgroundColorStyles:B}=we(()=>a.color),{dimensionStyles:I}=Se(a),{elevationClasses:N}=xe(a),{themeClasses:p}=se(a),{t:i}=oe(),C=O(()=>E(ne(a.type).join(",")));return Be(()=>{var n;const g=!e.default||a.loading,w=a.boilerplate||!g?{}:{ariaLive:"polite",ariaLabel:i(a.loadingText),role:"alert"};return d("div",ie({class:["v-skeleton-loader",{"v-skeleton-loader--boilerplate":a.boilerplate},p.value,V.value,N.value],style:[B.value,g?I.value:{}]},w),[g?C.value:(n=e.default)==null?void 0:n.call(e)])}),{}}}),Ne={key:2,class:"d-flex align-center"},ze={class:"text-caption mr-2"},Te={key:1,class:"emails position-absolute top-0 bottom-0 w-100 overflow-y-auto"},Pe=["onClick"],Fe={class:"mt-1 text-grey"},Je=["title"],Ue={key:1},je={class:"text-right"},qe={class:"mt-1"},Re={class:"text-grey"},De={__name:"EmailList",props:{mailbox:{type:String,default:"INBOX"}},setup(a){const o=a,{$gettext:e}=ue(),{displayNotification:V,reloadMailboxCounters:B}=de(),I=fe(),N=ce(),p=b(!1),i=b({}),C=b(1),g=b(""),w=b(!1),n=b([]),c=b(!1);let F=null;const S=O(()=>N.query.mailbox||"INBOX"),G=u=>{I.push({name:"EmailView",query:{mailbox:o.mailbox,mailid:u}})},k=()=>{i.value={},p.value=!0,x.getMailboxEmails(o.mailbox,{page:C.value,search:g.value}).then(u=>{i.value=u.data,p.value=!1}).catch(()=>{p.value=!1})},z=()=>{k()},H=()=>{g.value&&k()},W=u=>{u?n.value=i.value.results.map(t=>t.imapid):n.value=[]},Q=()=>{n.value.length&&(c.value=!0,x.deleteSelection(S.value,n.value).then(()=>{c.value=!1,V({msg:e("Message(s) deleted")}),k(),B()}))},Y=()=>{n.value.length&&(c.value=!0,x.markSelectionAsJunk(S.value,n.value).then(()=>{c.value=!1,V({msg:e("Message(s) marked as junk")}),z()}))},Z=()=>{n.value.length&&(c.value=!0,x.markSelectionAsNotJunk(S.value,n.value).then(()=>{c.value=!1,V({msg:e("Message(s) marked as not junk")}),z()}))},L=u=>{n.value.length&&(c.value=!0,x.flagSelection(S.value,n.value,u).then(()=>{c.value=!1,n.value=[],V({msg:e("Message(s) flagged")}),k(),B()}))},ee=()=>{p.value=!0,x.emptyUserMailbox(S.value).then(()=>{i.value={},p.value=!1,B()})},ae=async u=>{const t=u.flagged?"unflagged":"flagged";await x.flagSelection(S.value,[u.imapid],t),u.flagged=t==="flagged"};return me(()=>{F=setInterval(z,300*1e3)}),ve(()=>{clearInterval(F)}),P(()=>o.mailbox,()=>{k()},{immediate:!0}),P(n,()=>{n.value.length?w.value=!0:w.value=!1}),P(C,()=>{k()}),(u,t)=>{var J;return r(),_(U,null,[s(R,{class:"mt-6 mb-2 mx-1"},{default:h(()=>[s(be,{color:"white",flat:""},{default:h(()=>[s(j,{modelValue:w.value,"onUpdate:modelValue":[t[0]||(t[0]=l=>w.value=l),W],class:"mr-4","hide-details":""},null,8,["modelValue"]),s(he,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=l=>g.value=l),"prepend-inner-icon":"mdi-magnify",placeholder:f(e)("Search in messages"),variant:"outlined","single-line":"",flat:"","hide-details":"",density:"compact",class:"flex-grow-0 w-33 mr-4",clearable:"","onClick:clear":k,onKeyup:pe(H,["enter"])},null,8,["modelValue","placeholder"]),s(y,{class:"ml-2",color:"error",variant:"tonal",icon:"mdi-trash-can",size:"small",loading:c.value,onClick:Q},null,8,["loading"]),u.$route.params.mailbox!=="Junk"?(r(),v(y,{key:0,class:"ml-2",color:"warning",variant:"tonal",icon:"mdi-fire",size:"small",loading:c.value,onClick:Y},null,8,["loading"])):(r(),v(y,{key:1,class:"ml-2",color:"success",variant:"tonal",icon:"mdi-thumb-up",size:"small",loading:c.value,onClick:Z},null,8,["loading"])),s(y,{class:"ml-2",variant:"tonal",icon:"",size:"small"},{default:h(()=>[s(A,{icon:"mdi-cog"}),s(_e,{activator:"parent"},{default:h(()=>[s(Ve,{density:"compact"},{default:h(()=>[s($,{title:f(e)("Mark as read"),"prepend-icon":"mdi-eye",onClick:t[2]||(t[2]=()=>L("read"))},null,8,["title"]),s($,{title:f(e)("Mark as unread"),"prepend-icon":"mdi-eye-outline",onClick:t[3]||(t[3]=()=>L("unread"))},null,8,["title"]),s($,{title:f(e)("Mark as followed"),"prepend-icon":"mdi-star",onClick:t[4]||(t[4]=()=>L("flagged"))},null,8,["title"]),s($,{title:f(e)("Mark as unfollowed"),"prepend-icon":"mdi-star-outline",onClick:t[5]||(t[5]=()=>L("unflagged"))},null,8,["title"]),u.$route.params.mailbox!=="Trash"?(r(),v($,{key:0,title:f(e)("Empty mailbox"),"prepend-icon":"mdi-trash-can",onClick:ee},null,8,["title"])):M("",!0)]),_:1})]),_:1})]),_:1}),s(q),i.value.results?(r(),_("div",Ne,[d("div",ze,m(i.value.first_index)+"-"+m(i.value.last_index)+" "+m(f(e)("on"))+" "+m(i.value.count),1),d("div",null,[s(y,{icon:"mdi-chevron-left",size:"x-small",disabled:i.value.prev_page===null,onClick:t[6]||(t[6]=l=>C.value=i.value.prev_page)},null,8,["disabled"]),s(y,{icon:"mdi-chevron-right",size:"x-small",disabled:i.value.next_page===null,onClick:t[7]||(t[7]=l=>C.value=i.value.next_page)},null,8,["disabled"])])])):M("",!0)]),_:1})]),_:1}),p.value?(r(),v(Ie,{key:0,type:"card@2"})):(r(),_("div",Te,[(J=i.value.results)!=null&&J.length?(r(!0),_(U,{key:0},ge(i.value.results,l=>(r(),v(R,{key:l.imapid,density:"compact",class:"mb-2 mx-1"},{default:h(()=>[s(Ce,{class:X(["d-flex align-center",{"font-weight-bold":l.style==="unseen"}])},{default:h(()=>[s(j,{modelValue:n.value,"onUpdate:modelValue":t[8]||(t[8]=T=>n.value=T),value:l.imapid,"hide-details":""},null,8,["modelValue","value"]),s(y,{icon:l.flagged?"mdi-star":"mdi-star-outline",variant:"flat",onClick:T=>ae(l)},null,8,["icon","onClick"]),d("div",{class:"ml-4 clickable",onClick:T=>G(l.imapid)},[d("div",null,m(l.subject),1),d("div",Fe,[l.from_address.name?(r(),_("span",{key:0,title:l.from_address.address},m(l.from_address.name),9,Je)):(r(),_("span",Ue,m(l.from_address.address),1))])],8,Pe),s(q),d("div",je,[d("div",null,m(l.date),1),d("div",qe,[l.answered?(r(),v(A,{key:0,icon:"mdi-reply-outline"})):M("",!0),l.forwarded?(r(),v(A,{key:1,icon:"mdi-share-outline"})):M("",!0),l.attachments?(r(),v(A,{key:2,icon:"mdi-paperclip"})):M("",!0),d("span",Re,m(u.$filesize(l.size)),1)])])]),_:2},1032,["class"])]),_:2},1024))),128)):(r(),v($e,{key:1,class:"mt-4",type:"info",text:f(e)("No message yet in this mailbox"),variant:"tonal"},null,8,["text"]))]))],64)}}},Ke=ke(De,[["__scopeId","data-v-0050ed0f"]]),Oe={class:"position-relative h-100"},Xe={class:"text-h5 ml-4"},ma={__name:"MailboxView",setup(a){return(o,e)=>(r(),_("div",Oe,[d("div",Xe,m(o.$gettext("Webmail")),1),s(Ke,{mailbox:o.$route.query.mailbox||"INBOX"},null,8,["mailbox"])]))}};export{ma as default};
