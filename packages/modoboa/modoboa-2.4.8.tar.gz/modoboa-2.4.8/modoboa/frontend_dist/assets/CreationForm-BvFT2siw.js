import{_ as me}from"./ConfirmDialog-DpaDmFAr.js";import{j as pe,b as se,m as W,o as y,G as F,F as j,e as p,t as v,f as g,c as C,w as u,H as U,q as re,a as n,l as h,v as L,x as $,y as ve,h as S,D as fe,J as ye,I as P,S as Ve,T as Se,B as q,U as be,V as oe,W as ke,X as Q,Y as _e,Z as ge,$ as he,g as M,a0 as xe,a1 as we,a2 as Ie}from"./index-BQtPj9kp.js";import{a as T,V as ie}from"./VRow-Feh4EzZW.js";import{V as A,h as ee,i as Ce,R as te,j as Pe,k as $e,d as Be,f as Ae,l as We,n as je,o as Te,p as Fe}from"./VAvatar-BlQCGAjd.js";import{u as R}from"./tag-DczKoIjT.js";import{V as ae,m as Le,a as le,b as Re}from"./VWindowItem-ZP4a7tq_.js";import{V as De}from"./VContainer-CFkETYWT.js";import{V as ne,m as Ee}from"./VSheet-DHWcony1.js";import{c as Ne}from"./forwardRefs-BySF_L7N.js";const ze="/assets/Modoboa_RVB-BLEU-SANS-pKrnjsR_.png",Ge={class:"subtitle mt-4 d-flex"},Oe={class:"text-h6"},Me=["onClick"],Ue={class:"text-grey"},He={__name:"CreationSummary",props:{sections:{type:Array,default:()=>[]}},emits:["modify-step"],setup(e,{emit:f}){const{$gettext:t}=se(),a=f;function r(s){return s.length?s.join(", "):t("Empty")}return(s,c)=>(y(!0),W(j,null,F(e.sections,(d,m)=>(y(),W(j,{key:m},[p("div",Ge,[p("span",Oe,v(d.title),1),p("a",{href:"#",class:"edit-link ml-auto",onClick:l=>a("modify-step",m+1)},v(g(t)("Modify")),9,Me)]),(y(!0),W(j,null,F(d.items,(l,x)=>(y(),C(ie,{key:x,dense:""},{default:u(()=>[l.value!==void 0?U(s.$slots,`item.${l.name}`,{key:0,item:l,displayList:r},()=>[n(T,null,{default:u(()=>[p("span",Ue,v(l.key),1)]),_:2},1024),l.type==="yesno"?(y(),C(T,{key:0,class:"text-right"},{default:u(()=>[h(v(s.$yesno(l.value)),1)]),_:2},1024)):l.type==="list"?(y(),C(T,{key:1,class:"text-right"},{default:u(()=>[h(v(r(l.value)),1)]),_:2},1024)):(y(),C(T,{key:2,class:"text-right"},{default:u(()=>[h(v(l.value),1)]),_:2},1024))],!0):re("",!0)]),_:2},1024))),128))],64))),128))}},Ye=pe(He,[["__scopeId","data-v-6e743e1a"]]),J=Symbol.for("vuetify:v-stepper"),ue=$({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),qe=L()({name:"VStepperActions",props:ue(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(e,f){let{emit:t,slots:a}=f;const{t:r}=ve();function s(){t("click:prev")}function c(){t("click:next")}return R(()=>{const d={onClick:s},m={onClick:c};return p("div",{class:"v-stepper-actions"},[n(ee,{defaults:{VBtn:{disabled:["prev",!0].includes(e.disabled),text:r(e.prevText),variant:"text"}}},{default:()=>{var l;return[((l=a.prev)==null?void 0:l.call(a,{props:d}))??n(A,d,null)]}}),n(ee,{defaults:{VBtn:{color:e.color,disabled:["next",!0].includes(e.disabled),text:r(e.nextText),variant:"tonal"}}},{default:()=>{var l;return[((l=a.next)==null?void 0:l.call(a,{props:m}))??n(A,m,null)]}})])}),{}}}),ce=Ce("v-stepper-header"),Je=$({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:P,default:"$complete"},editable:Boolean,editIcon:{type:P,default:"$edit"},error:Boolean,errorIcon:{type:P,default:"$error"},icon:P,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),Ke=$({...Je(),...We()},"VStepperItem"),H=L()({name:"VStepperItem",directives:{vRipple:te},props:Ke(),emits:{"group:selected":e=>!0},setup(e,f){let{slots:t}=f;const a=Pe(e,J,!0),r=S(()=>(a==null?void 0:a.value.value)??e.value),s=S(()=>e.rules.every(I=>I()===!0)),c=S(()=>!e.disabled&&e.editable),d=S(()=>!e.disabled&&e.editable),m=S(()=>e.error||!s.value),l=S(()=>e.complete||e.rules.length>0&&s.value),x=S(()=>m.value?e.errorIcon:l.value?e.completeIcon:a.isSelected.value&&e.editable?e.editIcon:e.icon),w=S(()=>({canEdit:d.value,hasError:m.value,hasCompleted:l.value,title:e.title,subtitle:e.subtitle,step:r.value,value:e.value}));return R(()=>{var i,k,D;const I=(!a||a.isSelected.value||l.value||d.value)&&!m.value&&!e.disabled,V=!!(e.title!=null||t.title),b=!!(e.subtitle!=null||t.subtitle);function o(){a==null||a.toggle()}return fe(p("button",{class:ye(["v-stepper-item",{"v-stepper-item--complete":l.value,"v-stepper-item--disabled":e.disabled,"v-stepper-item--error":m.value},a==null?void 0:a.selectedClass.value]),disabled:!e.editable,type:"button",onClick:o},[c.value&&$e(!0,"v-stepper-item"),n(Ae,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:I?e.color:void 0,size:24},{default:()=>{var _;return[((_=t.icon)==null?void 0:_.call(t,w.value))??(x.value?n(Be,{icon:x.value},null):r.value)]}}),p("div",{class:"v-stepper-item__content"},[V&&p("div",{key:"title",class:"v-stepper-item__title"},[((i=t.title)==null?void 0:i.call(t,w.value))??e.title]),b&&p("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((k=t.subtitle)==null?void 0:k.call(t,w.value))??e.subtitle]),(D=t.default)==null?void 0:D.call(t,w.value)])]),[[te,e.ripple&&e.editable,null]])}),{}}}),Xe=$({...be(Le(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),de=L()({name:"VStepperWindow",props:Xe(),emits:{"update:modelValue":e=>!0},setup(e,f){let{slots:t}=f;const a=Ve(J,null),r=Se(e,"modelValue"),s=S({get(){var c;return r.value!=null||!a?r.value:(c=a.items.value.find(d=>a.selected.value.includes(d.id)))==null?void 0:c.value},set(c){r.value=c}});return R(()=>{const c=ae.filterProps(e);return n(ae,q({_as:"VStepperWindow"},c,{modelValue:s.value,"onUpdate:modelValue":d=>s.value=d,class:["v-stepper-window",e.class],style:e.style,mandatory:!1,touch:!1}),t)}),{}}}),Ze=$({...Re()},"VStepperWindowItem"),Y=L()({name:"VStepperWindowItem",props:Ze(),setup(e,f){let{slots:t}=f;return R(()=>{const a=le.filterProps(e);return n(le,q({_as:"VStepperWindowItem"},a,{class:["v-stepper-window-item",e.class],style:e.style}),t)}),{}}}),Qe=$({altLabels:Boolean,bgColor:String,completeIcon:P,editIcon:P,editable:Boolean,errorIcon:P,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...he()},"Stepper"),et=$({...Qe(),...Te({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...Ee(),...ge(ue(),["prevText","nextText"])},"VStepper"),tt=L()({name:"VStepper",props:et(),emits:{"update:modelValue":e=>!0},setup(e,f){let{slots:t}=f;const{items:a,next:r,prev:s,selected:c}=je(e,J),{displayClasses:d,mobile:m}=oe(e),{completeIcon:l,editIcon:x,errorIcon:w,color:I,editable:V,prevText:b,nextText:o}=ke(e),i=S(()=>e.items.map((_,z)=>{const E=Q(_,e.itemTitle,_),G=Q(_,e.itemValue,z+1);return{title:E,value:G,raw:_}})),k=S(()=>a.value.findIndex(_=>c.value.includes(_.id))),D=S(()=>e.disabled?e.disabled:k.value===0?"prev":k.value===a.value.length-1?"next":!1);return _e({VStepperItem:{editable:V,errorIcon:w,completeIcon:l,editIcon:x,prevText:b,nextText:o},VStepperActions:{color:I,disabled:D,prevText:b,nextText:o}}),R(()=>{const _=ne.filterProps(e),z=!!(t.header||e.items.length),E=e.items.length>0,G=!e.hideActions&&!!(E||t.actions);return n(ne,q(_,{color:e.bgColor,class:["v-stepper",{"v-stepper--alt-labels":e.altLabels,"v-stepper--flat":e.flat,"v-stepper--non-linear":e.nonLinear,"v-stepper--mobile":m.value},d.value,e.class],style:e.style}),{default:()=>{var K,X;return[z&&n(ce,{key:"stepper-header"},{default:()=>[i.value.map((B,N)=>{let{raw:O,...Z}=B;return p(j,null,[!!N&&n(Ne,null,null),n(H,Z,{default:t[`header-item.${Z.value}`]??t.header,icon:t.icon,title:t.title,subtitle:t.subtitle})])})]}),E&&n(de,{key:"stepper-window"},{default:()=>[i.value.map(B=>n(Y,{value:B.value},{default:()=>{var N,O;return((N=t[`item.${B.value}`])==null?void 0:N.call(t,B))??((O=t.item)==null?void 0:O.call(t,B))}}))]}),(K=t.default)==null?void 0:K.call(t,{prev:s,next:r}),G&&(((X=t.actions)==null?void 0:X.call(t,{next:r,prev:s}))??n(qe,{key:"stepper-actions","onClick:prev":s,"onClick:next":r},t))]}})}),{prev:s,next:r}}}),at={class:"d-flex justify-center inner fill-height"},lt={class:"mb-5 text-h5"},nt={class:"text-grey-darken-1"},st={class:"d-flex justify-end mt-4"},rt={class:"text-center text-h3"},ot={class:"d-flex justify-center mt-8"},Vt={__name:"CreationForm",props:{title:{type:String,default:""},steps:{type:Array,default:()=>[]},summarySections:{type:Array,default:()=>[]},getVFormRef:{type:Function,default:null},formGetter:{type:Function,default:null},validateObject:{type:Function,default:null}},emits:["close","create","validationError"],setup(e,{expose:f,emit:t}){const{smAndDown:a}=oe(),r=e,s=M(1),c=M(!1),d=M(),m=t,{$gettext:l}=se();async function x(){await d.value.open(l("Warning"),l("If you close this form now, your modifications won't be saved. Do you confirm?"),{color:"warning",agreeLabel:l("Yes"),cancelLabel:l("No")})&&m("close")}async function w(V,b){const o=r.getVFormRef(r.steps[V-1]);if(o!==void 0){const{valid:i}=await o.validate();if(!i)return;if(r.validateObject)try{await r.validateObject(V)}catch(k){m("validationError",V,k.response.data);return}}s.value=b}function I(){c.value=!0,m("create")}return f({working:c}),(V,b)=>(y(),W("div",at,[n(tt,{modelValue:s.value,"onUpdate:modelValue":b[1]||(b[1]=o=>s.value=o),mobile:!g(a)},{default:u(()=>[n(g(me),{ref_key:"confirm",ref:d},null,512),n(ce,{class:"align-center px-10"},{default:u(()=>[n(Fe,{src:ze,"max-width":"190",class:"hidden-sm-and-down"}),(y(!0),W(j,null,F(e.steps,(o,i)=>(y(),C(H,{key:o.name,color:"primary",value:i+1,complete:s.value>i+1},{default:u(()=>[h(v(o.title),1)]),_:2},1032,["value","complete"]))),128)),n(H,{value:e.steps.length+1},{default:u(()=>[h(v(g(l)("Summary")),1)]),_:1},8,["value"]),n(A,{icon:"mdi-close",color:"primary",size:g(a)?"small":"x-large",variant:"text",onClick:x},null,8,["size"])]),_:1}),n(de,{class:"mt-4 d-flex justify-center"},{default:u(()=>[(y(!0),W(j,null,F(e.steps,(o,i)=>(y(),C(Y,{key:o.name,value:i+1,class:"flex-grow-1 ma-10"},{default:u(()=>[n(De,{fluid:""},{default:u(()=>[n(ie,{align:"center",justify:"center"},{default:u(()=>[n(T,{cols:"8",align:"start"},{default:u(()=>[p("div",lt,[p("span",nt,v(e.title),1),h(" / "+v(o.title),1)]),U(V.$slots,`form.${o.name}`,{step:o,currentStep:i+1})]),_:2},1024)]),_:2},1024)]),_:2},1024),p("div",st,[i+1>1?(y(),C(A,{key:0,class:"mr-10",variant:"text",onClick:k=>s.value=i},{default:u(()=>[h(v(g(l)("Back")),1)]),_:2},1032,["onClick"])):re("",!0),n(A,{color:"primary",size:"large",onClick:k=>w(i+1,i+2)},{default:u(()=>[h(v(g(l)("Next")),1)]),_:2},1032,["onClick"])])]),_:2},1032,["value"]))),128)),n(Y,{value:e.steps.length+1,class:"flex-grow-0"},{default:u(()=>[p("div",rt,v(g(l)("Summary")),1),n(Ye,{sections:e.summarySections,onModifyStep:b[0]||(b[0]=o=>s.value=o)},xe({_:2},[F(V.$slots,(o,i)=>({name:i,fn:u(k=>[U(V.$slots,i,we(Ie(k)))])}))]),1032,["sections"]),p("div",ot,[n(A,{color:"primary",size:"large",loading:c.value,onClick:I},{default:u(()=>[h(v(g(l)("Confirm and create")),1)]),_:1},8,["loading"])])]),_:3},8,["value"])]),_:3})]),_:3},8,["modelValue","mobile"])]))}};export{Vt as _};
